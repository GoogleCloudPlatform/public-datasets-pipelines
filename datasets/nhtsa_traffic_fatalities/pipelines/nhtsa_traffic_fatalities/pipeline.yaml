# Copyright 2021 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
resources: ~

dag:
  airflow_version: 2
  initialize:
    dag_id: nhtsa_traffic_fatalities
    default_args:
      owner: "Google"
      depends_on_past: False
      start_date: "2022-03-01"
    max_active_runs: 1
    schedule_interval: "@daily"
    catchup: False
    default_view: graph
  tasks:
    - operator: "GKECreateClusterOperator"
      args:
        task_id: "create_cluster"
        project_id: "{{ var.value.gcp_project }}"
        location: "us-central1-c"
        body:
          name: nhtsa-traffic-fatalities
          initial_node_count: 2
          network: "{{ var.value.vpc_network }}"
          node_config:
            machine_type: e2-standard-16
            oauth_scopes:
              - https://www.googleapis.com/auth/devstorage.read_write
              - https://www.googleapis.com/auth/cloud-platform

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for accident pipeline"
      args:
        task_id: "accident_2015_transform_csv"
        startup_timeout_seconds: 600
        name: "accident_2015"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "accident.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_vehicle_forms_submitted_all",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_parked_working_vehicles",
              "number_of_forms_submitted_for_persons_not_in_motor_vehicles",
              "number_of_forms_submitted_for_persons_in_motor_vehicles",
              "number_of_persons_in_motor_vehicles_in_transport_mvit",
              "number_of_persons_not_in_motor_vehicles_in_transport_mvit",
              "county",
              "city",
              "day_of_crash",
              "day_name",
              "month_of_crash",
              "month_of_crash_name",
              "year_of_crash",
              "day_of_week",
              "day_of_week_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "national_highway_system",
              "national_highway_system_name",
              "route_signing",
              "route_signing_name",
              "trafficway_identifier",
              "trafficway_identifier_2",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "ownership",
              "ownership_name",
              "milepoint",
              "milepoint_name",
              "latitude",
              "latitude_name",
              "longitude",
              "longitude_name",
              "special_jurisdiction",
              "special_jurisdiction_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "relation_to_junction_within_interchange_area",
              "relation_to_junction_within_interchange_area_name",
              "relation_to_junction_specific_location",
              "relation_to_junction_specific_location_name",
              "type_of_intersection",
              "type_of_intersection_name",
              "work_zone",
              "work_zone_name",
              "relation_to_trafficway",
              "relation_to_trafficway_name",
              "light_condition",
              "light_condition_name",
              "atmospheric_conditions_1",
              "atmospheric_conditions_1_name",
              "atmospheric_conditions_2",
              "atmospheric_conditions_2_name",
              "atmospheric_conditions",
              "atmospheric_conditions_name",
              "school_bus_related",
              "school_bus_related_name",
              "rail_grade_crossing_identifier",
              "rail_grade_crossing_identifier_name",
              "hour_of_notification",
              "hour_of_notification_name",
              "minute_of_notification",
              "minute_of_notification_name",
              "hour_of_arrival_at_scene",
              "hour_of_arrival_at_scene_name",
              "minute_of_arrival_at_scene",
              "minute_of_arrival_at_scene_name",
              "hour_of_ems_arrival_at_hospital",
              "hour_of_ems_arrival_at_hospital_name",
              "minute_of_ems_arrival_at_hospital",
              "minute_of_ems_arrival_at_hospital_name",
              "related_factors_crash_level_1",
              "related_factors_crash_level_1_name",
              "related_factors_crash_level_2",
              "related_factors_crash_level_2_name",
              "related_factors_crash_level_3",
              "related_factors_crash_level_3_name",
              "number_of_fatalities",
              "number_of_drunk_drivers"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_vehicle_forms_submitted_all": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_parked_working_vehicles": "str",
              "number_of_forms_submitted_for_persons_not_in_motor_vehicles": "str",
              "number_of_forms_submitted_for_persons_in_motor_vehicles": "str",
              "number_of_persons_in_motor_vehicles_in_transport_mvit": "str",
              "number_of_persons_not_in_motor_vehicles_in_transport_mvit": "str",
              "county": "str",
              "city": "str",
              "day_of_crash": "str",
              "day_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "year_of_crash": "str",
              "day_of_week": "str",
              "day_of_week_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "national_highway_system": "str",
              "national_highway_system_name": "str",
              "route_signing": "str",
              "route_signing_name": "str",
              "trafficway_identifier": "str",
              "trafficway_identifier_2": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "ownership": "str",
              "ownership_name": "str",
              "milepoint": "str",
              "milepoint_name": "str",
              "latitude": "str",
              "latitude_name": "str",
              "longitude": "str",
              "longitude_name": "str",
              "special_jurisdiction": "str",
              "special_jurisdiction_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "relation_to_junction_within_interchange_area": "str",
              "relation_to_junction_within_interchange_area_name": "str",
              "relation_to_junction_specific_location": "str",
              "relation_to_junction_specific_location_name": "str",
              "type_of_intersection": "str",
              "type_of_intersection_name": "str",
              "work_zone": "str",
              "work_zone_name": "str",
              "relation_to_trafficway": "str",
              "relation_to_trafficway_name": "str",
              "light_condition": "str",
              "light_condition_name": "str",
              "atmospheric_conditions_1": "str",
              "atmospheric_conditions_1_name": "str",
              "atmospheric_conditions_2": "str",
              "atmospheric_conditions_2_name": "str",
              "atmospheric_conditions": "str",
              "atmospheric_conditions_name": "str",
              "school_bus_related": "str",
              "school_bus_related_name": "str",
              "rail_grade_crossing_identifier": "str",
              "rail_grade_crossing_identifier_name": "str",
              "hour_of_notification": "str",
              "hour_of_notification_name": "str",
              "minute_of_notification": "str",
              "minute_of_notification_name": "str",
              "hour_of_arrival_at_scene": "str",
              "hour_of_arrival_at_scene_name": "str",
              "minute_of_arrival_at_scene": "str",
              "minute_of_arrival_at_scene_name": "str",
              "hour_of_ems_arrival_at_hospital": "str",
              "hour_of_ems_arrival_at_hospital_name": "str",
              "minute_of_ems_arrival_at_hospital": "str",
              "minute_of_ems_arrival_at_hospital_name": "str",
              "related_factors_crash_level_1": "str",
              "related_factors_crash_level_1_name": "str",
              "related_factors_crash_level_2": "str",
              "related_factors_crash_level_2_name": "str",
              "related_factors_crash_level_3": "str",
              "related_factors_crash_level_3_name": "str",
              "number_of_fatalities": "str",
              "number_of_drunk_drivers": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_TOTAL": "number_of_vehicle_forms_submitted_all",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PVH_INVL": "number_of_parked_working_vehicles",
              "PEDS": "number_of_forms_submitted_for_persons_not_in_motor_vehicles",
              "PERSONS": "number_of_forms_submitted_for_persons_in_motor_vehicles",
              "PERMVIT": "number_of_persons_in_motor_vehicles_in_transport_mvit",
              "PERNOTMVIT": "number_of_persons_not_in_motor_vehicles_in_transport_mvit",
              "COUNTY": "county",
              "CITY": "city",
              "DAY": "day_of_crash",
              "DAYNAME": "day_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "YEAR": "year_of_crash",
              "DAY_WEEK": "day_of_week",
              "DAY_WEEKNAME": "day_of_week_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "NHS": "national_highway_system",
              "NHSNAME": "national_highway_system_name",
              "ROUTE": "route_signing",
              "ROUTENAME": "route_signing_name",
              "TWAY_ID": "trafficway_identifier",
              "TWAY_ID2": "trafficway_identifier_2",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "RD_OWNER": "ownership",
              "RD_OWNERNAME": "ownership_name",
              "MILEPT": "milepoint",
              "MILEPTNAME": "milepoint_name",
              "LATITUDE": "latitude",
              "LATITUDENAME": "latitude_name",
              "LONGITUD": "longitude",
              "LONGITUDNAME": "longitude_name",
              "SP_JUR": "special_jurisdiction",
              "SP_JURNAME": "special_jurisdiction_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "RELJCT1": "relation_to_junction_within_interchange_area",
              "RELJCT1NAME": "relation_to_junction_within_interchange_area_name",
              "RELJCT2": "relation_to_junction_specific_location",
              "RELJCT2NAME": "relation_to_junction_specific_location_name",
              "TYP_INT" : "type_of_intersection",
              "TYP_INTNAME": "type_of_intersection_name",
              "WRK_ZONE": "work_zone",
              "WRK_ZONENAME": "work_zone_name",
              "REL_ROAD": "relation_to_trafficway",
              "REL_ROADNAME": "relation_to_trafficway_name",
              "LGT_COND": "light_condition",
              "LGT_CONDNAME": "light_condition_name",
              "WEATHER1": "atmospheric_conditions_1",
              "WEATHER1NAME": "atmospheric_conditions_1_name",
              "WEATHER2": "atmospheric_conditions_2",
              "WEATHER2NAME": "atmospheric_conditions_2_name",
              "WEATHER": "atmospheric_conditions",
              "WEATHERNAME": "atmospheric_conditions_name",
              "SCH_BUS": "school_bus_related",
              "SCH_BUSNAME": "school_bus_related_name",
              "RAIL": "rail_grade_crossing_identifier",
              "RAILNAME": "rail_grade_crossing_identifier_name",
              "NOT_HOUR": "hour_of_notification",
              "NOT_HOURNAME": "hour_of_notification_name",
              "NOT_MIN": "minute_of_notification",
              "NOT_MINNAME": "minute_of_notification_name",
              "ARR_HOUR": "hour_of_arrival_at_scene",
              "ARR_HOURNAME": "hour_of_arrival_at_scene_name",
              "ARR_MIN": "minute_of_arrival_at_scene",
              "ARR_MINNAME": "minute_of_arrival_at_scene_name",
              "HOSP_HR": "hour_of_ems_arrival_at_hospital",
              "HOSP_HRNAME": "hour_of_ems_arrival_at_hospital_name",
              "HOSP_MN": "minute_of_ems_arrival_at_hospital",
              "HOSP_MNNAME": "minute_of_ems_arrival_at_hospital_name",
              "CF1": "related_factors_crash_level_1",
              "CF1NAME": "related_factors_crash_level_1_name",
              "CF2": "related_factors_crash_level_2",
              "CF2NAME": "related_factors_crash_level_2_name",
              "CF3": "related_factors_crash_level_3",
              "CF3NAME": "related_factors_crash_level_3_name",
              "FATALS": "number_of_fatalities",
              "DRUNK_DR": "number_of_drunk_drivers"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"


    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for accident pipeline"
      args:
        task_id: "accident_2016_2019_transform_csv"
        startup_timeout_seconds: 600
        name: "accident_2016_2019"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "accident.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_vehicle_forms_submitted_all",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_parked_working_vehicles",
              "number_of_forms_submitted_for_persons_not_in_motor_vehicles",
              "number_of_forms_submitted_for_persons_in_motor_vehicles",
              "number_of_persons_in_motor_vehicles_in_transport_mvit",
              "number_of_persons_not_in_motor_vehicles_in_transport_mvit",
              "county",
              "county_name",
              "city",
              "city_name",
              "day_of_crash",
              "day_name",
              "month_of_crash",
              "month_of_crash_name",
              "year_of_crash",
              "day_of_week",
              "day_of_week_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "national_highway_system",
              "national_highway_system_name",
              "route_signing",
              "route_signing_name",
              "trafficway_identifier",
              "trafficway_identifier_2",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "ownership",
              "ownership_name",
              "milepoint",
              "milepoint_name",
              "latitude",
              "latitude_name",
              "longitude",
              "longitude_name",
              "special_jurisdiction",
              "special_jurisdiction_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "relation_to_junction_within_interchange_area",
              "relation_to_junction_within_interchange_area_name",
              "relation_to_junction_specific_location",
              "relation_to_junction_specific_location_name",
              "type_of_intersection",
              "type_of_intersection_name",
              "work_zone",
              "work_zone_name",
              "relation_to_trafficway",
              "relation_to_trafficway_name",
              "light_condition",
              "light_condition_name",
              "atmospheric_conditions_1",
              "atmospheric_conditions_1_name",
              "atmospheric_conditions_2",
              "atmospheric_conditions_2_name",
              "atmospheric_conditions",
              "atmospheric_conditions_name",
              "school_bus_related",
              "school_bus_related_name",
              "rail_grade_crossing_identifier",
              "rail_grade_crossing_identifier_name",
              "hour_of_notification",
              "hour_of_notification_name",
              "minute_of_notification",
              "minute_of_notification_name",
              "hour_of_arrival_at_scene",
              "hour_of_arrival_at_scene_name",
              "minute_of_arrival_at_scene",
              "minute_of_arrival_at_scene_name",
              "hour_of_ems_arrival_at_hospital",
              "hour_of_ems_arrival_at_hospital_name",
              "minute_of_ems_arrival_at_hospital",
              "minute_of_ems_arrival_at_hospital_name",
              "related_factors_crash_level_1",
              "related_factors_crash_level_1_name",
              "related_factors_crash_level_2",
              "related_factors_crash_level_2_name",
              "related_factors_crash_level_3",
              "related_factors_crash_level_3_name",
              "number_of_fatalities",
              "number_of_drunk_drivers"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_vehicle_forms_submitted_all": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_parked_working_vehicles": "str",
              "number_of_forms_submitted_for_persons_not_in_motor_vehicles": "str",
              "number_of_forms_submitted_for_persons_in_motor_vehicles": "str",
              "number_of_persons_in_motor_vehicles_in_transport_mvit": "str",
              "number_of_persons_not_in_motor_vehicles_in_transport_mvit": "str",
              "county": "str",
              "county_name": "str",
              "city": "str",
              "city_name": "str",
              "day_of_crash": "str",
              "day_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "year_of_crash": "str",
              "day_of_week": "str",
              "day_of_week_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "national_highway_system": "str",
              "national_highway_system_name": "str",
              "route_signing": "str",
              "route_signing_name": "str",
              "trafficway_identifier": "str",
              "trafficway_identifier_2": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "ownership": "str",
              "ownership_name": "str",
              "milepoint": "str",
              "milepoint_name": "str",
              "latitude": "str",
              "latitude_name": "str",
              "longitude": "str",
              "longitude_name": "str",
              "special_jurisdiction": "str",
              "special_jurisdiction_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "relation_to_junction_within_interchange_area": "str",
              "relation_to_junction_within_interchange_area_name": "str",
              "relation_to_junction_specific_location": "str",
              "relation_to_junction_specific_location_name": "str",
              "type_of_intersection": "str",
              "type_of_intersection_name": "str",
              "work_zone": "str",
              "work_zone_name": "str",
              "relation_to_trafficway": "str",
              "relation_to_trafficway_name": "str",
              "light_condition": "str",
              "light_condition_name": "str",
              "atmospheric_conditions_1": "str",
              "atmospheric_conditions_1_name": "str",
              "atmospheric_conditions_2": "str",
              "atmospheric_conditions_2_name": "str",
              "atmospheric_conditions": "str",
              "atmospheric_conditions_name": "str",
              "school_bus_related": "str",
              "school_bus_related_name": "str",
              "rail_grade_crossing_identifier": "str",
              "rail_grade_crossing_identifier_name": "str",
              "hour_of_notification": "str",
              "hour_of_notification_name": "str",
              "minute_of_notification": "str",
              "minute_of_notification_name": "str",
              "hour_of_arrival_at_scene": "str",
              "hour_of_arrival_at_scene_name": "str",
              "minute_of_arrival_at_scene": "str",
              "minute_of_arrival_at_scene_name": "str",
              "hour_of_ems_arrival_at_hospital": "str",
              "hour_of_ems_arrival_at_hospital_name": "str",
              "minute_of_ems_arrival_at_hospital": "str",
              "minute_of_ems_arrival_at_hospital_name": "str",
              "related_factors_crash_level_1": "str",
              "related_factors_crash_level_1_name": "str",
              "related_factors_crash_level_2": "str",
              "related_factors_crash_level_2_name": "str",
              "related_factors_crash_level_3": "str",
              "related_factors_crash_level_3_name": "str",
              "number_of_fatalities": "str",
              "number_of_drunk_drivers": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_TOTAL": "number_of_vehicle_forms_submitted_all",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PVH_INVL": "number_of_parked_working_vehicles",
              "PEDS": "number_of_forms_submitted_for_persons_not_in_motor_vehicles",
              "PERSONS": "number_of_forms_submitted_for_persons_in_motor_vehicles",
              "PERMVIT": "number_of_persons_in_motor_vehicles_in_transport_mvit",
              "PERNOTMVIT": "number_of_persons_not_in_motor_vehicles_in_transport_mvit",
              "COUNTY": "county",
              "COUNTYNAME": "county_name",
              "CITY": "city",
              "CITYNAME": "city_name",
              "DAY": "day_of_crash",
              "DAYNAME": "day_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "YEAR": "year_of_crash",
              "DAY_WEEK": "day_of_week",
              "DAY_WEEKNAME": "day_of_week_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "NHS": "national_highway_system",
              "NHSNAME": "national_highway_system_name",
              "ROUTE": "route_signing",
              "ROUTENAME": "route_signing_name",
              "TWAY_ID": "trafficway_identifier",
              "TWAY_ID2": "trafficway_identifier_2",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "RD_OWNER": "ownership",
              "RD_OWNERNAME": "ownership_name",
              "MILEPT": "milepoint",
              "MILEPTNAME": "milepoint_name",
              "LATITUDE": "latitude",
              "LATITUDENAME": "latitude_name",
              "LONGITUD": "longitude",
              "LONGITUDNAME": "longitude_name",
              "SP_JUR": "special_jurisdiction",
              "SP_JURNAME": "special_jurisdiction_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "RELJCT1": "relation_to_junction_within_interchange_area",
              "RELJCT1NAME": "relation_to_junction_within_interchange_area_name",
              "RELJCT2": "relation_to_junction_specific_location",
              "RELJCT2NAME": "relation_to_junction_specific_location_name",
              "TYP_INT" : "type_of_intersection",
              "TYP_INTNAME": "type_of_intersection_name",
              "WRK_ZONE": "work_zone",
              "WRK_ZONENAME": "work_zone_name",
              "REL_ROAD": "relation_to_trafficway",
              "REL_ROADNAME": "relation_to_trafficway_name",
              "LGT_COND": "light_condition",
              "LGT_CONDNAME": "light_condition_name",
              "WEATHER1": "atmospheric_conditions_1",
              "WEATHER1NAME": "atmospheric_conditions_1_name",
              "WEATHER2": "atmospheric_conditions_2",
              "WEATHER2NAME": "atmospheric_conditions_2_name",
              "WEATHER": "atmospheric_conditions",
              "WEATHERNAME": "atmospheric_conditions_name",
              "SCH_BUS": "school_bus_related",
              "SCH_BUSNAME": "school_bus_related_name",
              "RAIL": "rail_grade_crossing_identifier",
              "RAILNAME": "rail_grade_crossing_identifier_name",
              "NOT_HOUR": "hour_of_notification",
              "NOT_HOURNAME": "hour_of_notification_name",
              "NOT_MIN": "minute_of_notification",
              "NOT_MINNAME": "minute_of_notification_name",
              "ARR_HOUR": "hour_of_arrival_at_scene",
              "ARR_HOURNAME": "hour_of_arrival_at_scene_name",
              "ARR_MIN": "minute_of_arrival_at_scene",
              "ARR_MINNAME": "minute_of_arrival_at_scene_name",
              "HOSP_HR": "hour_of_ems_arrival_at_hospital",
              "HOSP_HRNAME": "hour_of_ems_arrival_at_hospital_name",
              "HOSP_MN": "minute_of_ems_arrival_at_hospital",
              "HOSP_MNNAME": "minute_of_ems_arrival_at_hospital_name",
              "CF1": "related_factors_crash_level_1",
              "CF1NAME": "related_factors_crash_level_1_name",
              "CF2": "related_factors_crash_level_2",
              "CF2NAME": "related_factors_crash_level_2_name",
              "CF3": "related_factors_crash_level_3",
              "CF3NAME": "related_factors_crash_level_3_name",
              "FATALS": "number_of_fatalities",
              "DRUNK_DR": "number_of_drunk_drivers"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for accident pipeline"
      args:
        task_id: "accident_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "accident_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "accident.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_vehicle_forms_submitted_all",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_parked_working_vehicles",
              "number_of_forms_submitted_for_persons_not_in_motor_vehicles",
              "number_of_forms_submitted_for_persons_in_motor_vehicles",
              "number_of_persons_in_motor_vehicles_in_transport_mvit",
              "number_of_persons_not_in_motor_vehicles_in_transport_mvit",
              "county",
              "county_name",
              "city",
              "city_name",
              "day_of_crash",
              "day_name",
              "month_of_crash",
              "month_of_crash_name",
              "year_of_crash",
              "day_of_week",
              "day_of_week_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "national_highway_system",
              "national_highway_system_name",
              "route_signing",
              "route_signing_name",
              "trafficway_identifier",
              "trafficway_identifier_2",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "ownership",
              "ownership_name",
              "milepoint",
              "milepoint_name",
              "latitude",
              "latitude_name",
              "longitude",
              "longitude_name",
              "special_jurisdiction",
              "special_jurisdiction_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "relation_to_junction_within_interchange_area",
              "relation_to_junction_within_interchange_area_name",
              "relation_to_junction_specific_location",
              "relation_to_junction_specific_location_name",
              "type_of_intersection",
              "type_of_intersection_name",
              "work_zone",
              "work_zone_name",
              "relation_to_trafficway",
              "relation_to_trafficway_name",
              "light_condition",
              "light_condition_name",
              "atmospheric_conditions_1",
              "atmospheric_conditions_1_name",
              "atmospheric_conditions_2",
              "atmospheric_conditions_2_name",
              "rail_grade_crossing_identifier",
              "rail_grade_crossing_identifier_name",
              "hour_of_notification",
              "hour_of_notification_name",
              "minute_of_notification",
              "minute_of_notification_name",
              "hour_of_arrival_at_scene",
              "hour_of_arrival_at_scene_name",
              "minute_of_arrival_at_scene",
              "minute_of_arrival_at_scene_name",
              "hour_of_ems_arrival_at_hospital",
              "hour_of_ems_arrival_at_hospital_name",
              "minute_of_ems_arrival_at_hospital",
              "minute_of_ems_arrival_at_hospital_name",
              "number_of_fatalities",
              "number_of_drunk_drivers"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_vehicle_forms_submitted_all": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_parked_working_vehicles": "str",
              "number_of_forms_submitted_for_persons_not_in_motor_vehicles": "str",
              "number_of_forms_submitted_for_persons_in_motor_vehicles": "str",
              "number_of_persons_in_motor_vehicles_in_transport_mvit": "str",
              "number_of_persons_not_in_motor_vehicles_in_transport_mvit": "str",
              "county": "str",
              "county_name": "str",
              "city": "str",
              "city_name": "str",
              "day_of_crash": "str",
              "day_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "year_of_crash": "str",
              "day_of_week": "str",
              "day_of_week_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "national_highway_system": "str",
              "national_highway_system_name": "str",
              "route_signing": "str",
              "route_signing_name": "str",
              "trafficway_identifier": "str",
              "trafficway_identifier_2": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "ownership": "str",
              "ownership_name": "str",
              "milepoint": "str",
              "milepoint_name": "str",
              "latitude": "str",
              "latitude_name": "str",
              "longitude": "str",
              "longitude_name": "str",
              "special_jurisdiction": "str",
              "special_jurisdiction_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "relation_to_junction_within_interchange_area": "str",
              "relation_to_junction_within_interchange_area_name": "str",
              "relation_to_junction_specific_location": "str",
              "relation_to_junction_specific_location_name": "str",
              "type_of_intersection": "str",
              "type_of_intersection_name": "str",
              "work_zone": "str",
              "work_zone_name": "str",
              "relation_to_trafficway": "str",
              "relation_to_trafficway_name": "str",
              "light_condition": "str",
              "light_condition_name": "str",
              "atmospheric_conditions_1": "str",
              "atmospheric_conditions_1_name": "str",
              "atmospheric_conditions_2": "str",
              "atmospheric_conditions_2_name": "str",
              "rail_grade_crossing_identifier": "str",
              "rail_grade_crossing_identifier_name": "str",
              "hour_of_notification": "str",
              "hour_of_notification_name": "str",
              "minute_of_notification": "str",
              "minute_of_notification_name": "str",
              "hour_of_arrival_at_scene": "str",
              "hour_of_arrival_at_scene_name": "str",
              "minute_of_arrival_at_scene": "str",
              "minute_of_arrival_at_scene_name": "str",
              "hour_of_ems_arrival_at_hospital": "str",
              "hour_of_ems_arrival_at_hospital_name": "str",
              "minute_of_ems_arrival_at_hospital": "str",
              "minute_of_ems_arrival_at_hospital_name": "str",
              "number_of_fatalities": "str",
              "number_of_drunk_drivers": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_TOTAL": "number_of_vehicle_forms_submitted_all",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PVH_INVL": "number_of_parked_working_vehicles",
              "PEDS": "number_of_forms_submitted_for_persons_not_in_motor_vehicles",
              "PERSONS": "number_of_forms_submitted_for_persons_in_motor_vehicles",
              "PERMVIT": "number_of_persons_in_motor_vehicles_in_transport_mvit",
              "PERNOTMVIT": "number_of_persons_not_in_motor_vehicles_in_transport_mvit",
              "COUNTY": "county",
              "COUNTYNAME": "county_name",
              "CITY": "city",
              "CITYNAME": "city_name",
              "DAY": "day_of_crash",
              "DAYNAME": "day_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "YEAR": "year_of_crash",
              "DAY_WEEK": "day_of_week",
              "DAY_WEEKNAME": "day_of_week_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "NHS": "national_highway_system",
              "NHSNAME": "national_highway_system_name",
              "ROUTE": "route_signing",
              "ROUTENAME": "route_signing_name",
              "TWAY_ID": "trafficway_identifier",
              "TWAY_ID2": "trafficway_identifier_2",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "RD_OWNER": "ownership",
              "RD_OWNERNAME": "ownership_name",
              "MILEPT": "milepoint",
              "MILEPTNAME": "milepoint_name",
              "LATITUDE": "latitude",
              "LATITUDENAME": "latitude_name",
              "LONGITUD": "longitude",
              "LONGITUDNAME": "longitude_name",
              "SP_JUR": "special_jurisdiction",
              "SP_JURNAME": "special_jurisdiction_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "RELJCT1": "relation_to_junction_within_interchange_area",
              "RELJCT1NAME": "relation_to_junction_within_interchange_area_name",
              "RELJCT2": "relation_to_junction_specific_location",
              "RELJCT2NAME": "relation_to_junction_specific_location_name",
              "TYP_INT" : "type_of_intersection",
              "TYP_INTNAME": "type_of_intersection_name",
              "WRK_ZONE": "work_zone",
              "WRK_ZONENAME": "work_zone_name",
              "REL_ROAD": "relation_to_trafficway",
              "REL_ROADNAME": "relation_to_trafficway_name",
              "LGT_COND": "light_condition",
              "LGT_CONDNAME": "light_condition_name",
              "WEATHER1": "atmospheric_conditions_1",
              "WEATHER1NAME": "atmospheric_conditions_1_name",
              "WEATHER2": "atmospheric_conditions_2",
              "WEATHER2NAME": "atmospheric_conditions_2_name",
              "RAIL": "rail_grade_crossing_identifier",
              "RAILNAME": "rail_grade_crossing_identifier_name",
              "NOT_HOUR": "hour_of_notification",
              "NOT_HOURNAME": "hour_of_notification_name",
              "NOT_MIN": "minute_of_notification",
              "NOT_MINNAME": "minute_of_notification_name",
              "ARR_HOUR": "hour_of_arrival_at_scene",
              "ARR_HOURNAME": "hour_of_arrival_at_scene_name",
              "ARR_MIN": "minute_of_arrival_at_scene",
              "ARR_MINNAME": "minute_of_arrival_at_scene_name",
              "HOSP_HR": "hour_of_ems_arrival_at_hospital",
              "HOSP_HRNAME": "hour_of_ems_arrival_at_hospital_name",
              "HOSP_MN": "minute_of_ems_arrival_at_hospital",
              "HOSP_MNNAME": "minute_of_ems_arrival_at_hospital_name",
              "FATALS": "number_of_fatalities",
              "DRUNK_DR": "number_of_drunk_drivers"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for cevent pipeline"
      args:
        task_id: "cevent_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "cevent_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "cevent.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "event_number",
              "vehicle_number_this_vehicle",
              "area_of_impact_this_vehicle",
              "area_of_impact_this_vehicle_name",
              "sequence_of_events",
              "sequence_of_events_name",
              "vehicle_number_other_vehicle",
              "vehicle_number_other_vehicle_name",
              "area_of_impact_other_vehicle",
              "area_of_impact_other_vehicle_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "event_number": "str",
              "vehicle_number_this_vehicle": "str",
              "area_of_impact_this_vehicle": "str",
              "area_of_impact_this_vehicle_name": "str",
              "sequence_of_events": "str",
              "sequence_of_events_name": "str",
              "vehicle_number_other_vehicle": "str",
              "vehicle_number_other_vehicle_name": "str",
              "area_of_impact_other_vehicle": "str",
              "area_of_impact_other_vehicle_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "EVENTNUM": "event_number",
              "VNUMBER1": "vehicle_number_this_vehicle",
              "AOI1": "area_of_impact_this_vehicle",
              "AOI1NAME": "area_of_impact_this_vehicle_name",
              "SOE": "sequence_of_events",
              "SOENAME": "sequence_of_events_name",
              "VNUMBER2": "vehicle_number_other_vehicle",
              "VNUMBER2NAME": "vehicle_number_other_vehicle_name",
              "AOI2": "area_of_impact_other_vehicle",
              "AOI2NAME": "area_of_impact_other_vehicle_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for damage pipeline"
      args:
        task_id: "damage_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "damage_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "damage.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "damaged_areas",
              "damaged_areas_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "damaged_areas": "str",
              "damaged_areas_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "MDAREAS": "damaged_areas",
              "MDAREASNAME": "area_of_impact_this_vehicle"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for distract pipeline"
      args:
        task_id: "distract_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "distract_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "distract.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "driver_distracted_by",
              "driver_distracted_by_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "driver_distracted_by": "str",
              "driver_distracted_by_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "MDRDSTRD": "driver_distracted_by",
              "MDRDSTRDNAME": "driver_distracted_by_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for drimpair pipeline"
      args:
        task_id: "drimpair_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "drimpair_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "drimpair.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "condition_impairment_at_time_of_crash_driver",
              "condition_impairment_at_time_of_crash_driver_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "condition_impairment_at_time_of_crash_driver": "str",
              "condition_impairment_at_time_of_crash_driver_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "DRIMPAIR": "condition_impairment_at_time_of_crash_driver",
              "DRIMPAIRNAME": "condition_impairment_at_time_of_crash_driver_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for factor pipeline"
      args:
        task_id: "factor_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "factor_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "factor.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "contributing_circumstances_motor_vehicle",
              "contributing_circumstances_motor_vehicle_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "contributing_circumstances_motor_vehicle": "str",
              "contributing_circumstances_motor_vehicle_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "MFACTOR": "contributing_circumstances_motor_vehicle",
              "MFACTORNAME": "contributing_circumstances_motor_vehicle_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for maneuver pipeline"
      args:
        task_id: "maneuver_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "maneuver_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "maneuver.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "driver_maneuvered_to_avoid",
              "driver_maneuvered_to_avoid_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "driver_maneuvered_to_avoid": "str",
              "driver_maneuvered_to_avoid_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "MDRMANAV": "driver_maneuvered_to_avoid",
              "MDRMANAVNAME": "driver_maneuvered_to_avoid_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for nmcrash pipeline"
      args:
        task_id: "nmcrash_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "nmcrash_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "nmcrash.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "person_number",
              "non_motorist_contributing_circumstances",
              "non_motorist_contributing_circumstances_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "non_motorist_contributing_circumstances": "str",
              "non_motorist_contributing_circumstances_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "MTM_CRSH": "non_motorist_contributing_circumstances",
              "MTM_CRSHNAME": "non_motorist_contributing_circumstances_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for nmimpair pipeline"
      args:
        task_id: "nmimpair_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "nmimpair_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "nmimpair.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "person_number",
              "condition_impairment_at_time_of_crash_non_motorist",
              "condition_impairment_at_time_of_crash_non_motorist_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "condition_impairment_at_time_of_crash_non_motorist": "str",
              "condition_impairment_at_time_of_crash_non_motorist_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "NMIMPAIR": "condition_impairment_at_time_of_crash_non_motorist",
              "NMIMPAIRNAME": "condition_impairment_at_time_of_crash_non_motorist_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"


    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for nmprior pipeline"
      args:
        task_id: "nmprior_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "nmprior_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "nmprior.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "person_number",
              "non_motorist_action_circumstances",
              "non_motorist_action_circumstances_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "non_motorist_action_circumstances": "str",
              "non_motorist_action_circumstances_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "NMIMPAIR": "non_motorist_action_circumstances",
              "NMIMPAIRNAME": "non_motorist_action_circumstances_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for parkwork_2015 pipeline"
      args:
        task_id: "parkwork_2015_transform_csv"
        startup_timeout_seconds: 600
        name: "parkwork_2015"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "parkwork.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number",
              "motor_carrier_identification_number_name",
              "gross_vehicle_weight_rating",
              "gross_vehicle_weight_rating_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "underride_override",
              "underride_override_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "related_factors_vehicle_level1",
              "related_factors_vehicle_level1_name",
              "related_factors_vehicle_level2",
              "related_factors_vehicle_level2_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "fatalities_in_vehicle"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number": "str",
              "motor_carrier_identification_number_name": "str",
              "gross_vehicle_weight_rating": "str",
              "gross_vehicle_weight_rating_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "related_factors_vehicle_level1": "str",
              "related_factors_vehicle_level1_name": "str",
              "related_factors_vehicle_level2": "str",
              "related_factors_vehicle_level2_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "fatalities_in_vehicle": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PVE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PNUMOCCS": "number_of_occupants",
              "PNUMOCCSNAME": "number_of_occupants_name",
              "PDAY": "day_of_crash",
              "PDAYNAME": "day_of_crash_name",
              "PMONTH": "month_of_crash",
              "PMONTHNAME": "month_of_crash_name",
              "PHOUR": "hour_of_crash",
              "PHOURNAME": "hour_of_crash_name",
              "PMINUTE": "minute_of_crash",
              "PMINUTENAME": "minute_of_crash_name",
              "PHARM_EV": "first_harmful_event",
              "PHARM_EVNAME": "first_harmful_event_name",
              "PMAN_COLL": "manner_of_collision",
              "PMAN_COLLNAME": "manner_of_collision_name",
              "PTYPE": "unit_type",
              "PTYPENAME": "unit_type_name",
              "PHIT_RUN": "hit_and_run",
              "PHIT_RUNNAME": "hit_and_run_name",
              "PREG_STAT": "registration_state",
              "PREG_STATNAME": "registration_state_name",
              "POWNER": "registered_vehicle_owner",
              "POWNERNAME": "registered_vehicle_owner_name",
              "PMAKE": "vehicle_make",
              "PMAKENAME": "vehicle_make_name",
              "PMODEL": "vehicle_model",
              "PMAK_MOD": "make_model_combined",
              "PBODYTYP": "body_type",
              "PBODYTYPNAME": "body_type_name",
              "PMODYEAR": "vehicle_model_year",
              "PMODYEARNAME": "vehicle_model_year_name",
              "PVIN": "vehicle_identification_number_vin",
              "PVINNAME": "vehicle_identification_number_vin_name",
              "PVIN_1": "vin_character_1",
              "PVIN_2": "vin_character_2",
              "PVIN_3": "vin_character_3",
              "PVIN_4": "vin_character_4",
              "PVIN_5": "vin_character_5",
              "PVIN_6": "vin_character_6",
              "PVIN_7": "vin_character_7",
              "PVIN_8": "vin_character_8",
              "PVIN_9": "vin_character_9",
              "PVIN_10": "vin_character_10",
              "PVIN_11": "vin_character_11",
              "PVIN_12": "vin_character_12",
              "PTRAILER": "vehicle_trailing",
              "PTRAILERNAME": "vehicle_trailing_name",
              "PMCARR_I1": "mcid_issuing_authority",
              "PMCARR_I1NAME": "mcid_issuing_authority_name",
              "PMCARR_I2": "mcid_identification_number",
              "PMCARR_I2NAME": "mcid_identification_number_name",
              "PMCARR_ID": "motor_carrier_identification_number",
              "PMCARR_IDNAME": "motor_carrier_identification_number_name",
              "PGVWR": "gross_vehicle_weight_rating",
              "PGVWRNAME": "gross_vehicle_weight_rating_name",
              "PV_CONFIG": "vehicle_configuration",
              "PV_CONFIGNAME": "vehicle_configuration_name",
              "PCARGTYP": "cargo_body_type",
              "PCARGTYPNAME": "cargo_body_type_name",
              "PHAZ_INV": "hazardous_material_involvement",
              "PHAZ_INVNAME": "hazardous_material_involvement_name",
              "PHAZPLAC": "hazardous_material_placard",
              "PHAZPLACNAME": "hazardous_material_placard_name",
              "PHAZ_ID": "hazardous_material_identification_number",
              "PHAZ_IDNAME": "hazardous_material_identification_number_name",
              "PHAZ_CNO": "hazardous_material_class_number",
              "PHAZ_CNONAME": "hazardous_material_class_number_name",
              "PHAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "PHAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "PBUS_USE": "bus_use",
              "PBUS_USENAME": "bus_use_name",
              "PSP_USE": "special_use",
              "PSP_USENAME": "special_use_name",
              "PEM_USE": "emergency_motor_vehicle_use",
              "PEM_USENAME": "emergency_motor_vehicle_use_name",
              "PUNDERIDE": "underride_override",
              "PUNDERIDENAME": "underride_override_name",
              "PIMPACT1": "initial_contact_point",
              "PIMPACT1NAME": "initial_contact_point_name",
              "PVEH_SEV": "extent_of_damage",
              "PVEH_SEVNAME": "extent_of_damage_name",
              "PTOWED": "vehicle_removal",
              "PTOWEDNAME": "vehicle_removal_name",
              "PM_HARM": "most_harmful_event",
              "PM_HARMNAME": "most_harmful_event_name",
              "PVEH_SC1": "related_factors_vehicle_level1",
              "PVEH_SC1NAME": "related_factors_vehicle_level1_name",
              "PVEH_SC2": "related_factors_vehicle_level2",
              "PVEH_SC2NAME": "related_factors_vehicle_level2_name",
              "PFIRE": "fire_occurrence",
              "PFIRENAME": "fire_occurrence_name",
              "PDEATHS": "fatalities_in_vehicle"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for parkwork_2016_2017 pipelines"
      args:
        task_id: "parkwork_2016_2017_transform_csv"
        startup_timeout_seconds: 600
        name: "parkwork_2016_2017"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "parkwork.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number",
              "motor_carrier_identification_number_name",
              "gross_vehicle_weight_rating",
              "gross_vehicle_weight_rating_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "underride_override",
              "underride_override_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "related_factors_vehicle_level1",
              "related_factors_vehicle_level1_name",
              "related_factors_vehicle_level2",
              "related_factors_vehicle_level2_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "fatalities_in_vehicle",
              "ptrlr1vin",
              "ptrlr1vinname",
              "ptrlr2vin",
              "ptrlr2vinname",
              "ptrlr3vin",
              "ptrlr3vinname"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number": "str",
              "motor_carrier_identification_number_name": "str",
              "gross_vehicle_weight_rating": "str",
              "gross_vehicle_weight_rating_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "related_factors_vehicle_level1": "str",
              "related_factors_vehicle_level1_name": "str",
              "related_factors_vehicle_level2": "str",
              "related_factors_vehicle_level2_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "fatalities_in_vehicle": "str",
              "ptrlr1vin": "str",
              "ptrlr1vinname": "str",
              "ptrlr2vin": "str",
              "ptrlr2vinname": "str",
              "ptrlr3vin": "str",
              "ptrlr3vinname": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PVE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PNUMOCCS": "number_of_occupants",
              "PNUMOCCSNAME": "number_of_occupants_name",
              "PDAY": "day_of_crash",
              "PDAYNAME": "day_of_crash_name",
              "PMONTH": "month_of_crash",
              "PMONTHNAME": "month_of_crash_name",
              "PHOUR": "hour_of_crash",
              "PHOURNAME": "hour_of_crash_name",
              "PMINUTE": "minute_of_crash",
              "PMINUTENAME": "minute_of_crash_name",
              "PHARM_EV": "first_harmful_event",
              "PHARM_EVNAME": "first_harmful_event_name",
              "PMAN_COLL": "manner_of_collision",
              "PMAN_COLLNAME": "manner_of_collision_name",
              "PTYPE": "unit_type",
              "PTYPENAME": "unit_type_name",
              "PHIT_RUN": "hit_and_run",
              "PHIT_RUNNAME": "hit_and_run_name",
              "PREG_STAT": "registration_state",
              "PREG_STATNAME": "registration_state_name",
              "POWNER": "registered_vehicle_owner",
              "POWNERNAME": "registered_vehicle_owner_name",
              "PMAKE": "vehicle_make",
              "PMAKENAME": "vehicle_make_name",
              "PMODEL": "vehicle_model",
              "PMAK_MOD": "make_model_combined",
              "PBODYTYP": "body_type",
              "PBODYTYPNAME": "body_type_name",
              "PMODYEAR": "vehicle_model_year",
              "PMODYEARNAME": "vehicle_model_year_name",
              "PVIN": "vehicle_identification_number_vin",
              "PVINNAME": "vehicle_identification_number_vin_name",
              "PVIN_1": "vin_character_1",
              "PVIN_2": "vin_character_2",
              "PVIN_3": "vin_character_3",
              "PVIN_4": "vin_character_4",
              "PVIN_5": "vin_character_5",
              "PVIN_6": "vin_character_6",
              "PVIN_7": "vin_character_7",
              "PVIN_8": "vin_character_8",
              "PVIN_9": "vin_character_9",
              "PVIN_10": "vin_character_10",
              "PVIN_11": "vin_character_11",
              "PVIN_12": "vin_character_12",
              "PTRAILER": "vehicle_trailing",
              "PTRAILERNAME": "vehicle_trailing_name",
              "PMCARR_I1": "mcid_issuing_authority",
              "PMCARR_I1NAME": "mcid_issuing_authority_name",
              "PMCARR_I2": "mcid_identification_number",
              "PMCARR_I2NAME": "mcid_identification_number_name",
              "PMCARR_ID": "motor_carrier_identification_number",
              "PMCARR_IDNAME": "motor_carrier_identification_number_name",
              "PGVWR": "gross_vehicle_weight_rating",
              "PGVWRNAME": "gross_vehicle_weight_rating_name",
              "PV_CONFIG": "vehicle_configuration",
              "PV_CONFIGNAME": "vehicle_configuration_name",
              "PCARGTYP": "cargo_body_type",
              "PCARGTYPNAME": "cargo_body_type_name",
              "PHAZ_INV": "hazardous_material_involvement",
              "PHAZ_INVNAME": "hazardous_material_involvement_name",
              "PHAZPLAC": "hazardous_material_placard",
              "PHAZPLACNAME": "hazardous_material_placard_name",
              "PHAZ_ID": "hazardous_material_identification_number",
              "PHAZ_IDNAME": "hazardous_material_identification_number_name",
              "PHAZ_CNO": "hazardous_material_class_number",
              "PHAZ_CNONAME": "hazardous_material_class_number_name",
              "PHAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "PHAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "PBUS_USE": "bus_use",
              "PBUS_USENAME": "bus_use_name",
              "PSP_USE": "special_use",
              "PSP_USENAME": "special_use_name",
              "PEM_USE": "emergency_motor_vehicle_use",
              "PEM_USENAME": "emergency_motor_vehicle_use_name",
              "PUNDERIDE": "underride_override",
              "PUNDERIDENAME": "underride_override_name",
              "PIMPACT1": "initial_contact_point",
              "PIMPACT1NAME": "initial_contact_point_name",
              "PVEH_SEV": "extent_of_damage",
              "PVEH_SEVNAME": "extent_of_damage_name",
              "PTOWED": "vehicle_removal",
              "PTOWEDNAME": "vehicle_removal_name",
              "PM_HARM": "most_harmful_event",
              "PM_HARMNAME": "most_harmful_event_name",
              "PVEH_SC1": "related_factors_vehicle_level1",
              "PVEH_SC1NAME": "related_factors_vehicle_level1_name",
              "PVEH_SC2": "related_factors_vehicle_level2",
              "PVEH_SC2NAME": "related_factors_vehicle_level2_name",
              "PFIRE": "fire_occurrence",
              "PFIRENAME": "fire_occurrence_name",
              "PDEATHS": "fatalities_in_vehicle",
              "PTRLR1VIN": "ptrlr1vin",
              "PTRLR1VINNAME": "ptrlr1vinname",
              "PTRLR2VIN": "ptrlr2vin",
              "PTRLR2VINNAME": "ptrlr2vinname",
              "PTRLR3VIN": "ptrlr3vin",
              "PTRLR3VINNAME": "ptrlr3vinname"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for parkwork_2018 pipelines"
      args:
        task_id: "parkwork_2018_transform_csv"
        startup_timeout_seconds: 600
        name: "parkwork_2018"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "parkwork.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "make_model_combined_name",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number",
              "motor_carrier_identification_number_name",
              "gross_vehicle_weight_rating",
              "gross_vehicle_weight_rating_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "underride_override",
              "underride_override_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "related_factors_vehicle_level1",
              "related_factors_vehicle_level1_name",
              "related_factors_vehicle_level2",
              "related_factors_vehicle_level2_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "fatalities_in_vehicle",
              "ptrlr1vin",
              "ptrlr1vinname",
              "ptrlr2vin",
              "ptrlr2vinname",
              "ptrlr3vin",
              "ptrlr3vinname"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "make_model_combined_name": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number": "str",
              "motor_carrier_identification_number_name": "str",
              "gross_vehicle_weight_rating": "str",
              "gross_vehicle_weight_rating_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "related_factors_vehicle_level1": "str",
              "related_factors_vehicle_level1_name": "str",
              "related_factors_vehicle_level2": "str",
              "related_factors_vehicle_level2_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "fatalities_in_vehicle": "str",
              "ptrlr1vin": "str",
              "ptrlr1vinname": "str",
              "ptrlr2vin": "str",
              "ptrlr2vinname": "str",
              "ptrlr3vin": "str",
              "ptrlr3vinname": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PVE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PNUMOCCS": "number_of_occupants",
              "PNUMOCCSNAME": "number_of_occupants_name",
              "PDAY": "day_of_crash",
              "PDAYNAME": "day_of_crash_name",
              "PMONTH": "month_of_crash",
              "PMONTHNAME": "month_of_crash_name",
              "PHOUR": "hour_of_crash",
              "PHOURNAME": "hour_of_crash_name",
              "PMINUTE": "minute_of_crash",
              "PMINUTENAME": "minute_of_crash_name",
              "PHARM_EV": "first_harmful_event",
              "PHARM_EVNAME": "first_harmful_event_name",
              "PMAN_COLL": "manner_of_collision",
              "PMAN_COLLNAME": "manner_of_collision_name",
              "PTYPE": "unit_type",
              "PTYPENAME": "unit_type_name",
              "PHIT_RUN": "hit_and_run",
              "PHIT_RUNNAME": "hit_and_run_name",
              "PREG_STAT": "registration_state",
              "PREG_STATNAME": "registration_state_name",
              "POWNER": "registered_vehicle_owner",
              "POWNERNAME": "registered_vehicle_owner_name",
              "PMAKE": "vehicle_make",
              "PMAKENAME": "vehicle_make_name",
              "PMODEL": "vehicle_model",
              "PMAK_MOD": "make_model_combined",
              "PMAK_MODNAME": "make_model_combined_name",
              "PBODYTYP": "body_type",
              "PBODYTYPNAME": "body_type_name",
              "PMODYEAR": "vehicle_model_year",
              "PMODYEARNAME": "vehicle_model_year_name",
              "PVIN": "vehicle_identification_number_vin",
              "PVINNAME": "vehicle_identification_number_vin_name",
              "PVIN_1": "vin_character_1",
              "PVIN_2": "vin_character_2",
              "PVIN_3": "vin_character_3",
              "PVIN_4": "vin_character_4",
              "PVIN_5": "vin_character_5",
              "PVIN_6": "vin_character_6",
              "PVIN_7": "vin_character_7",
              "PVIN_8": "vin_character_8",
              "PVIN_9": "vin_character_9",
              "PVIN_10": "vin_character_10",
              "PVIN_11": "vin_character_11",
              "PVIN_12": "vin_character_12",
              "PTRAILER": "vehicle_trailing",
              "PTRAILERNAME": "vehicle_trailing_name",
              "PMCARR_I1": "mcid_issuing_authority",
              "PMCARR_I1NAME": "mcid_issuing_authority_name",
              "PMCARR_I2": "mcid_identification_number",
              "PMCARR_I2NAME": "mcid_identification_number_name",
              "PMCARR_ID": "motor_carrier_identification_number",
              "PMCARR_IDNAME": "motor_carrier_identification_number_name",
              "PGVWR": "gross_vehicle_weight_rating",
              "PGVWRNAME": "gross_vehicle_weight_rating_name",
              "PV_CONFIG": "vehicle_configuration",
              "PV_CONFIGNAME": "vehicle_configuration_name",
              "PCARGTYP": "cargo_body_type",
              "PCARGTYPNAME": "cargo_body_type_name",
              "PHAZ_INV": "hazardous_material_involvement",
              "PHAZ_INVNAME": "hazardous_material_involvement_name",
              "PHAZPLAC": "hazardous_material_placard",
              "PHAZPLACNAME": "hazardous_material_placard_name",
              "PHAZ_ID": "hazardous_material_identification_number",
              "PHAZ_IDNAME": "hazardous_material_identification_number_name",
              "PHAZ_CNO": "hazardous_material_class_number",
              "PHAZ_CNONAME": "hazardous_material_class_number_name",
              "PHAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "PHAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "PBUS_USE": "bus_use",
              "PBUS_USENAME": "bus_use_name",
              "PSP_USE": "special_use",
              "PSP_USENAME": "special_use_name",
              "PEM_USE": "emergency_motor_vehicle_use",
              "PEM_USENAME": "emergency_motor_vehicle_use_name",
              "PUNDERIDE": "underride_override",
              "PUNDERIDENAME": "underride_override_name",
              "PIMPACT1": "initial_contact_point",
              "PIMPACT1NAME": "initial_contact_point_name",
              "PVEH_SEV": "extent_of_damage",
              "PVEH_SEVNAME": "extent_of_damage_name",
              "PTOWED": "vehicle_removal",
              "PTOWEDNAME": "vehicle_removal_name",
              "PM_HARM": "most_harmful_event",
              "PM_HARMNAME": "most_harmful_event_name",
              "PVEH_SC1": "related_factors_vehicle_level1",
              "PVEH_SC1NAME": "related_factors_vehicle_level1_name",
              "PVEH_SC2": "related_factors_vehicle_level2",
              "PVEH_SC2NAME": "related_factors_vehicle_level2_name",
              "PFIRE": "fire_occurrence",
              "PFIRENAME": "fire_occurrence_name",
              "PDEATHS": "fatalities_in_vehicle",
              "PTRLR1VIN": "ptrlr1vin",
              "PTRLR1VINNAME": "ptrlr1vinname",
              "PTRLR2VIN": "ptrlr2vin",
              "PTRLR2VINNAME": "ptrlr2vinname",
              "PTRLR3VIN": "ptrlr3vin",
              "PTRLR3VINNAME": "ptrlr3vinname"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for parkwork_2019 pipelines"
      args:
        task_id: "parkwork_2019_transform_csv"
        startup_timeout_seconds: 600
        name: "parkwork_2019"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "parkwork.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number",
              "motor_carrier_identification_number_name",
              "gross_vehicle_weight_rating",
              "gross_vehicle_weight_rating_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "underride_override",
              "underride_override_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "related_factors_vehicle_level1",
              "related_factors_vehicle_level1_name",
              "related_factors_vehicle_level2",
              "related_factors_vehicle_level2_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "fatalities_in_vehicle",
              "ptrlr1vin",
              "ptrlr1vinname",
              "ptrlr2vin",
              "ptrlr2vinname",
              "ptrlr3vin",
              "ptrlr3vinname"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number": "str",
              "motor_carrier_identification_number_name": "str",
              "gross_vehicle_weight_rating": "str",
              "gross_vehicle_weight_rating_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "related_factors_vehicle_level1": "str",
              "related_factors_vehicle_level1_name": "str",
              "related_factors_vehicle_level2": "str",
              "related_factors_vehicle_level2_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "fatalities_in_vehicle": "str",
              "ptrlr1vin": "str",
              "ptrlr1vinname": "str",
              "ptrlr2vin": "str",
              "ptrlr2vinname": "str",
              "ptrlr3vin": "str",
              "ptrlr3vinname": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PVE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PNUMOCCS": "number_of_occupants",
              "PNUMOCCSNAME": "number_of_occupants_name",
              "PDAY": "day_of_crash",
              "PDAYNAME": "day_of_crash_name",
              "PMONTH": "month_of_crash",
              "PMONTHNAME": "month_of_crash_name",
              "PHOUR": "hour_of_crash",
              "PHOURNAME": "hour_of_crash_name",
              "PMINUTE": "minute_of_crash",
              "PMINUTENAME": "minute_of_crash_name",
              "PHARM_EV": "first_harmful_event",
              "PHARM_EVNAME": "first_harmful_event_name",
              "PMAN_COLL": "manner_of_collision",
              "PMAN_COLLNAME": "manner_of_collision_name",
              "PTYPE": "unit_type",
              "PTYPENAME": "unit_type_name",
              "PHIT_RUN": "hit_and_run",
              "PHIT_RUNNAME": "hit_and_run_name",
              "PREG_STAT": "registration_state",
              "PREG_STATNAME": "registration_state_name",
              "POWNER": "registered_vehicle_owner",
              "POWNERNAME": "registered_vehicle_owner_name",
              "PMAKE": "vehicle_make",
              "PMAKENAME": "vehicle_make_name",
              "PMODEL": "vehicle_model",
              "PMAK_MOD": "make_model_combined",
              "PBODYTYP": "body_type",
              "PBODYTYPNAME": "body_type_name",
              "PMODYEAR": "vehicle_model_year",
              "PMODYEARNAME": "vehicle_model_year_name",
              "PVIN": "vehicle_identification_number_vin",
              "PVINNAME": "vehicle_identification_number_vin_name",
              "PVIN_1": "vin_character_1",
              "PVIN_2": "vin_character_2",
              "PVIN_3": "vin_character_3",
              "PVIN_4": "vin_character_4",
              "PVIN_5": "vin_character_5",
              "PVIN_6": "vin_character_6",
              "PVIN_7": "vin_character_7",
              "PVIN_8": "vin_character_8",
              "PVIN_9": "vin_character_9",
              "PVIN_10": "vin_character_10",
              "PVIN_11": "vin_character_11",
              "PVIN_12": "vin_character_12",
              "PTRAILER": "vehicle_trailing",
              "PTRAILERNAME": "vehicle_trailing_name",
              "PMCARR_I1": "mcid_issuing_authority",
              "PMCARR_I1NAME": "mcid_issuing_authority_name",
              "PMCARR_I2": "mcid_identification_number",
              "PMCARR_I2NAME": "mcid_identification_number_name",
              "PMCARR_ID": "motor_carrier_identification_number",
              "PMCARR_IDNAME": "motor_carrier_identification_number_name",
              "PGVWR": "gross_vehicle_weight_rating",
              "PGVWRNAME": "gross_vehicle_weight_rating_name",
              "PV_CONFIG": "vehicle_configuration",
              "PV_CONFIGNAME": "vehicle_configuration_name",
              "PCARGTYP": "cargo_body_type",
              "PCARGTYPNAME": "cargo_body_type_name",
              "PHAZ_INV": "hazardous_material_involvement",
              "PHAZ_INVNAME": "hazardous_material_involvement_name",
              "PHAZPLAC": "hazardous_material_placard",
              "PHAZPLACNAME": "hazardous_material_placard_name",
              "PHAZ_ID": "hazardous_material_identification_number",
              "PHAZ_IDNAME": "hazardous_material_identification_number_name",
              "PHAZ_CNO": "hazardous_material_class_number",
              "PHAZ_CNONAME": "hazardous_material_class_number_name",
              "PHAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "PHAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "PBUS_USE": "bus_use",
              "PBUS_USENAME": "bus_use_name",
              "PSP_USE": "special_use",
              "PSP_USENAME": "special_use_name",
              "PEM_USE": "emergency_motor_vehicle_use",
              "PEM_USENAME": "emergency_motor_vehicle_use_name",
              "PUNDERIDE": "underride_override",
              "PUNDERIDENAME": "underride_override_name",
              "PIMPACT1": "initial_contact_point",
              "PIMPACT1NAME": "initial_contact_point_name",
              "PVEH_SEV": "extent_of_damage",
              "PVEH_SEVNAME": "extent_of_damage_name",
              "PTOWED": "vehicle_removal",
              "PTOWEDNAME": "vehicle_removal_name",
              "PM_HARM": "most_harmful_event",
              "PM_HARMNAME": "most_harmful_event_name",
              "PVEH_SC1": "related_factors_vehicle_level1",
              "PVEH_SC1NAME": "related_factors_vehicle_level1_name",
              "PVEH_SC2": "related_factors_vehicle_level2",
              "PVEH_SC2NAME": "related_factors_vehicle_level2_name",
              "PFIRE": "fire_occurrence",
              "PFIRENAME": "fire_occurrence_name",
              "PDEATHS": "fatalities_in_vehicle",
              "PTRLR1VIN": "ptrlr1vin",
              "PTRLR1VINNAME": "ptrlr1vinname",
              "PTRLR2VIN": "ptrlr2vin",
              "PTRLR2VINNAME": "ptrlr2vinname",
              "PTRLR3VIN": "ptrlr3vin",
              "PTRLR3VINNAME": "ptrlr3vinname"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for parkwork_2020 pipelines"
      args:
        task_id: "parkwork_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "parkwork_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "parkwork.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number",
              "motor_carrier_identification_number_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "underride_override",
              "underride_override_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "fatalities_in_vehicle",
              "ptrlr1vin",
              "ptrlr1vinname",
              "ptrlr2vin",
              "ptrlr2vinname",
              "ptrlr3vin",
              "ptrlr3vinname",
              "pvpicmake",
              "pvpicmakename",
              "pvpicmodel",
              "pvpicmodelname",
              "pvpicbodyclass",
              "pvpicbodyclassname",
              "picfinalbody",
              "picfinalbodyname",
              "pgvwr_from",
              "pgvwr_fromname",
              "pgvwr_to",
              "pgvwr_toname",
              "ptrlr1gvwr",
              "ptrlr1gvwrname",
              "ptrlr2gvwr",
              "ptrlr2gvwrname",
              "ptrlr3gvwr",
              "ptrlr3gvwrname"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number": "str",
              "motor_carrier_identification_number_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "fatalities_in_vehicle": "str",
              "ptrlr1vin": "str",
              "ptrlr1vinname": "str",
              "ptrlr2vin": "str",
              "ptrlr2vinname": "str",
              "ptrlr3vin": "str",
              "ptrlr3vinname": "str",
              "pvpicmake": "str",
              "pvpicmakename": "str",
              "pvpicmodel": "str",
              "pvpicmodelname": "str",
              "pvpicbodyclass": "str",
              "pvpicbodyclassname": "str",
              "picfinalbody": "str",
              "picfinalbodyname": "str",
              "pgvwr_from": "str",
              "pgvwr_fromname": "str",
              "pgvwr_to": "str",
              "pgvwr_toname": "str",
              "ptrlr1gvwr": "str",
              "ptrlr1gvwrname": "str",
              "ptrlr2gvwr": "str",
              "ptrlr2gvwrname": "str",
              "ptrlr3gvwr": "str",
              "ptrlr3gvwrname": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PVE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PNUMOCCS": "number_of_occupants",
              "PNUMOCCSNAME": "number_of_occupants_name",
              "PDAY": "day_of_crash",
              "PDAYNAME": "day_of_crash_name",
              "PMONTH": "month_of_crash",
              "PMONTHNAME": "month_of_crash_name",
              "PHOUR": "hour_of_crash",
              "PHOURNAME": "hour_of_crash_name",
              "PMINUTE": "minute_of_crash",
              "PMINUTENAME": "minute_of_crash_name",
              "PHARM_EV": "first_harmful_event",
              "PHARM_EVNAME": "first_harmful_event_name",
              "PMAN_COLL": "manner_of_collision",
              "PMAN_COLLNAME": "manner_of_collision_name",
              "PTYPE": "unit_type",
              "PTYPENAME": "unit_type_name",
              "PHIT_RUN": "hit_and_run",
              "PHIT_RUNNAME": "hit_and_run_name",
              "PREG_STAT": "registration_state",
              "PREG_STATNAME": "registration_state_name",
              "POWNER": "registered_vehicle_owner",
              "POWNERNAME": "registered_vehicle_owner_name",
              "PMAKE": "vehicle_make",
              "PMAKENAME": "vehicle_make_name",
              "PMODEL": "vehicle_model",
              "PMAK_MOD": "make_model_combined",
              "PBODYTYP": "body_type",
              "PBODYTYPNAME": "body_type_name",
              "PMODYEAR": "vehicle_model_year",
              "PMODYEARNAME": "vehicle_model_year_name",
              "PVIN": "vehicle_identification_number_vin",
              "PVINNAME": "vehicle_identification_number_vin_name",
              "PVIN_1": "vin_character_1",
              "PVIN_2": "vin_character_2",
              "PVIN_3": "vin_character_3",
              "PVIN_4": "vin_character_4",
              "PVIN_5": "vin_character_5",
              "PVIN_6": "vin_character_6",
              "PVIN_7": "vin_character_7",
              "PVIN_8": "vin_character_8",
              "PVIN_9": "vin_character_9",
              "PVIN_10": "vin_character_10",
              "PVIN_11": "vin_character_11",
              "PVIN_12": "vin_character_12",
              "PTRAILER": "vehicle_trailing",
              "PTRAILERNAME": "vehicle_trailing_name",
              "PMCARR_I1": "mcid_issuing_authority",
              "PMCARR_I1NAME": "mcid_issuing_authority_name",
              "PMCARR_I2": "mcid_identification_number",
              "PMCARR_I2NAME": "mcid_identification_number_name",
              "PMCARR_ID": "motor_carrier_identification_number",
              "PMCARR_IDNAME": "motor_carrier_identification_number_name",
              "PV_CONFIG": "vehicle_configuration",
              "PV_CONFIGNAME": "vehicle_configuration_name",
              "PCARGTYP": "cargo_body_type",
              "PCARGTYPNAME": "cargo_body_type_name",
              "PHAZ_INV": "hazardous_material_involvement",
              "PHAZ_INVNAME": "hazardous_material_involvement_name",
              "PHAZPLAC": "hazardous_material_placard",
              "PHAZPLACNAME": "hazardous_material_placard_name",
              "PHAZ_ID": "hazardous_material_identification_number",
              "PHAZ_IDNAME": "hazardous_material_identification_number_name",
              "PHAZ_CNO": "hazardous_material_class_number",
              "PHAZ_CNONAME": "hazardous_material_class_number_name",
              "PHAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "PHAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "PBUS_USE": "bus_use",
              "PBUS_USENAME": "bus_use_name",
              "PSP_USE": "special_use",
              "PSP_USENAME": "special_use_name",
              "PEM_USE": "emergency_motor_vehicle_use",
              "PEM_USENAME": "emergency_motor_vehicle_use_name",
              "PUNDERIDE": "underride_override",
              "PUNDERIDENAME": "underride_override_name",
              "PIMPACT1": "initial_contact_point",
              "PIMPACT1NAME": "initial_contact_point_name",
              "PVEH_SEV": "extent_of_damage",
              "PVEH_SEVNAME": "extent_of_damage_name",
              "PTOWED": "vehicle_removal",
              "PTOWEDNAME": "vehicle_removal_name",
              "PM_HARM": "most_harmful_event",
              "PM_HARMNAME": "most_harmful_event_name",
              "PFIRE": "fire_occurrence",
              "PFIRENAME": "fire_occurrence_name",
              "PDEATHS": "fatalities_in_vehicle",
              "PTRLR1VIN": "ptrlr1vin",
              "PTRLR1VINNAME": "ptrlr1vinname",
              "PTRLR2VIN": "ptrlr2vin",
              "PTRLR2VINNAME": "ptrlr2vinname",
              "PTRLR3VIN": "ptrlr3vin",
              "PTRLR3VINNAME": "ptrlr3vinname",
              "PVPICMAKE": "pvpicmake",
              "PVPICMAKENAME": "pvpicmakename",
              "PVPICMODEL": "pvpicmodel",
              "PVPICMODELNAME": "pvpicmodelname",
              "PVPICBODYCLASS": "pvpicbodyclass",
              "PVPICBODYCLASSNAME": "pvpicbodyclassname",
              "PICFINALBODY": "picfinalbody",
              "PICFINALBODYNAME": "picfinalbodyname",
              "PGVWR_FROM": "pgvwr_from",
              "PGVWR_FROMNAME": "pgvwr_fromname",
              "PGVWR_TO": "pgvwr_to",
              "PGVWR_TONAME": "pgvwr_toname",
              "PTRLR1GVWR": "ptrlr1gvwr",
              "PTRLR1GVWRNAME": "ptrlr1gvwrname",
              "PTRLR2GVWR": "ptrlr2gvwr",
              "PTRLR2GVWRNAME": "ptrlr2gvwrname",
              "PTRLR3GVWR": "ptrlr3gvwr",
              "PTRLR3GVWRNAME": "ptrlr3gvwrname"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for pbtype pipelines"
      args:
        task_id: "pbtype_transform_csv"
        startup_timeout_seconds: 600
        name: "pbtype"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "pbtype.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "person_number",
              "person_type",
              "person_type_name",
              "age",
              "age_name",
              "sex",
              "sex_name",
              "marked_crosswalk_present",
              "marked_crosswalk_present_name",
              "sidewalk_present",
              "sidewalk_present_name",
              "school_zone",
              "school_zone_name",
              "crash_type_pedestrian",
              "crash_type_pedestrian_name",
              "crash_type_bicycle",
              "crash_type_bicycle_name",
              "crash_location_pedestrian",
              "crash_location_pedestrian_name",
              "crash_location_bicycle",
              "crash_location_bicycle_name",
              "pedestrian_position",
              "pedestrian_position_name",
              "bicyclist_position",
              "bicyclist_position_name",
              "pedestrian_initial_direction_of_travel",
              "pedestrian_initial_direction_of_travel_name",
              "bicyclist_initial_direction_of_travel",
              "bicyclist_initial_direction_of_travel_name",
              "motorist_initial_direction_of_travel",
              "motorist_initial_direction_of_travel_name",
              "motorist_maneuver",
              "motorist_maneuver_name",
              "intersection_leg",
              "intersection_leg_name",
              "pedestrian_scenario",
              "pedestrian_scenario_name",
              "crash_group_pedestrian",
              "crash_group_pedestrian_name",
              "crash_group_bicycle",
              "crash_group_bicycle_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "person_type": "str",
              "person_type_name": "str",
              "age": "str",
              "age_name": "str",
              "sex": "str",
              "sex_name": "str",
              "marked_crosswalk_present": "str",
              "marked_crosswalk_present_name": "str",
              "sidewalk_present": "str",
              "sidewalk_present_name": "str",
              "school_zone": "str",
              "school_zone_name": "str",
              "crash_type_pedestrian": "str",
              "crash_type_pedestrian_name": "str",
              "crash_type_bicycle": "str",
              "crash_type_bicycle_name": "str",
              "crash_location_pedestrian": "str",
              "crash_location_pedestrian_name": "str",
              "crash_location_bicycle": "str",
              "crash_location_bicycle_name": "str",
              "pedestrian_position": "str",
              "pedestrian_position_name": "str",
              "bicyclist_position": "str",
              "bicyclist_position_name": "str",
              "pedestrian_initial_direction_of_travel": "str",
              "pedestrian_initial_direction_of_travel_name": "str",
              "bicyclist_initial_direction_of_travel": "str",
              "bicyclist_initial_direction_of_travel_name": "str",
              "motorist_initial_direction_of_travel": "str",
              "motorist_initial_direction_of_travel_name": "str",
              "motorist_maneuver": "str",
              "motorist_maneuver_name": "str",
              "intersection_leg": "str",
              "intersection_leg_name": "str",
              "pedestrian_scenario": "str",
              "pedestrian_scenario_name": "str",
              "crash_group_pedestrian": "str",
              "crash_group_pedestrian_name": "str",
              "crash_group_bicycle": "str",
              "crash_group_bicycle_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "PBPTYPE": "person_type",
              "PBPTYPENAME": "person_type_name",
              "PBAGE": "age",
              "PBAGENAME": "age_name",
              "PBSEX": "sex",
              "PBSEXNAME": "sex_name",
              "PBCWALK": "marked_crosswalk_present",
              "PBCWALKNAME": "marked_crosswalk_present_name",
              "PBSWALK": "sidewalk_present",
              "PBSWALKNAME": "sidewalk_present_name",
              "PBSZONE": "school_zone",
              "PBSZONENAME": "school_zone_name",
              "PEDCTYPE": "crash_type_pedestrian",
              "PEDCTYPENAME": "crash_type_pedestrian_name",
              "BIKECTYPE": "crash_type_bicycle",
              "BIKECTYPENAME": "crash_type_bicycle_name",
              "PEDLOC": "crash_location_pedestrian",
              "PEDLOCNAME": "crash_location_pedestrian_name",
              "BIKELOC": "crash_location_bicycle",
              "BIKELOCNAME": "crash_location_bicycle_name",
              "PEDPOS": "pedestrian_position",
              "PEDPOSNAME": "pedestrian_position_name",
              "BIKEPOS": "bicyclist_position",
              "BIKEPOSNAME": "bicyclist_position_name",
              "PEDDIR": "pedestrian_initial_direction_of_travel",
              "PEDDIRNAME": "pedestrian_initial_direction_of_travel_name",
              "BIKEDIR": "bicyclist_initial_direction_of_travel",
              "BIKEDIRNAME": "bicyclist_initial_direction_of_travel_name",
              "MOTDIR": "motorist_initial_direction_of_travel",
              "MOTDIRNAME": "motorist_initial_direction_of_travel_name",
              "MOTMAN": "motorist_maneuver",
              "MOTMANNAME": "motorist_maneuver_name",
              "PEDLEG": "intersection_leg",
              "PEDLEGNAME": "intersection_leg_name",
              "PEDSNR": "pedestrian_scenario",
              "PEDSNRNAME": "pedestrian_scenario_name",
              "PEDCGP": "crash_group_pedestrian",
              "PEDCGPNAME": "crash_group_pedestrian_name",
              "BIKECGP": "crash_group_bicycle",
              "BIKECGPNAME": "crash_group_bicycle_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for person pipelines"
      args:
        task_id: "person_2015_2017_transform_csv"
        startup_timeout_seconds: 600
        name: "person"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "person.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "vehicle_number",
              "person_number",
              "number_of_motor_vehicle_striking_non_motorist",
              "county",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "school_bus_related",
              "school_bus_related_name",
              "vehicle_make",
              "vehicle_make_name",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "model_year",
              "model_year_name",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "rollover",
              "rollover_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "age",
              "age_name",
              "sex",
              "sex_name",
              "person_type",
              "person_type_name",
              "injury_severity",
              "injury_severity_name",
              "seating_position",
              "seating_position_name",
              "restraint_system_helmet_use",
              "restraint_system_helmet_use_name",
              "indication_of_misuse_of_restraint_system_helmet",
              "indication_of_misuse_of_restraint_system_helmet_name",
              "air_bag_deployed",
              "air_bag_deployed_name",
              "ejection",
              "ejection_name",
              "ejection_path",
              "ejection_path_name",
              "extrication",
              "extrication_name",
              "police_reported_alcohol_involvement",
              "police_reported_alcohol_involvement_name",
              "method_of_alcohol_determination_by_police",
              "method_of_alcohol_determination_by_police_name",
              "alcohol_test_status",
              "alcohol_test_status_name",
              "alcohol_test_type",
              "alcohol_test_type_name",
              "alcohol_result",
              "alcohol_result_name",
              "police_reported_drug_involvement",
              "police_reported_drug_involvement_name",
              "method_of_drug_determination_by_police",
              "method_of_drug_determination_by_police_name",
              "drug_test_status",
              "drug_test_status_name",
              "drug_test_type1",
              "drug_test_type1_name",
              "drug_test_type2",
              "drug_test_type2_name",
              "drug_test_type3",
              "drug_test_type3_name",
              "drug_result1",
              "drug_result1_name",
              "drug_result2",
              "drug_result2_name",
              "drug_result3",
              "drug_result3_name",
              "hospital",
              "hospital_name",
              "died_at_scene_en_route",
              "died_at_scene_en_route_name",
              "day_of_death",
              "day_of_death_name",
              "month_of_death",
              "month_of_death_name",
              "year_of_death",
              "year_of_death_name",
              "hour_of_death",
              "hour_of_death_name",
              "minute_of_death",
              "minute_of_death_name",
              "death_time",
              "death_time_name",
              "lag_hours",
              "lag_hours_name",
              "lag_minutes",
              "lag_minutes_name",
              "related_factors_person_level1",
              "related_factors_person_level1_name",
              "related_factors_person_level2",
              "related_factors_person_level2_name",
              "related_factors_person_level3",
              "related_factors_person_level3_name",
              "fatal_injury_at_work",
              "fatal_injury_at_work_name",
              "hispanic_origin",
              "hispanic_origin_name",
              "race",
              "race_name",
              "non_motorist_location_at_time_of_crash",
              "non_motorist_location_at_time_of_crash_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "number_of_motor_vehicle_striking_non_motorist": "str",
              "county": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "school_bus_related": "str",
              "school_bus_related_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "model_year": "str",
              "model_year_name": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "rollover": "str",
              "rollover_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "age": "str",
              "age_name": "str",
              "sex": "str",
              "sex_name": "str",
              "person_type": "str",
              "person_type_name": "str",
              "injury_severity": "str",
              "injury_severity_name": "str",
              "seating_position": "str",
              "seating_position_name": "str",
              "restraint_system_helmet_use": "str",
              "restraint_system_helmet_use_name": "str",
              "indication_of_misuse_of_restraint_system_helmet": "str",
              "indication_of_misuse_of_restraint_system_helmet_name": "str",
              "air_bag_deployed": "str",
              "air_bag_deployed_name": "str",
              "ejection": "str",
              "ejection_name": "str",
              "ejection_path": "str",
              "ejection_path_name": "str",
              "extrication": "str",
              "extrication_name": "str",
              "police_reported_alcohol_involvement": "str",
              "police_reported_alcohol_involvement_name": "str",
              "method_of_alcohol_determination_by_police": "str",
              "method_of_alcohol_determination_by_police_name": "str",
              "alcohol_test_status": "str",
              "alcohol_test_status_name": "str",
              "alcohol_test_type": "str",
              "alcohol_test_type_name": "str",
              "alcohol_result": "str",
              "alcohol_result_name": "str",
              "police_reported_drug_involvement": "str",
              "police_reported_drug_involvement_name": "str",
              "method_of_drug_determination_by_police": "str",
              "method_of_drug_determination_by_police_name": "str",
              "drug_test_status": "str",
              "drug_test_status_name": "str",
              "drug_test_type1": "str",
              "drug_test_type1_name": "str",
              "drug_test_type2": "str",
              "drug_test_type2_name": "str",
              "drug_test_type3": "str",
              "drug_test_type3_name": "str",
              "drug_result1": "str",
              "drug_result1_name": "str",
              "drug_result2": "str",
              "drug_result2_name": "str",
              "drug_result3": "str",
              "drug_result3_name": "str",
              "hospital": "str",
              "hospital_name": "str",
              "died_at_scene_en_route": "str",
              "died_at_scene_en_route_name": "str",
              "day_of_death": "str",
              "day_of_death_name": "str",
              "month_of_death": "str",
              "month_of_death_name": "str",
              "year_of_death": "str",
              "year_of_death_name": "str",
              "hour_of_death": "str",
              "hour_of_death_name": "str",
              "minute_of_death": "str",
              "minute_of_death_name": "str",
              "death_time": "str",
              "death_time_name": "str",
              "lag_hours": "str",
              "lag_hours_name": "str",
              "lag_minutes": "str",
              "lag_minutes_name": "str",
              "related_factors_person_level1": "str",
              "related_factors_person_level1_name": "str",
              "related_factors_person_level2": "str",
              "related_factors_person_level2_name": "str",
              "related_factors_person_level3": "str",
              "related_factors_person_level3_name": "str",
              "fatal_injury_at_work": "str",
              "fatal_injury_at_work_name": "str",
              "hispanic_origin": "str",
              "hispanic_origin_name": "str",
              "race": "str",
              "race_name": "str",
              "non_motorist_location_at_time_of_crash": "str",
              "non_motorist_location_at_time_of_crash_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "STR_VEH": "number_of_motor_vehicle_striking_non_motorist",
              "COUNTY": "county",
              "DAY": "day_of_crash",
              "DAYNAME": "day_of_crash_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "SCH_BUS": "school_bus_related",
              "SCH_BUSNAME": "school_bus_related_name",
              "MAKE": "vehicle_make",
              "MAKENAME": "vehicle_make_name",
              "MAK_MOD": "make_model_combined",
              "BODY_TYP": "body_type",
              "BODY_TYPNAME": "body_type_name",
              "MOD_YEAR": "model_year",
              "MOD_YEARNAME": "model_year_name",
              "TOW_VEH": "vehicle_trailing",
              "TOW_VEHNAME": "vehicle_trailing_name",
              "SPEC_USE": "special_use",
              "SPEC_USENAME": "special_use_name",
              "EMER_USE": "emergency_motor_vehicle_use",
              "EMER_USENAME": "emergency_motor_vehicle_use_name",
              "ROLLOVER": "rollover",
              "ROLLOVERNAME": "rollover_name",
              "IMPACT1": "initial_contact_point",
              "IMPACT1NAME": "initial_contact_point_name",
              "FIRE_EXP": "fire_occurrence",
              "FIRE_EXPNAME": "fire_occurrence_name",
              "AGE": "age",
              "AGENAME": "age_name",
              "SEX": "sex",
              "SEXNAME": "sex_name",
              "PER_TYP": "person_type",
              "PER_TYPNAME": "person_type_name",
              "INJ_SEV": "injury_severity",
              "INJ_SEVNAME": "injury_severity_name",
              "SEAT_POS": "seating_position",
              "SEAT_POSNAME": "seating_position_name",
              "REST_USE": "restraint_system_helmet_use",
              "REST_USENAME": "restraint_system_helmet_use_name",
              "REST_MIS": "indication_of_misuse_of_restraint_system_helmet",
              "REST_MISNAME": "indication_of_misuse_of_restraint_system_helmet_name",
              "AIR_BAG": "air_bag_deployed",
              "AIR_BAGNAME": "air_bag_deployed_name",
              "EJECTION": "ejection",
              "EJECTIONNAME": "ejection_name",
              "EJ_PATH": "ejection_path",
              "EJ_PATHNAME": "ejection_path_name",
              "EXTRICAT": "extrication",
              "EXTRICATNAME": "extrication_name",
              "DRINKING": "police_reported_alcohol_involvement",
              "DRINKINGNAME": "police_reported_alcohol_involvement_name",
              "ALC_DET": "method_of_alcohol_determination_by_police",
              "ALC_DETNAME": "method_of_alcohol_determination_by_police_name",
              "ALC_STATUS": "alcohol_test_status",
              "ALC_STATUSNAME": "alcohol_test_status_name",
              "ATST_TYP": "alcohol_test_type",
              "ATST_TYPNAME": "alcohol_test_type_name",
              "ALC_RES": "alcohol_result",
              "ALC_RESNAME": "alcohol_result_name",
              "DRUGS": "police_reported_drug_involvement",
              "DRUGSNAME": "police_reported_drug_involvement_name",
              "DRUG_DET": "method_of_drug_determination_by_police",
              "DRUG_DETNAME": "method_of_drug_determination_by_police_name",
              "DSTATUS": "drug_test_status",
              "DSTATUSNAME": "drug_test_status_name",
              "DRUGTST1": "drug_test_type1",
              "DRUGTST1NAME": "drug_test_type1_name",
              "DRUGTST2": "drug_test_type2",
              "DRUGTST2NAME": "drug_test_type2_name",
              "DRUGTST3": "drug_test_type3",
              "DRUGTST3NAME": "drug_test_type3_name",
              "DRUGRES1": "drug_result1",
              "DRUGRES1NAME": "drug_result1_name",
              "DRUGRES2": "drug_result2",
              "DRUGRES2NAME": "drug_result2_name",
              "DRUGRES3": "drug_result3",
              "DRUGRES3NAME": "drug_result3_name",
              "HOSPITAL": "hospital",
              "HOSPITALNAME": "hospital_name",
              "DOA": "died_at_scene_en_route",
              "DOANAME": "died_at_scene_en_route_name",
              "DEATH_DA": "day_of_death",
              "DEATH_DANAME": "day_of_death_name",
              "DEATH_MO": "month_of_death",
              "DEATH_MONAME": "month_of_death_name",
              "DEATH_YR": "year_of_death",
              "DEATH_YRNAME": "year_of_death_name",
              "DEATH_HR": "hour_of_death",
              "DEATH_HRNAME": "hour_of_death_name",
              "DEATH_MN": "minute_of_death",
              "DEATH_MNNAME": "minute_of_death_name",
              "DEATH_TM": "death_time",
              "DEATH_TMNAME": "death_time_name",
              "LAG_HRS": "lag_hours",
              "LAG_HRSNAME": "lag_hours_name",
              "LAG_MINS": "lag_minutes",
              "LAG_MINSNAME": "lag_minutes_name",
              "P_SF1": "related_factors_person_level1",
              "P_SF1NAME": "related_factors_person_level1_name",
              "P_SF2": "related_factors_person_level2",
              "P_SF2NAME": "related_factors_person_level2_name",
              "P_SF3": "related_factors_person_level3",
              "P_SF3NAME": "related_factors_person_level3_name",
              "WORK_INJ": "fatal_injury_at_work",
              "WORK_INJNAME": "fatal_injury_at_work_name",
              "HISPANIC": "hispanic_origin",
              "HISPANICNAME": "hispanic_origin_name",
              "RACE": "race",
              "RACENAME": "race_name",
              "LOCATION": "non_motorist_location_at_time_of_crash",
              "LOCATIONNAME": "non_motorist_location_at_time_of_crash_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for person pipelines"
      args:
        task_id: "person_2018_transform_csv"
        startup_timeout_seconds: 600
        name: "person"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.person_2018.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.person_2018.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.person_2018.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "person.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.person_2018.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2018.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2018.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2018.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2018.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.person_2018.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2018.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2018.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "vehicle_number",
              "person_number",
              "number_of_motor_vehicle_striking_non_motorist",
              "county",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "school_bus_related",
              "school_bus_related_name",
              "vehicle_make",
              "vehicle_make_name",
              "make_model_combined",
              "make_model_combined_name",
              "body_type",
              "body_type_name",
              "model_year",
              "model_year_name",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "rollover",
              "rollover_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "age",
              "age_name",
              "sex",
              "sex_name",
              "person_type",
              "person_type_name",
              "injury_severity",
              "injury_severity_name",
              "seating_position",
              "seating_position_name",
              "restraint_system_helmet_use",
              "restraint_system_helmet_use_name",
              "indication_of_misuse_of_restraint_system_helmet",
              "indication_of_misuse_of_restraint_system_helmet_name",
              "air_bag_deployed",
              "air_bag_deployed_name",
              "ejection",
              "ejection_name",
              "ejection_path",
              "ejection_path_name",
              "extrication",
              "extrication_name",
              "police_reported_alcohol_involvement",
              "police_reported_alcohol_involvement_name",
              "method_of_alcohol_determination_by_police",
              "method_of_alcohol_determination_by_police_name",
              "alcohol_test_status",
              "alcohol_test_status_name",
              "alcohol_test_type",
              "alcohol_test_type_name",
              "alcohol_result",
              "alcohol_result_name",
              "police_reported_drug_involvement",
              "police_reported_drug_involvement_name",
              "method_of_drug_determination_by_police",
              "method_of_drug_determination_by_police_name",
              "drug_test_status",
              "drug_test_status_name",
              "hospital",
              "hospital_name",
              "died_at_scene_en_route",
              "died_at_scene_en_route_name",
              "day_of_death",
              "day_of_death_name",
              "month_of_death",
              "month_of_death_name",
              "year_of_death",
              "year_of_death_name",
              "hour_of_death",
              "hour_of_death_name",
              "minute_of_death",
              "minute_of_death_name",
              "death_time",
              "death_time_name",
              "lag_hours",
              "lag_hours_name",
              "lag_minutes",
              "lag_minutes_name",
              "related_factors_person_level1",
              "related_factors_person_level1_name",
              "related_factors_person_level2",
              "related_factors_person_level2_name",
              "related_factors_person_level3",
              "related_factors_person_level3_name",
              "fatal_injury_at_work",
              "fatal_injury_at_work_name",
              "hispanic_origin",
              "hispanic_origin_name",
              "race",
              "race_name",
              "non_motorist_location_at_time_of_crash",
              "non_motorist_location_at_time_of_crash_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "number_of_motor_vehicle_striking_non_motorist": "str",
              "county": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "school_bus_related": "str",
              "school_bus_related_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "make_model_combined": "str",
              "make_model_combined_name": "str",
              "body_type": "str",
              "body_type_name": "str",
              "model_year": "str",
              "model_year_name": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "rollover": "str",
              "rollover_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "age": "str",
              "age_name": "str",
              "sex": "str",
              "sex_name": "str",
              "person_type": "str",
              "person_type_name": "str",
              "injury_severity": "str",
              "injury_severity_name": "str",
              "seating_position": "str",
              "seating_position_name": "str",
              "restraint_system_helmet_use": "str",
              "restraint_system_helmet_use_name": "str",
              "indication_of_misuse_of_restraint_system_helmet": "str",
              "indication_of_misuse_of_restraint_system_helmet_name": "str",
              "air_bag_deployed": "str",
              "air_bag_deployed_name": "str",
              "ejection": "str",
              "ejection_name": "str",
              "ejection_path": "str",
              "ejection_path_name": "str",
              "extrication": "str",
              "extrication_name": "str",
              "police_reported_alcohol_involvement": "str",
              "police_reported_alcohol_involvement_name": "str",
              "method_of_alcohol_determination_by_police": "str",
              "method_of_alcohol_determination_by_police_name": "str",
              "alcohol_test_status": "str",
              "alcohol_test_status_name": "str",
              "alcohol_test_type": "str",
              "alcohol_test_type_name": "str",
              "alcohol_result": "str",
              "alcohol_result_name": "str",
              "police_reported_drug_involvement": "str",
              "police_reported_drug_involvement_name": "str",
              "method_of_drug_determination_by_police": "str",
              "method_of_drug_determination_by_police_name": "str",
              "drug_test_status": "str",
              "drug_test_status_name": "str",
              "hospital": "str",
              "hospital_name": "str",
              "died_at_scene_en_route": "str",
              "died_at_scene_en_route_name": "str",
              "day_of_death": "str",
              "day_of_death_name": "str",
              "month_of_death": "str",
              "month_of_death_name": "str",
              "year_of_death": "str",
              "year_of_death_name": "str",
              "hour_of_death": "str",
              "hour_of_death_name": "str",
              "minute_of_death": "str",
              "minute_of_death_name": "str",
              "death_time": "str",
              "death_time_name": "str",
              "lag_hours": "str",
              "lag_hours_name": "str",
              "lag_minutes": "str",
              "lag_minutes_name": "str",
              "related_factors_person_level1": "str",
              "related_factors_person_level1_name": "str",
              "related_factors_person_level2": "str",
              "related_factors_person_level2_name": "str",
              "related_factors_person_level3": "str",
              "related_factors_person_level3_name": "str",
              "fatal_injury_at_work": "str",
              "fatal_injury_at_work_name": "str",
              "hispanic_origin": "str",
              "hispanic_origin_name": "str",
              "race": "str",
              "race_name": "str",
              "non_motorist_location_at_time_of_crash": "str",
              "non_motorist_location_at_time_of_crash_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "STR_VEH": "number_of_motor_vehicle_striking_non_motorist",
              "COUNTY": "county",
              "DAY": "day_of_crash",
              "DAYNAME": "day_of_crash_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "SCH_BUS": "school_bus_related",
              "SCH_BUSNAME": "school_bus_related_name",
              "MAKE": "vehicle_make",
              "MAKENAME": "vehicle_make_name",
              "MAK_MOD": "make_model_combined",
              "MAK_MODNAME": "make_model_combined_name",
              "BODY_TYP": "body_type",
              "BODY_TYPNAME": "body_type_name",
              "MOD_YEAR": "model_year",
              "MOD_YEARNAME": "model_year_name",
              "TOW_VEH": "vehicle_trailing",
              "TOW_VEHNAME": "vehicle_trailing_name",
              "SPEC_USE": "special_use",
              "SPEC_USENAME": "special_use_name",
              "EMER_USE": "emergency_motor_vehicle_use",
              "EMER_USENAME": "emergency_motor_vehicle_use_name",
              "ROLLOVER": "rollover",
              "ROLLOVERNAME": "rollover_name",
              "IMPACT1": "initial_contact_point",
              "IMPACT1NAME": "initial_contact_point_name",
              "FIRE_EXP": "fire_occurrence",
              "FIRE_EXPNAME": "fire_occurrence_name",
              "AGE": "age",
              "AGENAME": "age_name",
              "SEX": "sex",
              "SEXNAME": "sex_name",
              "PER_TYP": "person_type",
              "PER_TYPNAME": "person_type_name",
              "INJ_SEV": "injury_severity",
              "INJ_SEVNAME": "injury_severity_name",
              "SEAT_POS": "seating_position",
              "SEAT_POSNAME": "seating_position_name",
              "REST_USE": "restraint_system_helmet_use",
              "REST_USENAME": "restraint_system_helmet_use_name",
              "REST_MIS": "indication_of_misuse_of_restraint_system_helmet",
              "REST_MISNAME": "indication_of_misuse_of_restraint_system_helmet_name",
              "AIR_BAG": "air_bag_deployed",
              "AIR_BAGNAME": "air_bag_deployed_name",
              "EJECTION": "ejection",
              "EJECTIONNAME": "ejection_name",
              "EJ_PATH": "ejection_path",
              "EJ_PATHNAME": "ejection_path_name",
              "EXTRICAT": "extrication",
              "EXTRICATNAME": "extrication_name",
              "DRINKING": "police_reported_alcohol_involvement",
              "DRINKINGNAME": "police_reported_alcohol_involvement_name",
              "ALC_DET": "method_of_alcohol_determination_by_police",
              "ALC_DETNAME": "method_of_alcohol_determination_by_police_name",
              "ALC_STATUS": "alcohol_test_status",
              "ALC_STATUSNAME": "alcohol_test_status_name",
              "ATST_TYP": "alcohol_test_type",
              "ATST_TYPNAME": "alcohol_test_type_name",
              "ALC_RES": "alcohol_result",
              "ALC_RESNAME": "alcohol_result_name",
              "DRUGS": "police_reported_drug_involvement",
              "DRUGSNAME": "police_reported_drug_involvement_name",
              "DRUG_DET": "method_of_drug_determination_by_police",
              "DRUG_DETNAME": "method_of_drug_determination_by_police_name",
              "DSTATUS": "drug_test_status",
              "DSTATUSNAME": "drug_test_status_name",
              "HOSPITAL": "hospital",
              "HOSPITALNAME": "hospital_name",
              "DOA": "died_at_scene_en_route",
              "DOANAME": "died_at_scene_en_route_name",
              "DEATH_DA": "day_of_death",
              "DEATH_DANAME": "day_of_death_name",
              "DEATH_MO": "month_of_death",
              "DEATH_MONAME": "month_of_death_name",
              "DEATH_YR": "year_of_death",
              "DEATH_YRNAME": "year_of_death_name",
              "DEATH_HR": "hour_of_death",
              "DEATH_HRNAME": "hour_of_death_name",
              "DEATH_MN": "minute_of_death",
              "DEATH_MNNAME": "minute_of_death_name",
              "DEATH_TM": "death_time",
              "DEATH_TMNAME": "death_time_name",
              "LAG_HRS": "lag_hours",
              "LAG_HRSNAME": "lag_hours_name",
              "LAG_MINS": "lag_minutes",
              "LAG_MINSNAME": "lag_minutes_name",
              "P_SF1": "related_factors_person_level1",
              "P_SF1NAME": "related_factors_person_level1_name",
              "P_SF2": "related_factors_person_level2",
              "P_SF2NAME": "related_factors_person_level2_name",
              "P_SF3": "related_factors_person_level3",
              "P_SF3NAME": "related_factors_person_level3_name",
              "WORK_INJ": "fatal_injury_at_work",
              "WORK_INJNAME": "fatal_injury_at_work_name",
              "HISPANIC": "hispanic_origin",
              "HISPANICNAME": "hispanic_origin_name",
              "RACE": "race",
              "RACENAME": "race_name",
              "LOCATION": "non_motorist_location_at_time_of_crash",
              "LOCATIONNAME": "non_motorist_location_at_time_of_crash_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for person pipelines"
      args:
        task_id: "person_2019_transform_csv"
        startup_timeout_seconds: 600
        name: "person"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.person_2019.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.person_2019.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.person_2019.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "person.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.person_2019.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2019.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2019.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2019.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2019.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.person_2019.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2019.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2019.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "vehicle_number",
              "person_number",
              "number_of_motor_vehicle_striking_non_motorist",
              "county",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "school_bus_related",
              "school_bus_related_name",
              "vehicle_make",
              "vehicle_make_name",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "model_year",
              "model_year_name",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "rollover",
              "rollover_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "age",
              "age_name",
              "sex",
              "sex_name",
              "person_type",
              "person_type_name",
              "injury_severity",
              "injury_severity_name",
              "seating_position",
              "seating_position_name",
              "restraint_system_helmet_use",
              "restraint_system_helmet_use_name",
              "indication_of_misuse_of_restraint_system_helmet",
              "indication_of_misuse_of_restraint_system_helmet_name",
              "air_bag_deployed",
              "air_bag_deployed_name",
              "ejection",
              "ejection_name",
              "ejection_path",
              "ejection_path_name",
              "extrication",
              "extrication_name",
              "police_reported_alcohol_involvement",
              "police_reported_alcohol_involvement_name",
              "method_of_alcohol_determination_by_police",
              "method_of_alcohol_determination_by_police_name",
              "alcohol_test_status",
              "alcohol_test_status_name",
              "alcohol_test_type",
              "alcohol_test_type_name",
              "alcohol_result",
              "alcohol_result_name",
              "police_reported_drug_involvement",
              "police_reported_drug_involvement_name",
              "method_of_drug_determination_by_police",
              "method_of_drug_determination_by_police_name",
              "drug_test_status",
              "drug_test_status_name",
              "hospital",
              "hospital_name",
              "died_at_scene_en_route",
              "died_at_scene_en_route_name",
              "day_of_death",
              "day_of_death_name",
              "month_of_death",
              "month_of_death_name",
              "year_of_death",
              "year_of_death_name",
              "hour_of_death",
              "hour_of_death_name",
              "minute_of_death",
              "minute_of_death_name",
              "death_time",
              "death_time_name",
              "lag_hours",
              "lag_hours_name",
              "lag_minutes",
              "lag_minutes_name",
              "related_factors_person_level1",
              "related_factors_person_level1_name",
              "related_factors_person_level2",
              "related_factors_person_level2_name",
              "related_factors_person_level3",
              "related_factors_person_level3_name",
              "fatal_injury_at_work",
              "fatal_injury_at_work_name",
              "hispanic_origin",
              "hispanic_origin_name",
              "non_motorist_location_at_time_of_crash",
              "non_motorist_location_at_time_of_crash_name",
              "helm_use",
              "helm_usename",
              "helm_mis",
              "helm_misname"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "number_of_motor_vehicle_striking_non_motorist": "str",
              "county": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "school_bus_related": "str",
              "school_bus_related_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "model_year": "str",
              "model_year_name": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "rollover": "str",
              "rollover_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "age": "str",
              "age_name": "str",
              "sex": "str",
              "sex_name": "str",
              "person_type": "str",
              "person_type_name": "str",
              "injury_severity": "str",
              "injury_severity_name": "str",
              "seating_position": "str",
              "seating_position_name": "str",
              "restraint_system_helmet_use": "str",
              "restraint_system_helmet_use_name": "str",
              "indication_of_misuse_of_restraint_system_helmet": "str",
              "indication_of_misuse_of_restraint_system_helmet_name": "str",
              "air_bag_deployed": "str",
              "air_bag_deployed_name": "str",
              "ejection": "str",
              "ejection_name": "str",
              "ejection_path": "str",
              "ejection_path_name": "str",
              "extrication": "str",
              "extrication_name": "str",
              "police_reported_alcohol_involvement": "str",
              "police_reported_alcohol_involvement_name": "str",
              "method_of_alcohol_determination_by_police": "str",
              "method_of_alcohol_determination_by_police_name": "str",
              "alcohol_test_status": "str",
              "alcohol_test_status_name": "str",
              "alcohol_test_type": "str",
              "alcohol_test_type_name": "str",
              "alcohol_result": "str",
              "alcohol_result_name": "str",
              "police_reported_drug_involvement": "str",
              "police_reported_drug_involvement_name": "str",
              "method_of_drug_determination_by_police": "str",
              "method_of_drug_determination_by_police_name": "str",
              "drug_test_status": "str",
              "drug_test_status_name": "str",
              "hospital": "str",
              "hospital_name": "str",
              "died_at_scene_en_route": "str",
              "died_at_scene_en_route_name": "str",
              "day_of_death": "str",
              "day_of_death_name": "str",
              "month_of_death": "str",
              "month_of_death_name": "str",
              "year_of_death": "str",
              "year_of_death_name": "str",
              "hour_of_death": "str",
              "hour_of_death_name": "str",
              "minute_of_death": "str",
              "minute_of_death_name": "str",
              "death_time": "str",
              "death_time_name": "str",
              "lag_hours": "str",
              "lag_hours_name": "str",
              "lag_minutes": "str",
              "lag_minutes_name": "str",
              "related_factors_person_level1": "str",
              "related_factors_person_level1_name": "str",
              "related_factors_person_level2": "str",
              "related_factors_person_level2_name": "str",
              "related_factors_person_level3": "str",
              "related_factors_person_level3_name": "str",
              "fatal_injury_at_work": "str",
              "fatal_injury_at_work_name": "str",
              "hispanic_origin": "str",
              "hispanic_origin_name": "str",
              "non_motorist_location_at_time_of_crash": "str",
              "non_motorist_location_at_time_of_crash_name": "str",
              "helm_use": "str",
              "helm_usename": "str",
              "helm_mis": "str",
              "helm_misname": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "STR_VEH": "number_of_motor_vehicle_striking_non_motorist",
              "COUNTY": "county",
              "DAY": "day_of_crash",
              "DAYNAME": "day_of_crash_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "SCH_BUS": "school_bus_related",
              "SCH_BUSNAME": "school_bus_related_name",
              "MAKE": "vehicle_make",
              "MAKENAME": "vehicle_make_name",
              "MAK_MOD": "make_model_combined",
              "BODY_TYP": "body_type",
              "BODY_TYPNAME": "body_type_name",
              "MOD_YEAR": "model_year",
              "MOD_YEARNAME": "model_year_name",
              "TOW_VEH": "vehicle_trailing",
              "TOW_VEHNAME": "vehicle_trailing_name",
              "SPEC_USE": "special_use",
              "SPEC_USENAME": "special_use_name",
              "EMER_USE": "emergency_motor_vehicle_use",
              "EMER_USENAME": "emergency_motor_vehicle_use_name",
              "ROLLOVER": "rollover",
              "ROLLOVERNAME": "rollover_name",
              "IMPACT1": "initial_contact_point",
              "IMPACT1NAME": "initial_contact_point_name",
              "FIRE_EXP": "fire_occurrence",
              "FIRE_EXPNAME": "fire_occurrence_name",
              "AGE": "age",
              "AGENAME": "age_name",
              "SEX": "sex",
              "SEXNAME": "sex_name",
              "PER_TYP": "person_type",
              "PER_TYPNAME": "person_type_name",
              "INJ_SEV": "injury_severity",
              "INJ_SEVNAME": "injury_severity_name",
              "SEAT_POS": "seating_position",
              "SEAT_POSNAME": "seating_position_name",
              "REST_USE": "restraint_system_helmet_use",
              "REST_USENAME": "restraint_system_helmet_use_name",
              "REST_MIS": "indication_of_misuse_of_restraint_system_helmet",
              "REST_MISNAME": "indication_of_misuse_of_restraint_system_helmet_name",
              "AIR_BAG": "air_bag_deployed",
              "AIR_BAGNAME": "air_bag_deployed_name",
              "EJECTION": "ejection",
              "EJECTIONNAME": "ejection_name",
              "EJ_PATH": "ejection_path",
              "EJ_PATHNAME": "ejection_path_name",
              "EXTRICAT": "extrication",
              "EXTRICATNAME": "extrication_name",
              "DRINKING": "police_reported_alcohol_involvement",
              "DRINKINGNAME": "police_reported_alcohol_involvement_name",
              "ALC_DET": "method_of_alcohol_determination_by_police",
              "ALC_DETNAME": "method_of_alcohol_determination_by_police_name",
              "ALC_STATUS": "alcohol_test_status",
              "ALC_STATUSNAME": "alcohol_test_status_name",
              "ATST_TYP": "alcohol_test_type",
              "ATST_TYPNAME": "alcohol_test_type_name",
              "ALC_RES": "alcohol_result",
              "ALC_RESNAME": "alcohol_result_name",
              "DRUGS": "police_reported_drug_involvement",
              "DRUGSNAME": "police_reported_drug_involvement_name",
              "DRUG_DET": "method_of_drug_determination_by_police",
              "DRUG_DETNAME": "method_of_drug_determination_by_police_name",
              "DSTATUS": "drug_test_status",
              "DSTATUSNAME": "drug_test_status_name",
              "HOSPITAL": "hospital",
              "HOSPITALNAME": "hospital_name",
              "DOA": "died_at_scene_en_route",
              "DOANAME": "died_at_scene_en_route_name",
              "DEATH_DA": "day_of_death",
              "DEATH_DANAME": "day_of_death_name",
              "DEATH_MO": "month_of_death",
              "DEATH_MONAME": "month_of_death_name",
              "DEATH_YR": "year_of_death",
              "DEATH_YRNAME": "year_of_death_name",
              "DEATH_HR": "hour_of_death",
              "DEATH_HRNAME": "hour_of_death_name",
              "DEATH_MN": "minute_of_death",
              "DEATH_MNNAME": "minute_of_death_name",
              "DEATH_TM": "death_time",
              "DEATH_TMNAME": "death_time_name",
              "LAG_HRS": "lag_hours",
              "LAG_HRSNAME": "lag_hours_name",
              "LAG_MINS": "lag_minutes",
              "LAG_MINSNAME": "lag_minutes_name",
              "P_SF1": "related_factors_person_level1",
              "P_SF1NAME": "related_factors_person_level1_name",
              "P_SF2": "related_factors_person_level2",
              "P_SF2NAME": "related_factors_person_level2_name",
              "P_SF3": "related_factors_person_level3",
              "P_SF3NAME": "related_factors_person_level3_name",
              "WORK_INJ": "fatal_injury_at_work",
              "WORK_INJNAME": "fatal_injury_at_work_name",
              "HISPANIC": "hispanic_origin",
              "HISPANICNAME": "hispanic_origin_name",
              "LOCATION": "non_motorist_location_at_time_of_crash",
              "LOCATIONNAME": "non_motorist_location_at_time_of_crash_name",
              "HELM_USE": "helm_use",
              "HELM_USENAME": "helm_usename",
              "HELM_MIS": "helm_mis",
              "HELM_MISNAME": "helm_misname"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for person pipelines"
      args:
        task_id: "person_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "person"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.person_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.person_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.person_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "person.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.person_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.person_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "vehicle_number",
              "person_number",
              "number_of_motor_vehicle_striking_non_motorist",
              "county",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "school_bus_related",
              "school_bus_related_name",
              "vehicle_make",
              "vehicle_make_name",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "model_year",
              "model_year_name",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "rollover",
              "rollover_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "age",
              "age_name",
              "sex",
              "sex_name",
              "person_type",
              "person_type_name",
              "injury_severity",
              "injury_severity_name",
              "seating_position",
              "seating_position_name",
              "restraint_system_helmet_use",
              "restraint_system_helmet_use_name",
              "indication_of_misuse_of_restraint_system_helmet",
              "indication_of_misuse_of_restraint_system_helmet_name",
              "air_bag_deployed",
              "air_bag_deployed_name",
              "ejection",
              "ejection_name",
              "ejection_path",
              "ejection_path_name",
              "extrication",
              "extrication_name",
              "police_reported_alcohol_involvement",
              "police_reported_alcohol_involvement_name",
              "method_of_alcohol_determination_by_police",
              "method_of_alcohol_determination_by_police_name",
              "alcohol_test_status",
              "alcohol_test_status_name",
              "alcohol_test_type",
              "alcohol_test_type_name",
              "alcohol_result",
              "alcohol_result_name",
              "police_reported_drug_involvement",
              "police_reported_drug_involvement_name",
              "method_of_drug_determination_by_police",
              "method_of_drug_determination_by_police_name",
              "drug_test_status",
              "drug_test_status_name",
              "hospital",
              "hospital_name",
              "died_at_scene_en_route",
              "died_at_scene_en_route_name",
              "day_of_death",
              "day_of_death_name",
              "month_of_death",
              "month_of_death_name",
              "year_of_death",
              "year_of_death_name",
              "hour_of_death",
              "hour_of_death_name",
              "minute_of_death",
              "minute_of_death_name",
              "death_time",
              "death_time_name",
              "lag_hours",
              "lag_hours_name",
              "lag_minutes",
              "lag_minutes_name",
              "fatal_injury_at_work",
              "fatal_injury_at_work_name",
              "hispanic_origin",
              "hispanic_origin_name",
              "non_motorist_location_at_time_of_crash",
              "non_motorist_location_at_time_of_crash_name",
              "helm_use",
              "helm_usename",
              "helm_mis",
              "helm_misname",
              "vpic_make",
              "vpic_make_name",
              "vpic_model",
              "vpic_model_name",
              "vpic_body_class",
              "vpic_body_class_name",
              "icfinal_body",
              "icfinalbody_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "number_of_motor_vehicle_striking_non_motorist": "str",
              "county": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "school_bus_related": "str",
              "school_bus_related_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "model_year": "str",
              "model_year_name": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "rollover": "str",
              "rollover_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "age": "str",
              "age_name": "str",
              "sex": "str",
              "sex_name": "str",
              "person_type": "str",
              "person_type_name": "str",
              "injury_severity": "str",
              "injury_severity_name": "str",
              "seating_position": "str",
              "seating_position_name": "str",
              "restraint_system_helmet_use": "str",
              "restraint_system_helmet_use_name": "str",
              "indication_of_misuse_of_restraint_system_helmet": "str",
              "indication_of_misuse_of_restraint_system_helmet_name": "str",
              "air_bag_deployed": "str",
              "air_bag_deployed_name": "str",
              "ejection": "str",
              "ejection_name": "str",
              "ejection_path": "str",
              "ejection_path_name": "str",
              "extrication": "str",
              "extrication_name": "str",
              "police_reported_alcohol_involvement": "str",
              "police_reported_alcohol_involvement_name": "str",
              "method_of_alcohol_determination_by_police": "str",
              "method_of_alcohol_determination_by_police_name": "str",
              "alcohol_test_status": "str",
              "alcohol_test_status_name": "str",
              "alcohol_test_type": "str",
              "alcohol_test_type_name": "str",
              "alcohol_result": "str",
              "alcohol_result_name": "str",
              "police_reported_drug_involvement": "str",
              "police_reported_drug_involvement_name": "str",
              "method_of_drug_determination_by_police": "str",
              "method_of_drug_determination_by_police_name": "str",
              "drug_test_status": "str",
              "drug_test_status_name": "str",
              "hospital": "str",
              "hospital_name": "str",
              "died_at_scene_en_route": "str",
              "died_at_scene_en_route_name": "str",
              "day_of_death": "str",
              "day_of_death_name": "str",
              "month_of_death": "str",
              "month_of_death_name": "str",
              "year_of_death": "str",
              "year_of_death_name": "str",
              "hour_of_death": "str",
              "hour_of_death_name": "str",
              "minute_of_death": "str",
              "minute_of_death_name": "str",
              "death_time": "str",
              "death_time_name": "str",
              "lag_hours": "str",
              "lag_hours_name": "str",
              "lag_minutes": "str",
              "lag_minutes_name": "str",
              "fatal_injury_at_work": "str",
              "fatal_injury_at_work_name": "str",
              "hispanic_origin": "str",
              "hispanic_origin_name": "str",
              "non_motorist_location_at_time_of_crash": "str",
              "non_motorist_location_at_time_of_crash_name": "str",
              "helm_use": "str",
              "helm_usename": "str",
              "helm_mis": "str",
              "helm_misname": "str",
              "vpic_make": "str",
              "vpic_make_name": "str",
              "vpic_model": "str",
              "vpic_model_name": "str",
              "vpic_body_class": "str",
              "vpic_body_class_name": "str",
              "icfinal_body": "str",
              "icfinalbody_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "STR_VEH": "number_of_motor_vehicle_striking_non_motorist",
              "COUNTY": "county",
              "DAY": "day_of_crash",
              "DAYNAME": "day_of_crash_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "SCH_BUS": "school_bus_related",
              "SCH_BUSNAME": "school_bus_related_name",
              "MAKE": "vehicle_make",
              "MAKENAME": "vehicle_make_name",
              "MAK_MOD": "make_model_combined",
              "BODY_TYP": "body_type",
              "BODY_TYPNAME": "body_type_name",
              "MOD_YEAR": "model_year",
              "MOD_YEARNAME": "model_year_name",
              "TOW_VEH": "vehicle_trailing",
              "TOW_VEHNAME": "vehicle_trailing_name",
              "SPEC_USE": "special_use",
              "SPEC_USENAME": "special_use_name",
              "EMER_USE": "emergency_motor_vehicle_use",
              "EMER_USENAME": "emergency_motor_vehicle_use_name",
              "ROLLOVER": "rollover",
              "ROLLOVERNAME": "rollover_name",
              "IMPACT1": "initial_contact_point",
              "IMPACT1NAME": "initial_contact_point_name",
              "FIRE_EXP": "fire_occurrence",
              "FIRE_EXPNAME": "fire_occurrence_name",
              "AGE": "age",
              "AGENAME": "age_name",
              "SEX": "sex",
              "SEXNAME": "sex_name",
              "PER_TYP": "person_type",
              "PER_TYPNAME": "person_type_name",
              "INJ_SEV": "injury_severity",
              "INJ_SEVNAME": "injury_severity_name",
              "SEAT_POS": "seating_position",
              "SEAT_POSNAME": "seating_position_name",
              "REST_USE": "restraint_system_helmet_use",
              "REST_USENAME": "restraint_system_helmet_use_name",
              "REST_MIS": "indication_of_misuse_of_restraint_system_helmet",
              "REST_MISNAME": "indication_of_misuse_of_restraint_system_helmet_name",
              "AIR_BAG": "air_bag_deployed",
              "AIR_BAGNAME": "air_bag_deployed_name",
              "EJECTION": "ejection",
              "EJECTIONNAME": "ejection_name",
              "EJ_PATH": "ejection_path",
              "EJ_PATHNAME": "ejection_path_name",
              "EXTRICAT": "extrication",
              "EXTRICATNAME": "extrication_name",
              "DRINKING": "police_reported_alcohol_involvement",
              "DRINKINGNAME": "police_reported_alcohol_involvement_name",
              "ALC_DET": "method_of_alcohol_determination_by_police",
              "ALC_DETNAME": "method_of_alcohol_determination_by_police_name",
              "ALC_STATUS": "alcohol_test_status",
              "ALC_STATUSNAME": "alcohol_test_status_name",
              "ATST_TYP": "alcohol_test_type",
              "ATST_TYPNAME": "alcohol_test_type_name",
              "ALC_RES": "alcohol_result",
              "ALC_RESNAME": "alcohol_result_name",
              "DRUGS": "police_reported_drug_involvement",
              "DRUGSNAME": "police_reported_drug_involvement_name",
              "DRUG_DET": "method_of_drug_determination_by_police",
              "DRUG_DETNAME": "method_of_drug_determination_by_police_name",
              "DSTATUS": "drug_test_status",
              "DSTATUSNAME": "drug_test_status_name",
              "HOSPITAL": "hospital",
              "HOSPITALNAME": "hospital_name",
              "DOA": "died_at_scene_en_route",
              "DOANAME": "died_at_scene_en_route_name",
              "DEATH_DA": "day_of_death",
              "DEATH_DANAME": "day_of_death_name",
              "DEATH_MO": "month_of_death",
              "DEATH_MONAME": "month_of_death_name",
              "DEATH_YR": "year_of_death",
              "DEATH_YRNAME": "year_of_death_name",
              "DEATH_HR": "hour_of_death",
              "DEATH_HRNAME": "hour_of_death_name",
              "DEATH_MN": "minute_of_death",
              "DEATH_MNNAME": "minute_of_death_name",
              "DEATH_TM": "death_time",
              "DEATH_TMNAME": "death_time_name",
              "LAG_HRS": "lag_hours",
              "LAG_HRSNAME": "lag_hours_name",
              "LAG_MINS": "lag_minutes",
              "LAG_MINSNAME": "lag_minutes_name",
              "WORK_INJ": "fatal_injury_at_work",
              "WORK_INJNAME": "fatal_injury_at_work_name",
              "HISPANIC": "hispanic_origin",
              "HISPANICNAME": "hispanic_origin_name",
              "LOCATION": "non_motorist_location_at_time_of_crash",
              "LOCATIONNAME": "non_motorist_location_at_time_of_crash_name",
              "HELM_USE": "helm_use",
              "HELM_USENAME": "helm_usename",
              "HELM_MIS": "helm_mis",
              "HELM_MISNAME": "helm_misname",
              "VPICMAKE": "vpic_make",
              "VPICMAKENAME": "vpic_make_name",
              "VPICMODEL": "vpic_model",
              "VPICMODELNAME": "vpic_model_name",
              "VPICBODYCLASS": "vpic_body_class",
              "VPICBODYCLASSNAME": "vpic_body_class_name",
              "ICFINALBODY": "icfinal_body",
              "ICFINALBODYNAME": "icfinalbody_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for safetyeq pipelines"
      args:
        task_id: "safetyeq_2015_2016_transform_csv"
        startup_timeout_seconds: 600
        name: "safetyeq"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "safetyeq.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "person_number",
              "non_motorist_safety_equipment_use",
              "non_motorist_safety_equipment_use_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "non_motorist_safety_equipment_use": "str",
              "non_motorist_safety_equipment_use_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "MSAFEQMT": "non_motorist_safety_equipment_use",
              "MSAFEQMTNAME": "non_motorist_safety_equipment_use_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for safetyeq pipelines"
      args:
        task_id: "safetyeq_2017_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "safetyeq"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "safetyeq.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "person_number",
              "nm_helmet",
              "nm_helmet_name",
              "nm_propad",
              "nm_propad_name",
              "nm_othpro",
              "nm_othpro_name",
              "nm_refclo",
              "nm_refclo_name",
              "nm_light",
              "nm_light_name",
              "nm_othpre",
              "nm_othpre_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "nm_helmet": "str",
              "nm_helmet_name": "str",
              "nm_propad": "str",
              "nm_propad_name": "str",
              "nm_othpro": "str",
              "nm_othpro_name": "str",
              "nm_refclo": "str",
              "nm_refclo_name": "str",
              "nm_light": "str",
              "nm_light_name": "str",
              "nm_othpre": "str",
              "nm_othpre_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "NMHELMET": "nm_helmet",
              "NMHELMETNAME": "nm_helmet_name",
              "NMPROPAD": "nm_propad",
              "NMPROPADNAME": "nm_propad_name",
              "NMOTHPRO": "nm_othpro",
              "NMOTHPRONAME": "nm_othpro_name",
              "NMREFCLO": "nm_refclo",
              "NMREFCLONAME": "nm_refclo_name",
              "NMLIGHT": "nm_light",
              "NMLIGHTNAME": "nm_light_name",
              "NMOTHPRE": "nm_othpre",
              "NMOTHPRENAME": "nm_othpre_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for vehicle pipelines"
      args:
        task_id: "vehicle_2015_transform_csv"
        startup_timeout_seconds: 600
        name: "vehicle"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2015.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2015.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2015.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "vehicle.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2015.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2015.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2015.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2015.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2015.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2015.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2015.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2015.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "make_model_combined_name",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "jackknife",
              "jackknife_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number_mcid",
              "motor_carrier_identification_number_mcid_name",
              "gross_vehicle_weight_rating",
              "gross_vehicle_weight_rating_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "travel_speed",
              "travel_speed_name",
              "underride_override",
              "underride_override_name",
              "rollover",
              "rollover_name",
              "location_of_rollover",
              "location_of_rollover_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "related_factors_vehicle_level_1",
              "related_factors_vehicle_level_1_name",
              "related_factors_vehicle_level_2",
              "related_factors_vehicle_level_2_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "driver_presence",
              "driver_presence_name",
              "drivers_license_state",
              "drivers_license_state_name",
              "drivers_zip_code",
              "drivers_zip_code_name",
              "non_cdl_license_status",
              "non_cdl_license_status_name",
              "non_cdl_license_type",
              "non_cdl_license_type_name",
              "commercial_motor_vehicle_license_status",
              "commercial_motor_vehicle_license_status_name",
              "compliance_with_cdl_endorsements",
              "compliance_with_cdl_endorsements_name",
              "license_compliance_with_class_of_vehicle",
              "license_compliance_with_class_of_vehicle_name",
              "compliance_with_license_restrictions",
              "compliance_with_license_restrictions_name",
              "driver_height",
              "driver_height_name",
              "driver_weight",
              "driver_weight_name",
              "previous_recorded_crashes",
              "previous_recorded_crashes_name",
              "previous_recorded_suspensions_and_revocations",
              "previous_recorded_suspensions_and_revocations_name",
              "previous_dwi_convictions",
              "previous_dwi_convictions_name",
              "previous_speeding_convictions",
              "previous_speeding_convictions_name",
              "previous_other_moving_violation_convictions",
              "previous_other_moving_violation_convictions_name",
              "month_of_first_crash_suspension_or_conviction",
              "month_of_first_crash_suspension_or_conviction_name",
              "year_of_first_crash_suspension_or_conviction",
              "year_of_first_crash_suspension_or_conviction_name",
              "month_of_last_crash_suspension_or_conviction",
              "month_of_last_crash_suspension_or_conviction_name",
              "year_of_last_crash_suspension_or_conviction",
              "year_of_last_crash_suspension_or_conviction_name",
              "speeding_related",
              "speeding_related_name",
              "related_factors_driver_level_1",
              "related_factors_driver_level_1_name",
              "related_factors_driver_level_2",
              "related_factors_driver_level_2_name",
              "related_factors_driver_level_3",
              "related_factors_driver_level_3_name",
              "related_factors_driver_level_4",
              "related_factors_driver_level_4_name",
              "trafficway_description",
              "trafficway_description_name",
              "total_lanes_in_roadway",
              "total_lanes_in_roadway_name",
              "speed_limit",
              "speed_limit_name",
              "roadway_alignment",
              "roadway_alignment_name",
              "roadway_grade",
              "roadway_grade_name",
              "roadway_surface_type",
              "roadway_surface_type_name",
              "roadway_surface_condition",
              "roadway_surface_condition_name",
              "traffic_control_device",
              "traffic_control_device_name",
              "traffic_control_device_functioning",
              "traffic_control_device_functioning_name",
              "pre_event_movement_prior_to_recognition_of_critical_event",
              "pre_event_movement_prior_to_recognition_of_critical_event_name",
              "critical_event_precrash",
              "critical_event_precrash_name",
              "attempted_avoidance_maneuver",
              "attempted_avoidance_maneuver_name",
              "pre_impact_stability",
              "pre_impact_stability_name",
              "pre_impact_location",
              "pre_impact_location_name",
              "crash_type",
              "crash_type_name",
              "fatalities_in_vehicle",
              "driver_drinking",
              "driver_drinking_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "make_model_combined_name": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "jackknife": "str",
              "jackknife_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number_mcid": "str",
              "motor_carrier_identification_number_mcid_name": "str",
              "gross_vehicle_weight_rating": "str",
              "gross_vehicle_weight_rating_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "travel_speed": "str",
              "travel_speed_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "rollover": "str",
              "rollover_name": "str",
              "location_of_rollover": "str",
              "location_of_rollover_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "related_factors_vehicle_level_1": "str",
              "related_factors_vehicle_level_1_name": "str",
              "related_factors_vehicle_level_2": "str",
              "related_factors_vehicle_level_2_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "driver_presence": "str",
              "driver_presence_name": "str",
              "drivers_license_state": "str",
              "drivers_license_state_name": "str",
              "drivers_zip_code": "str",
              "drivers_zip_code_name": "str",
              "non_cdl_license_status": "str",
              "non_cdl_license_status_name": "str",
              "non_cdl_license_type": "str",
              "non_cdl_license_type_name": "str",
              "commercial_motor_vehicle_license_status": "str",
              "commercial_motor_vehicle_license_status_name": "str",
              "compliance_with_cdl_endorsements": "str",
              "compliance_with_cdl_endorsements_name": "str",
              "license_compliance_with_class_of_vehicle": "str",
              "license_compliance_with_class_of_vehicle_name": "str",
              "compliance_with_license_restrictions": "str",
              "compliance_with_license_restrictions_name": "str",
              "driver_height": "str",
              "driver_height_name": "str",
              "driver_weight": "str",
              "driver_weight_name": "str",
              "previous_recorded_crashes": "str",
              "previous_recorded_crashes_name": "str",
              "previous_recorded_suspensions_and_revocations": "str",
              "previous_recorded_suspensions_and_revocations_name": "str",
              "previous_dwi_convictions": "str",
              "previous_dwi_convictions_name": "str",
              "previous_speeding_convictions": "str",
              "previous_speeding_convictions_name": "str",
              "previous_other_moving_violation_convictions": "str",
              "previous_other_moving_violation_convictions_name": "str",
              "month_of_first_crash_suspension_or_conviction": "str",
              "month_of_first_crash_suspension_or_conviction_name": "str",
              "year_of_first_crash_suspension_or_conviction": "str",
              "year_of_first_crash_suspension_or_conviction_name": "str",
              "month_of_last_crash_suspension_or_conviction": "str",
              "month_of_last_crash_suspension_or_conviction_name": "str",
              "year_of_last_crash_suspension_or_conviction": "str",
              "year_of_last_crash_suspension_or_conviction_name": "str",
              "speeding_related": "str",
              "speeding_related_name": "str",
              "related_factors_driver_level_1": "str",
              "related_factors_driver_level_1_name": "str",
              "related_factors_driver_level_2": "str",
              "related_factors_driver_level_2_name": "str",
              "related_factors_driver_level_3": "str",
              "related_factors_driver_level_3_name": "str",
              "related_factors_driver_level_4": "str",
              "related_factors_driver_level_4_name": "str",
              "trafficway_description": "str",
              "trafficway_description_name": "str",
              "total_lanes_in_roadway": "str",
              "total_lanes_in_roadway_name": "str",
              "speed_limit": "str",
              "speed_limit_name": "str",
              "roadway_alignment": "str",
              "roadway_alignment_name": "str",
              "roadway_grade": "str",
              "roadway_grade_name": "str",
              "roadway_surface_type": "str",
              "roadway_surface_type_name": "str",
              "roadway_surface_condition": "str",
              "roadway_surface_condition_name": "str",
              "traffic_control_device": "str",
              "traffic_control_device_name": "str",
              "traffic_control_device_functioning": "str",
              "traffic_control_device_functioning_name": "str",
              "pre_event_movement_prior_to_recognition_of_critical_event": "str",
              "pre_event_movement_prior_to_recognition_of_critical_event_name": "str",
              "critical_event_precrash": "str",
              "critical_event_precrash_name": "str",
              "attempted_avoidance_maneuver": "str",
              "attempted_avoidance_maneuver_name": "str",
              "pre_impact_stability": "str",
              "pre_impact_stability_name": "str",
              "pre_impact_location": "str",
              "pre_impact_location_name": "str",
              "crash_type": "str",
              "crash_type_name": "str",
              "fatalities_in_vehicle": "str",
              "driver_drinking": "str",
              "driver_drinking_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "NUMOCCS": "number_of_occupants",
              "NUMOCCSNAME": "number_of_occupants_name",
              "DAY": "day_of_crash",
              "DAYNAME": "day_of_crash_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "UNITTYPE": "unit_type",
              "UNITTYPENAME": "unit_type_name",
              "HIT_RUN": "hit_and_run",
              "HIT_RUNNAME": "hit_and_run_name",
              "REG_STAT": "registration_state",
              "REG_STATNAME": "registration_state_name",
              "OWNER": "registered_vehicle_owner",
              "OWNERNAME": "registered_vehicle_owner_name",
              "MAKE": "vehicle_make",
              "MAKENAME": "vehicle_make_name",
              "MODEL": "vehicle_model",
              "MAK_MOD": "make_model_combined",
              "MAK_MODNAME": "make_model_combined_name",
              "BODY_TYP": "body_type",
              "BODY_TYPNAME": "body_type_name",
              "MOD_YEAR": "vehicle_model_year",
              "MOD_YEARNAME": "vehicle_model_year_name",
              "VIN": "vehicle_identification_number_vin",
              "VINNAME": "vehicle_identification_number_vin_name",
              "VIN_1": "vin_character_1",
              "VIN_2": "vin_character_2",
              "VIN_3": "vin_character_3",
              "VIN_4": "vin_character_4",
              "VIN_5": "vin_character_5",
              "VIN_6": "vin_character_6",
              "VIN_7": "vin_character_7",
              "VIN_8": "vin_character_8",
              "VIN_9": "vin_character_9",
              "VIN_10": "vin_character_10",
              "VIN_11": "vin_character_11",
              "VIN_12": "vin_character_12",
              "TOW_VEH": "vehicle_trailing",
              "TOW_VEHNAME": "vehicle_trailing_name",
              "J_KNIFE": "jackknife",
              "J_KNIFENAME": "jackknife_name",
              "MCARR_I1": "mcid_issuing_authority",
              "MCARR_I1NAME": "mcid_issuing_authority_name",
              "MCARR_I2": "mcid_identification_number",
              "MCARR_I2NAME": "mcid_identification_number_name",
              "MCARR_ID": "motor_carrier_identification_number_mcid",
              "MCARR_IDNAME": "motor_carrier_identification_number_mcid_name",
              "GVWR": "gross_vehicle_weight_rating",
              "GVWRNAME": "gross_vehicle_weight_rating_name",
              "V_CONFIG": "vehicle_configuration",
              "V_CONFIGNAME": "vehicle_configuration_name",
              "CARGO_BT": "cargo_body_type",
              "CARGO_BTNAME": "cargo_body_type_name",
              "HAZ_INV": "hazardous_material_involvement",
              "HAZ_INVNAME": "hazardous_material_involvement_name",
              "HAZ_PLAC": "hazardous_material_placard",
              "HAZ_PLACNAME": "hazardous_material_placard_name",
              "HAZ_ID": "hazardous_material_identification_number",
              "HAZ_IDNAME": "hazardous_material_identification_number_name",
              "HAZ_CNO": "hazardous_material_class_number",
              "HAZ_CNONAME": "hazardous_material_class_number_name",
              "HAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "HAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "BUS_USE": "bus_use",
              "BUS_USENAME": "bus_use_name",
              "SPEC_USE": "special_use",
              "SPEC_USENAME": "special_use_name",
              "EMER_USE": "emergency_motor_vehicle_use",
              "EMER_USENAME": "emergency_motor_vehicle_use_name",
              "TRAV_SP": "travel_speed",
              "TRAV_SPNAME": "travel_speed_name",
              "UNDERIDE": "underride_override",
              "UNDERIDENAME": "underride_override_name",
              "ROLLOVER": "rollover",
              "ROLLOVERNAME": "rollover_name",
              "ROLINLOC": "location_of_rollover",
              "ROLINLOCNAME": "location_of_rollover_name",
              "IMPACT1": "initial_contact_point",
              "IMPACT1NAME": "initial_contact_point_name",
              "DEFORMED": "extent_of_damage",
              "DEFORMEDNAME": "extent_of_damage_name",
              "TOWED": "vehicle_removal",
              "TOWEDNAME": "vehicle_removal_name",
              "M_HARM": "most_harmful_event",
              "M_HARMNAME": "most_harmful_event_name",
              "VEH_SC1": "related_factors_vehicle_level_1",
              "VEH_SC1NAME": "related_factors_vehicle_level_1_name",
              "VEH_SC2": "related_factors_vehicle_level_2",
              "VEH_SC2NAME": "related_factors_vehicle_level_2_name",
              "FIRE_EXP": "fire_occurrence",
              "FIRE_EXPNAME": "fire_occurrence_name",
              "DR_PRES": "driver_presence",
              "DR_PRESNAME": "driver_presence_name",
              "L_STATE": "drivers_license_state",
              "L_STATENAME": "drivers_license_state_name",
              "DR_ZIP": "drivers_zip_code",
              "DR_ZIPNAME": "drivers_zip_code_name",
              "L_STATUS": "non_cdl_license_status",
              "L_STATUSNAME": "non_cdl_license_status_name",
              "L_TYPE": "non_cdl_license_type",
              "L_TYPENAME": "non_cdl_license_type_name",
              "CDL_STAT": "commercial_motor_vehicle_license_status",
              "CDL_STATNAME": "commercial_motor_vehicle_license_status_name",
              "L_ENDORS": "compliance_with_cdl_endorsements",
              "L_ENDORSNAME": "compliance_with_cdl_endorsements_name",
              "L_COMPL": "license_compliance_with_class_of_vehicle",
              "L_COMPLNAME": "license_compliance_with_class_of_vehicle_name",
              "L_RESTRI": "compliance_with_license_restrictions",
              "L_RESTRINAME": "compliance_with_license_restrictions_name",
              "DR_HGT": "driver_height",
              "DR_HGTNAME": "driver_height_name",
              "DR_WGT": "driver_weight",
              "DR_WGTNAME": "driver_weight_name",
              "PREV_ACC": "previous_recorded_crashes",
              "PREV_ACCNAME": "previous_recorded_crashes_name",
              "PREV_SUS": "previous_recorded_suspensions_and_revocations",
              "PREV_SUSNAME": "previous_recorded_suspensions_and_revocations_name",
              "PREV_DWI": "previous_dwi_convictions",
              "PREV_DWINAME": "previous_dwi_convictions_name",
              "PREV_SPD": "previous_speeding_convictions",
              "PREV_SPDNAME": "previous_speeding_convictions_name",
              "PREV_OTH": "previous_other_moving_violation_convictions",
              "PREV_OTHNAME": "previous_other_moving_violation_convictions_name",
              "FIRST_MO": "month_of_first_crash_suspension_or_conviction",
              "FIRST_MONAME": "month_of_first_crash_suspension_or_conviction_name",
              "FIRST_YR": "year_of_first_crash_suspension_or_conviction",
              "FIRST_YRNAME": "year_of_first_crash_suspension_or_conviction_name",
              "LAST_MO": "month_of_last_crash_suspension_or_conviction",
              "LAST_MONAME": "month_of_last_crash_suspension_or_conviction_name",
              "LAST_YR": "year_of_last_crash_suspension_or_conviction",
              "LAST_YRNAME": "year_of_last_crash_suspension_or_conviction_name",
              "SPEEDREL": "speeding_related",
              "SPEEDRELNAME": "speeding_related_name",
              "DR_SF1": "related_factors_driver_level_1",
              "DR_SF1NAME": "related_factors_driver_level_1_name",
              "DR_SF2": "related_factors_driver_level_2",
              "DR_SF2NAME": "related_factors_driver_level_2_name",
              "DR_SF3": "related_factors_driver_level_3",
              "DR_SF3NAME": "related_factors_driver_level_3_name",
              "DR_SF4": "related_factors_driver_level_4",
              "DR_SF4NAME": "related_factors_driver_level_4_name",
              "VTRAFWAY": "trafficway_description",
              "VTRAFWAYNAME": "trafficway_description_name",
              "VNUM_LAN": "total_lanes_in_roadway",
              "VNUM_LANNAME": "total_lanes_in_roadway_name",
              "VSPD_LIM": "speed_limit",
              "VSPD_LIMNAME": "speed_limit_name",
              "VALIGN": "roadway_alignment",
              "VALIGNNAME": "roadway_alignment_name",
              "VPROFILE": "roadway_grade",
              "VPROFILENAME": "roadway_grade_name",
              "VPAVETYP": "roadway_surface_type",
              "VPAVETYPNAME": "roadway_surface_type_name",
              "VSURCOND": "roadway_surface_condition",
              "VSURCONDNAME": "roadway_surface_condition_name",
              "VTRAFCON": "traffic_control_device",
              "VTRAFCONNAME": "traffic_control_device_name",
              "VTCONT_F": "traffic_control_device_functioning",
              "VTCONT_FNAME": "traffic_control_device_functioning_name",
              "P_CRASH1": "pre_event_movement_prior_to_recognition_of_critical_event",
              "P_CRASH1NAME": "pre_event_movement_prior_to_recognition_of_critical_event_name",
              "P_CRASH2": "critical_event_precrash",
              "P_CRASH2NAME": "critical_event_precrash_name",
              "P_CRASH3": "attempted_avoidance_maneuver",
              "P_CRASH3NAME": "attempted_avoidance_maneuver_name",
              "PCRASH4": "pre_impact_stability",
              "PCRASH4NAME": "pre_impact_stability_name",
              "PCRASH5": "pre_impact_location",
              "PCRASH5NAME": "pre_impact_location_name",
              "ACC_TYPE": "crash_type",
              "ACC_TYPENAME": "crash_type_name",
              "DEATHS": "fatalities_in_vehicle",
              "DR_DRINK": "driver_drinking",
              "DR_DRINKNAME": "driver_drinking_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for vehicle pipelines"
      args:
        task_id: "vehicle_2016_2017_transform_csv"
        startup_timeout_seconds: 600
        name: "vehicle"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2016_2017.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2016_2017.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2016_2017.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "vehicle.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2016_2017.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2016_2017.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2016_2017.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2016_2017.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2016_2017.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2016_2017.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2016_2017.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2016_2017.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "make_model_combined_name",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "jackknife",
              "jackknife_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number_mcid",
              "motor_carrier_identification_number_mcid_name",
              "gross_vehicle_weight_rating",
              "gross_vehicle_weight_rating_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "travel_speed",
              "travel_speed_name",
              "underride_override",
              "underride_override_name",
              "rollover",
              "rollover_name",
              "location_of_rollover",
              "location_of_rollover_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "related_factors_vehicle_level_1",
              "related_factors_vehicle_level_1_name",
              "related_factors_vehicle_level_2",
              "related_factors_vehicle_level_2_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "driver_presence",
              "driver_presence_name",
              "drivers_license_state",
              "drivers_license_state_name",
              "drivers_zip_code",
              "drivers_zip_code_name",
              "non_cdl_license_status",
              "non_cdl_license_status_name",
              "non_cdl_license_type",
              "non_cdl_license_type_name",
              "commercial_motor_vehicle_license_status",
              "commercial_motor_vehicle_license_status_name",
              "compliance_with_cdl_endorsements",
              "compliance_with_cdl_endorsements_name",
              "license_compliance_with_class_of_vehicle",
              "license_compliance_with_class_of_vehicle_name",
              "compliance_with_license_restrictions",
              "compliance_with_license_restrictions_name",
              "driver_height",
              "driver_height_name",
              "driver_weight",
              "driver_weight_name",
              "previous_recorded_crashes",
              "previous_recorded_crashes_name",
              "previous_recorded_suspensions_and_revocations",
              "previous_recorded_suspensions_and_revocations_name",
              "previous_dwi_convictions",
              "previous_dwi_convictions_name",
              "previous_speeding_convictions",
              "previous_speeding_convictions_name",
              "previous_other_moving_violation_convictions",
              "previous_other_moving_violation_convictions_name",
              "month_of_first_crash_suspension_or_conviction",
              "month_of_first_crash_suspension_or_conviction_name",
              "year_of_first_crash_suspension_or_conviction",
              "year_of_first_crash_suspension_or_conviction_name",
              "month_of_last_crash_suspension_or_conviction",
              "month_of_last_crash_suspension_or_conviction_name",
              "year_of_last_crash_suspension_or_conviction",
              "year_of_last_crash_suspension_or_conviction_name",
              "speeding_related",
              "speeding_related_name",
              "related_factors_driver_level_1",
              "related_factors_driver_level_1_name",
              "related_factors_driver_level_2",
              "related_factors_driver_level_2_name",
              "related_factors_driver_level_3",
              "related_factors_driver_level_3_name",
              "related_factors_driver_level_4",
              "related_factors_driver_level_4_name",
              "trafficway_description",
              "trafficway_description_name",
              "total_lanes_in_roadway",
              "total_lanes_in_roadway_name",
              "speed_limit",
              "speed_limit_name",
              "roadway_alignment",
              "roadway_alignment_name",
              "roadway_grade",
              "roadway_grade_name",
              "roadway_surface_type",
              "roadway_surface_type_name",
              "roadway_surface_condition",
              "roadway_surface_condition_name",
              "traffic_control_device",
              "traffic_control_device_name",
              "traffic_control_device_functioning",
              "traffic_control_device_functioning_name",
              "pre_event_movement_prior_to_recognition_of_critical_event",
              "pre_event_movement_prior_to_recognition_of_critical_event_name",
              "critical_event_precrash",
              "critical_event_precrash_name",
              "attempted_avoidance_maneuver",
              "attempted_avoidance_maneuver_name",
              "pre_impact_stability",
              "pre_impact_stability_name",
              "pre_impact_location",
              "pre_impact_location_name",
              "crash_type",
              "crash_type_name",
              "fatalities_in_vehicle",
              "driver_drinking",
              "driver_drinking_name",
              "trailer_vehicle_identification_number_1",
              "trailer_vehicle_identification_number_1_name",
              "trailer_vehicle_identification_number_2",
              "trailer_vehicle_identification_number_2_name",
              "trailer_vehicle_identification_number_3",
              "trailer_vehicle_identification_number_3_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "make_model_combined_name": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "jackknife": "str",
              "jackknife_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number_mcid": "str",
              "motor_carrier_identification_number_mcid_name": "str",
              "gross_vehicle_weight_rating": "str",
              "gross_vehicle_weight_rating_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "travel_speed": "str",
              "travel_speed_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "rollover": "str",
              "rollover_name": "str",
              "location_of_rollover": "str",
              "location_of_rollover_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "related_factors_vehicle_level_1": "str",
              "related_factors_vehicle_level_1_name": "str",
              "related_factors_vehicle_level_2": "str",
              "related_factors_vehicle_level_2_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "driver_presence": "str",
              "driver_presence_name": "str",
              "drivers_license_state": "str",
              "drivers_license_state_name": "str",
              "drivers_zip_code": "str",
              "drivers_zip_code_name": "str",
              "non_cdl_license_status": "str",
              "non_cdl_license_status_name": "str",
              "non_cdl_license_type": "str",
              "non_cdl_license_type_name": "str",
              "commercial_motor_vehicle_license_status": "str",
              "commercial_motor_vehicle_license_status_name": "str",
              "compliance_with_cdl_endorsements": "str",
              "compliance_with_cdl_endorsements_name": "str",
              "license_compliance_with_class_of_vehicle": "str",
              "license_compliance_with_class_of_vehicle_name": "str",
              "compliance_with_license_restrictions": "str",
              "compliance_with_license_restrictions_name": "str",
              "driver_height": "str",
              "driver_height_name": "str",
              "driver_weight": "str",
              "driver_weight_name": "str",
              "previous_recorded_crashes": "str",
              "previous_recorded_crashes_name": "str",
              "previous_recorded_suspensions_and_revocations": "str",
              "previous_recorded_suspensions_and_revocations_name": "str",
              "previous_dwi_convictions": "str",
              "previous_dwi_convictions_name": "str",
              "previous_speeding_convictions": "str",
              "previous_speeding_convictions_name": "str",
              "previous_other_moving_violation_convictions": "str",
              "previous_other_moving_violation_convictions_name": "str",
              "month_of_first_crash_suspension_or_conviction": "str",
              "month_of_first_crash_suspension_or_conviction_name": "str",
              "year_of_first_crash_suspension_or_conviction": "str",
              "year_of_first_crash_suspension_or_conviction_name": "str",
              "month_of_last_crash_suspension_or_conviction": "str",
              "month_of_last_crash_suspension_or_conviction_name": "str",
              "year_of_last_crash_suspension_or_conviction": "str",
              "year_of_last_crash_suspension_or_conviction_name": "str",
              "speeding_related": "str",
              "speeding_related_name": "str",
              "related_factors_driver_level_1": "str",
              "related_factors_driver_level_1_name": "str",
              "related_factors_driver_level_2": "str",
              "related_factors_driver_level_2_name": "str",
              "related_factors_driver_level_3": "str",
              "related_factors_driver_level_3_name": "str",
              "related_factors_driver_level_4": "str",
              "related_factors_driver_level_4_name": "str",
              "trafficway_description": "str",
              "trafficway_description_name": "str",
              "total_lanes_in_roadway": "str",
              "total_lanes_in_roadway_name": "str",
              "speed_limit": "str",
              "speed_limit_name": "str",
              "roadway_alignment": "str",
              "roadway_alignment_name": "str",
              "roadway_grade": "str",
              "roadway_grade_name": "str",
              "roadway_surface_type": "str",
              "roadway_surface_type_name": "str",
              "roadway_surface_condition": "str",
              "roadway_surface_condition_name": "str",
              "traffic_control_device": "str",
              "traffic_control_device_name": "str",
              "traffic_control_device_functioning": "str",
              "traffic_control_device_functioning_name": "str",
              "pre_event_movement_prior_to_recognition_of_critical_event": "str",
              "pre_event_movement_prior_to_recognition_of_critical_event_name": "str",
              "critical_event_precrash": "str",
              "critical_event_precrash_name": "str",
              "attempted_avoidance_maneuver": "str",
              "attempted_avoidance_maneuver_name": "str",
              "pre_impact_stability": "str",
              "pre_impact_stability_name": "str",
              "pre_impact_location": "str",
              "pre_impact_location_name": "str",
              "crash_type": "str",
              "crash_type_name": "str",
              "fatalities_in_vehicle": "str",
              "driver_drinking": "str",
              "driver_drinking_name": "str",
              "trailer_vehicle_identification_number_1": "str",
              "trailer_vehicle_identification_number_1_name": "str",
              "trailer_vehicle_identification_number_2": "str",
              "trailer_vehicle_identification_number_2_name": "str",
              "trailer_vehicle_identification_number_3": "str",
              "trailer_vehicle_identification_number_3_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "NUMOCCS": "number_of_occupants",
              "NUMOCCSNAME": "number_of_occupants_name",
              "DAY": "day_of_crash",
              "DAYNAME": "day_of_crash_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "UNITTYPE": "unit_type",
              "UNITTYPENAME": "unit_type_name",
              "HIT_RUN": "hit_and_run",
              "HIT_RUNNAME": "hit_and_run_name",
              "REG_STAT": "registration_state",
              "REG_STATNAME": "registration_state_name",
              "OWNER": "registered_vehicle_owner",
              "OWNERNAME": "registered_vehicle_owner_name",
              "MAKE": "vehicle_make",
              "MAKENAME": "vehicle_make_name",
              "MODEL": "vehicle_model",
              "MAK_MOD": "make_model_combined",
              "MAK_MODNAME": "make_model_combined_name",
              "BODY_TYP": "body_type",
              "BODY_TYPNAME": "body_type_name",
              "MOD_YEAR": "vehicle_model_year",
              "MOD_YEARNAME": "vehicle_model_year_name",
              "VIN": "vehicle_identification_number_vin",
              "VINNAME": "vehicle_identification_number_vin_name",
              "VIN_1": "vin_character_1",
              "VIN_2": "vin_character_2",
              "VIN_3": "vin_character_3",
              "VIN_4": "vin_character_4",
              "VIN_5": "vin_character_5",
              "VIN_6": "vin_character_6",
              "VIN_7": "vin_character_7",
              "VIN_8": "vin_character_8",
              "VIN_9": "vin_character_9",
              "VIN_10": "vin_character_10",
              "VIN_11": "vin_character_11",
              "VIN_12": "vin_character_12",
              "TOW_VEH": "vehicle_trailing",
              "TOW_VEHNAME": "vehicle_trailing_name",
              "J_KNIFE": "jackknife",
              "J_KNIFENAME": "jackknife_name",
              "MCARR_I1": "mcid_issuing_authority",
              "MCARR_I1NAME": "mcid_issuing_authority_name",
              "MCARR_I2": "mcid_identification_number",
              "MCARR_I2NAME": "mcid_identification_number_name",
              "MCARR_ID": "motor_carrier_identification_number_mcid",
              "MCARR_IDNAME": "motor_carrier_identification_number_mcid_name",
              "GVWR": "gross_vehicle_weight_rating",
              "GVWRNAME": "gross_vehicle_weight_rating_name",
              "V_CONFIG": "vehicle_configuration",
              "V_CONFIGNAME": "vehicle_configuration_name",
              "CARGO_BT": "cargo_body_type",
              "CARGO_BTNAME": "cargo_body_type_name",
              "HAZ_INV": "hazardous_material_involvement",
              "HAZ_INVNAME": "hazardous_material_involvement_name",
              "HAZ_PLAC": "hazardous_material_placard",
              "HAZ_PLACNAME": "hazardous_material_placard_name",
              "HAZ_ID": "hazardous_material_identification_number",
              "HAZ_IDNAME": "hazardous_material_identification_number_name",
              "HAZ_CNO": "hazardous_material_class_number",
              "HAZ_CNONAME": "hazardous_material_class_number_name",
              "HAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "HAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "BUS_USE": "bus_use",
              "BUS_USENAME": "bus_use_name",
              "SPEC_USE": "special_use",
              "SPEC_USENAME": "special_use_name",
              "EMER_USE": "emergency_motor_vehicle_use",
              "EMER_USENAME": "emergency_motor_vehicle_use_name",
              "TRAV_SP": "travel_speed",
              "TRAV_SPNAME": "travel_speed_name",
              "UNDERIDE": "underride_override",
              "UNDERIDENAME": "underride_override_name",
              "ROLLOVER": "rollover",
              "ROLLOVERNAME": "rollover_name",
              "ROLINLOC": "location_of_rollover",
              "ROLINLOCNAME": "location_of_rollover_name",
              "IMPACT1": "initial_contact_point",
              "IMPACT1NAME": "initial_contact_point_name",
              "DEFORMED": "extent_of_damage",
              "DEFORMEDNAME": "extent_of_damage_name",
              "TOWED": "vehicle_removal",
              "TOWEDNAME": "vehicle_removal_name",
              "M_HARM": "most_harmful_event",
              "M_HARMNAME": "most_harmful_event_name",
              "VEH_SC1": "related_factors_vehicle_level_1",
              "VEH_SC1NAME": "related_factors_vehicle_level_1_name",
              "VEH_SC2": "related_factors_vehicle_level_2",
              "VEH_SC2NAME": "related_factors_vehicle_level_2_name",
              "FIRE_EXP": "fire_occurrence",
              "FIRE_EXPNAME": "fire_occurrence_name",
              "DR_PRES": "driver_presence",
              "DR_PRESNAME": "driver_presence_name",
              "L_STATE": "drivers_license_state",
              "L_STATENAME": "drivers_license_state_name",
              "DR_ZIP": "drivers_zip_code",
              "DR_ZIPNAME": "drivers_zip_code_name",
              "L_STATUS": "non_cdl_license_status",
              "L_STATUSNAME": "non_cdl_license_status_name",
              "L_TYPE": "non_cdl_license_type",
              "L_TYPENAME": "non_cdl_license_type_name",
              "CDL_STAT": "commercial_motor_vehicle_license_status",
              "CDL_STATNAME": "commercial_motor_vehicle_license_status_name",
              "L_ENDORS": "compliance_with_cdl_endorsements",
              "L_ENDORSNAME": "compliance_with_cdl_endorsements_name",
              "L_COMPL": "license_compliance_with_class_of_vehicle",
              "L_COMPLNAME": "license_compliance_with_class_of_vehicle_name",
              "L_RESTRI": "compliance_with_license_restrictions",
              "L_RESTRINAME": "compliance_with_license_restrictions_name",
              "DR_HGT": "driver_height",
              "DR_HGTNAME": "driver_height_name",
              "DR_WGT": "driver_weight",
              "DR_WGTNAME": "driver_weight_name",
              "PREV_ACC": "previous_recorded_crashes",
              "PREV_ACCNAME": "previous_recorded_crashes_name",
              "PREV_SUS": "previous_recorded_suspensions_and_revocations",
              "PREV_SUSNAME": "previous_recorded_suspensions_and_revocations_name",
              "PREV_DWI": "previous_dwi_convictions",
              "PREV_DWINAME": "previous_dwi_convictions_name",
              "PREV_SPD": "previous_speeding_convictions",
              "PREV_SPDNAME": "previous_speeding_convictions_name",
              "PREV_OTH": "previous_other_moving_violation_convictions",
              "PREV_OTHNAME": "previous_other_moving_violation_convictions_name",
              "FIRST_MO": "month_of_first_crash_suspension_or_conviction",
              "FIRST_MONAME": "month_of_first_crash_suspension_or_conviction_name",
              "FIRST_YR": "year_of_first_crash_suspension_or_conviction",
              "FIRST_YRNAME": "year_of_first_crash_suspension_or_conviction_name",
              "LAST_MO": "month_of_last_crash_suspension_or_conviction",
              "LAST_MONAME": "month_of_last_crash_suspension_or_conviction_name",
              "LAST_YR": "year_of_last_crash_suspension_or_conviction",
              "LAST_YRNAME": "year_of_last_crash_suspension_or_conviction_name",
              "SPEEDREL": "speeding_related",
              "SPEEDRELNAME": "speeding_related_name",
              "DR_SF1": "related_factors_driver_level_1",
              "DR_SF1NAME": "related_factors_driver_level_1_name",
              "DR_SF2": "related_factors_driver_level_2",
              "DR_SF2NAME": "related_factors_driver_level_2_name",
              "DR_SF3": "related_factors_driver_level_3",
              "DR_SF3NAME": "related_factors_driver_level_3_name",
              "DR_SF4": "related_factors_driver_level_4",
              "DR_SF4NAME": "related_factors_driver_level_4_name",
              "VTRAFWAY": "trafficway_description",
              "VTRAFWAYNAME": "trafficway_description_name",
              "VNUM_LAN": "total_lanes_in_roadway",
              "VNUM_LANNAME": "total_lanes_in_roadway_name",
              "VSPD_LIM": "speed_limit",
              "VSPD_LIMNAME": "speed_limit_name",
              "VALIGN": "roadway_alignment",
              "VALIGNNAME": "roadway_alignment_name",
              "VPROFILE": "roadway_grade",
              "VPROFILENAME": "roadway_grade_name",
              "VPAVETYP": "roadway_surface_type",
              "VPAVETYPNAME": "roadway_surface_type_name",
              "VSURCOND": "roadway_surface_condition",
              "VSURCONDNAME": "roadway_surface_condition_name",
              "VTRAFCON": "traffic_control_device",
              "VTRAFCONNAME": "traffic_control_device_name",
              "VTCONT_F": "traffic_control_device_functioning",
              "VTCONT_FNAME": "traffic_control_device_functioning_name",
              "P_CRASH1": "pre_event_movement_prior_to_recognition_of_critical_event",
              "P_CRASH1NAME": "pre_event_movement_prior_to_recognition_of_critical_event_name",
              "P_CRASH2": "critical_event_precrash",
              "P_CRASH2NAME": "critical_event_precrash_name",
              "P_CRASH3": "attempted_avoidance_maneuver",
              "P_CRASH3NAME": "attempted_avoidance_maneuver_name",
              "PCRASH4": "pre_impact_stability",
              "PCRASH4NAME": "pre_impact_stability_name",
              "PCRASH5": "pre_impact_location",
              "PCRASH5NAME": "pre_impact_location_name",
              "ACC_TYPE": "crash_type",
              "ACC_TYPENAME": "crash_type_name",
              "DEATHS": "fatalities_in_vehicle",
              "DR_DRINK": "driver_drinking",
              "DR_DRINKNAME": "driver_drinking_name",
              "TRLR1VIN": "trailer_vehicle_identification_number_1",
              "TRLR1VINNAME": "trailer_vehicle_identification_number_1_name",
              "TRLR2VIN": "trailer_vehicle_identification_number_2",
              "TRLR2VINNAME": "trailer_vehicle_identification_number_2_name",
              "TRLR3VIN": "trailer_vehicle_identification_number_3",
              "TRLR3VINNAME": "trailer_vehicle_identification_number_3_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for vehicle pipelines"
      args:
        task_id: "vehicle_2018_2019_transform_csv"
        startup_timeout_seconds: 600
        name: "vehicle"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2018_2019.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2018_2019.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2018_2019.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "vehicle.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2018_2019.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2018_2019.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2018_2019.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2018_2019.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2018_2019.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2018_2019.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2018_2019.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2018_2019.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "make_model_combined_name",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "jackknife",
              "jackknife_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number_mcid",
              "motor_carrier_identification_number_mcid_name",
              "gross_vehicle_weight_rating",
              "gross_vehicle_weight_rating_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "travel_speed",
              "travel_speed_name",
              "underride_override",
              "underride_override_name",
              "rollover",
              "rollover_name",
              "location_of_rollover",
              "location_of_rollover_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "related_factors_vehicle_level_1",
              "related_factors_vehicle_level_1_name",
              "related_factors_vehicle_level_2",
              "related_factors_vehicle_level_2_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "driver_presence",
              "driver_presence_name",
              "drivers_license_state",
              "drivers_license_state_name",
              "drivers_zip_code",
              "drivers_zip_code_name",
              "non_cdl_license_status",
              "non_cdl_license_status_name",
              "non_cdl_license_type",
              "non_cdl_license_type_name",
              "commercial_motor_vehicle_license_status",
              "commercial_motor_vehicle_license_status_name",
              "compliance_with_cdl_endorsements",
              "compliance_with_cdl_endorsements_name",
              "license_compliance_with_class_of_vehicle",
              "license_compliance_with_class_of_vehicle_name",
              "compliance_with_license_restrictions",
              "compliance_with_license_restrictions_name",
              "driver_height",
              "driver_height_name",
              "driver_weight",
              "driver_weight_name",
              "previous_recorded_crashes",
              "previous_recorded_crashes_name",
              "previous_recorded_suspensions_and_revocations1",
              "previous_recorded_suspensions_and_revocations1_name",
              "previous_recorded_suspensions_and_revocations2",
              "previous_recorded_suspensions_and_revocations2_name",
              "previous_recorded_suspensions_and_revocations3",
              "previous_recorded_suspensions_and_revocations3_name",
              "previous_dwi_convictions",
              "previous_dwi_convictions_name",
              "previous_speeding_convictions",
              "previous_speeding_convictions_name",
              "previous_other_moving_violation_convictions",
              "previous_other_moving_violation_convictions_name",
              "month_of_first_crash_suspension_or_conviction",
              "month_of_first_crash_suspension_or_conviction_name",
              "year_of_first_crash_suspension_or_conviction",
              "year_of_first_crash_suspension_or_conviction_name",
              "month_of_last_crash_suspension_or_conviction",
              "month_of_last_crash_suspension_or_conviction_name",
              "year_of_last_crash_suspension_or_conviction",
              "year_of_last_crash_suspension_or_conviction_name",
              "speeding_related",
              "speeding_related_name",
              "related_factors_driver_level_1",
              "related_factors_driver_level_1_name",
              "related_factors_driver_level_2",
              "related_factors_driver_level_2_name",
              "related_factors_driver_level_3",
              "related_factors_driver_level_3_name",
              "related_factors_driver_level_4",
              "related_factors_driver_level_4_name",
              "trafficway_description",
              "trafficway_description_name",
              "total_lanes_in_roadway",
              "total_lanes_in_roadway_name",
              "speed_limit",
              "speed_limit_name",
              "roadway_alignment",
              "roadway_alignment_name",
              "roadway_grade",
              "roadway_grade_name",
              "roadway_surface_type",
              "roadway_surface_type_name",
              "roadway_surface_condition",
              "roadway_surface_condition_name",
              "traffic_control_device",
              "traffic_control_device_name",
              "traffic_control_device_functioning",
              "traffic_control_device_functioning_name",
              "pre_event_movement_prior_to_recognition_of_critical_event",
              "pre_event_movement_prior_to_recognition_of_critical_event_name",
              "critical_event_precrash",
              "critical_event_precrash_name",
              "attempted_avoidance_maneuver",
              "attempted_avoidance_maneuver_name",
              "pre_impact_stability",
              "pre_impact_stability_name",
              "pre_impact_location",
              "pre_impact_location_name",
              "crash_type",
              "crash_type_name",
              "fatalities_in_vehicle",
              "driver_drinking",
              "driver_drinking_name",
              "trailer_vehicle_identification_number_1",
              "trailer_vehicle_identification_number_1_name",
              "trailer_vehicle_identification_number_2",
              "trailer_vehicle_identification_number_2_name",
              "trailer_vehicle_identification_number_3",
              "trailer_vehicle_identification_number_3_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "make_model_combined_name": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "jackknife": "str",
              "jackknife_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number_mcid": "str",
              "motor_carrier_identification_number_mcid_name": "str",
              "gross_vehicle_weight_rating": "str",
              "gross_vehicle_weight_rating_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "travel_speed": "str",
              "travel_speed_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "rollover": "str",
              "rollover_name": "str",
              "location_of_rollover": "str",
              "location_of_rollover_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "related_factors_vehicle_level_1": "str",
              "related_factors_vehicle_level_1_name": "str",
              "related_factors_vehicle_level_2": "str",
              "related_factors_vehicle_level_2_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "driver_presence": "str",
              "driver_presence_name": "str",
              "drivers_license_state": "str",
              "drivers_license_state_name": "str",
              "drivers_zip_code": "str",
              "drivers_zip_code_name": "str",
              "non_cdl_license_status": "str",
              "non_cdl_license_status_name": "str",
              "non_cdl_license_type": "str",
              "non_cdl_license_type_name": "str",
              "commercial_motor_vehicle_license_status": "str",
              "commercial_motor_vehicle_license_status_name": "str",
              "compliance_with_cdl_endorsements": "str",
              "compliance_with_cdl_endorsements_name": "str",
              "license_compliance_with_class_of_vehicle": "str",
              "license_compliance_with_class_of_vehicle_name": "str",
              "compliance_with_license_restrictions": "str",
              "compliance_with_license_restrictions_name": "str",
              "driver_height": "str",
              "driver_height_name": "str",
              "driver_weight": "str",
              "driver_weight_name": "str",
              "previous_recorded_crashes": "str",
              "previous_recorded_crashes_name": "str",
              "previous_recorded_suspensions_and_revocations1": "str",
              "previous_recorded_suspensions_and_revocations1_name": "str",
              "previous_recorded_suspensions_and_revocations2": "str",
              "previous_recorded_suspensions_and_revocations2_name": "str",
              "previous_recorded_suspensions_and_revocations3": "str",
              "previous_recorded_suspensions_and_revocations3_name": "str",
              "previous_dwi_convictions": "str",
              "previous_dwi_convictions_name": "str",
              "previous_speeding_convictions": "str",
              "previous_speeding_convictions_name": "str",
              "previous_other_moving_violation_convictions": "str",
              "previous_other_moving_violation_convictions_name": "str",
              "month_of_first_crash_suspension_or_conviction": "str",
              "month_of_first_crash_suspension_or_conviction_name": "str",
              "year_of_first_crash_suspension_or_conviction": "str",
              "year_of_first_crash_suspension_or_conviction_name": "str",
              "month_of_last_crash_suspension_or_conviction": "str",
              "month_of_last_crash_suspension_or_conviction_name": "str",
              "year_of_last_crash_suspension_or_conviction": "str",
              "year_of_last_crash_suspension_or_conviction_name": "str",
              "speeding_related": "str",
              "speeding_related_name": "str",
              "related_factors_driver_level_1": "str",
              "related_factors_driver_level_1_name": "str",
              "related_factors_driver_level_2": "str",
              "related_factors_driver_level_2_name": "str",
              "related_factors_driver_level_3": "str",
              "related_factors_driver_level_3_name": "str",
              "related_factors_driver_level_4": "str",
              "related_factors_driver_level_4_name": "str",
              "trafficway_description": "str",
              "trafficway_description_name": "str",
              "total_lanes_in_roadway": "str",
              "total_lanes_in_roadway_name": "str",
              "speed_limit": "str",
              "speed_limit_name": "str",
              "roadway_alignment": "str",
              "roadway_alignment_name": "str",
              "roadway_grade": "str",
              "roadway_grade_name": "str",
              "roadway_surface_type": "str",
              "roadway_surface_type_name": "str",
              "roadway_surface_condition": "str",
              "roadway_surface_condition_name": "str",
              "traffic_control_device": "str",
              "traffic_control_device_name": "str",
              "traffic_control_device_functioning": "str",
              "traffic_control_device_functioning_name": "str",
              "pre_event_movement_prior_to_recognition_of_critical_event": "str",
              "pre_event_movement_prior_to_recognition_of_critical_event_name": "str",
              "critical_event_precrash": "str",
              "critical_event_precrash_name": "str",
              "attempted_avoidance_maneuver": "str",
              "attempted_avoidance_maneuver_name": "str",
              "pre_impact_stability": "str",
              "pre_impact_stability_name": "str",
              "pre_impact_location": "str",
              "pre_impact_location_name": "str",
              "crash_type": "str",
              "crash_type_name": "str",
              "fatalities_in_vehicle": "str",
              "driver_drinking": "str",
              "driver_drinking_name": "str",
              "trailer_vehicle_identification_number_1": "str",
              "trailer_vehicle_identification_number_1_name": "str",
              "trailer_vehicle_identification_number_2": "str",
              "trailer_vehicle_identification_number_2_name": "str",
              "trailer_vehicle_identification_number_3": "str",
              "trailer_vehicle_identification_number_3_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "NUMOCCS": "number_of_occupants",
              "NUMOCCSNAME": "number_of_occupants_name",
              "DAY": "day_of_crash",
              "DAYNAME": "day_of_crash_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "UNITTYPE": "unit_type",
              "UNITTYPENAME": "unit_type_name",
              "HIT_RUN": "hit_and_run",
              "HIT_RUNNAME": "hit_and_run_name",
              "REG_STAT": "registration_state",
              "REG_STATNAME": "registration_state_name",
              "OWNER": "registered_vehicle_owner",
              "OWNERNAME": "registered_vehicle_owner_name",
              "MAKE": "vehicle_make",
              "MAKENAME": "vehicle_make_name",
              "MODEL": "vehicle_model",
              "MAK_MOD": "make_model_combined",
              "MAK_MODNAME": "make_model_combined_name",
              "BODY_TYP": "body_type",
              "BODY_TYPNAME": "body_type_name",
              "MOD_YEAR": "vehicle_model_year",
              "MOD_YEARNAME": "vehicle_model_year_name",
              "VIN": "vehicle_identification_number_vin",
              "VINNAME": "vehicle_identification_number_vin_name",
              "VIN_1": "vin_character_1",
              "VIN_2": "vin_character_2",
              "VIN_3": "vin_character_3",
              "VIN_4": "vin_character_4",
              "VIN_5": "vin_character_5",
              "VIN_6": "vin_character_6",
              "VIN_7": "vin_character_7",
              "VIN_8": "vin_character_8",
              "VIN_9": "vin_character_9",
              "VIN_10": "vin_character_10",
              "VIN_11": "vin_character_11",
              "VIN_12": "vin_character_12",
              "TOW_VEH": "vehicle_trailing",
              "TOW_VEHNAME": "vehicle_trailing_name",
              "J_KNIFE": "jackknife",
              "J_KNIFENAME": "jackknife_name",
              "MCARR_I1": "mcid_issuing_authority",
              "MCARR_I1NAME": "mcid_issuing_authority_name",
              "MCARR_I2": "mcid_identification_number",
              "MCARR_I2NAME": "mcid_identification_number_name",
              "MCARR_ID": "motor_carrier_identification_number_mcid",
              "MCARR_IDNAME": "motor_carrier_identification_number_mcid_name",
              "GVWR": "gross_vehicle_weight_rating",
              "GVWRNAME": "gross_vehicle_weight_rating_name",
              "V_CONFIG": "vehicle_configuration",
              "V_CONFIGNAME": "vehicle_configuration_name",
              "CARGO_BT": "cargo_body_type",
              "CARGO_BTNAME": "cargo_body_type_name",
              "HAZ_INV": "hazardous_material_involvement",
              "HAZ_INVNAME": "hazardous_material_involvement_name",
              "HAZ_PLAC": "hazardous_material_placard",
              "HAZ_PLACNAME": "hazardous_material_placard_name",
              "HAZ_ID": "hazardous_material_identification_number",
              "HAZ_IDNAME": "hazardous_material_identification_number_name",
              "HAZ_CNO": "hazardous_material_class_number",
              "HAZ_CNONAME": "hazardous_material_class_number_name",
              "HAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "HAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "BUS_USE": "bus_use",
              "BUS_USENAME": "bus_use_name",
              "SPEC_USE": "special_use",
              "SPEC_USENAME": "special_use_name",
              "EMER_USE": "emergency_motor_vehicle_use",
              "EMER_USENAME": "emergency_motor_vehicle_use_name",
              "TRAV_SP": "travel_speed",
              "TRAV_SPNAME": "travel_speed_name",
              "UNDERIDE": "underride_override",
              "UNDERIDENAME": "underride_override_name",
              "ROLLOVER": "rollover",
              "ROLLOVERNAME": "rollover_name",
              "ROLINLOC": "location_of_rollover",
              "ROLINLOCNAME": "location_of_rollover_name",
              "IMPACT1": "initial_contact_point",
              "IMPACT1NAME": "initial_contact_point_name",
              "DEFORMED": "extent_of_damage",
              "DEFORMEDNAME": "extent_of_damage_name",
              "TOWED": "vehicle_removal",
              "TOWEDNAME": "vehicle_removal_name",
              "M_HARM": "most_harmful_event",
              "M_HARMNAME": "most_harmful_event_name",
              "VEH_SC1": "related_factors_vehicle_level_1",
              "VEH_SC1NAME": "related_factors_vehicle_level_1_name",
              "VEH_SC2": "related_factors_vehicle_level_2",
              "VEH_SC2NAME": "related_factors_vehicle_level_2_name",
              "FIRE_EXP": "fire_occurrence",
              "FIRE_EXPNAME": "fire_occurrence_name",
              "DR_PRES": "driver_presence",
              "DR_PRESNAME": "driver_presence_name",
              "L_STATE": "drivers_license_state",
              "L_STATENAME": "drivers_license_state_name",
              "DR_ZIP": "drivers_zip_code",
              "DR_ZIPNAME": "drivers_zip_code_name",
              "L_STATUS": "non_cdl_license_status",
              "L_STATUSNAME": "non_cdl_license_status_name",
              "L_TYPE": "non_cdl_license_type",
              "L_TYPENAME": "non_cdl_license_type_name",
              "CDL_STAT": "commercial_motor_vehicle_license_status",
              "CDL_STATNAME": "commercial_motor_vehicle_license_status_name",
              "L_ENDORS": "compliance_with_cdl_endorsements",
              "L_ENDORSNAME": "compliance_with_cdl_endorsements_name",
              "L_COMPL": "license_compliance_with_class_of_vehicle",
              "L_COMPLNAME": "license_compliance_with_class_of_vehicle_name",
              "L_RESTRI": "compliance_with_license_restrictions",
              "L_RESTRINAME": "compliance_with_license_restrictions_name",
              "DR_HGT": "driver_height",
              "DR_HGTNAME": "driver_height_name",
              "DR_WGT": "driver_weight",
              "DR_WGTNAME": "driver_weight_name",
              "PREV_ACC": "previous_recorded_crashes",
              "PREV_ACCNAME": "previous_recorded_crashes_name",
              "PREV_SUS1": "previous_recorded_suspensions_and_revocations1",
              "PREV_SUS1NAME": "previous_recorded_suspensions_and_revocations1_name",
              "PREV_SUS2": "previous_recorded_suspensions_and_revocations2",
              "PREV_SUS2NAME": "previous_recorded_suspensions_and_revocations2_name",
              "PREV_SUS3": "previous_recorded_suspensions_and_revocations3",
              "PREV_SUS3NAME": "previous_recorded_suspensions_and_revocations3_name",
              "PREV_DWI": "previous_dwi_convictions",
              "PREV_DWINAME": "previous_dwi_convictions_name",
              "PREV_SPD": "previous_speeding_convictions",
              "PREV_SPDNAME": "previous_speeding_convictions_name",
              "PREV_OTH": "previous_other_moving_violation_convictions",
              "PREV_OTHNAME": "previous_other_moving_violation_convictions_name",
              "FIRST_MO": "month_of_first_crash_suspension_or_conviction",
              "FIRST_MONAME": "month_of_first_crash_suspension_or_conviction_name",
              "FIRST_YR": "year_of_first_crash_suspension_or_conviction",
              "FIRST_YRNAME": "year_of_first_crash_suspension_or_conviction_name",
              "LAST_MO": "month_of_last_crash_suspension_or_conviction",
              "LAST_MONAME": "month_of_last_crash_suspension_or_conviction_name",
              "LAST_YR": "year_of_last_crash_suspension_or_conviction",
              "LAST_YRNAME": "year_of_last_crash_suspension_or_conviction_name",
              "SPEEDREL": "speeding_related",
              "SPEEDRELNAME": "speeding_related_name",
              "DR_SF1": "related_factors_driver_level_1",
              "DR_SF1NAME": "related_factors_driver_level_1_name",
              "DR_SF2": "related_factors_driver_level_2",
              "DR_SF2NAME": "related_factors_driver_level_2_name",
              "DR_SF3": "related_factors_driver_level_3",
              "DR_SF3NAME": "related_factors_driver_level_3_name",
              "DR_SF4": "related_factors_driver_level_4",
              "DR_SF4NAME": "related_factors_driver_level_4_name",
              "VTRAFWAY": "trafficway_description",
              "VTRAFWAYNAME": "trafficway_description_name",
              "VNUM_LAN": "total_lanes_in_roadway",
              "VNUM_LANNAME": "total_lanes_in_roadway_name",
              "VSPD_LIM": "speed_limit",
              "VSPD_LIMNAME": "speed_limit_name",
              "VALIGN": "roadway_alignment",
              "VALIGNNAME": "roadway_alignment_name",
              "VPROFILE": "roadway_grade",
              "VPROFILENAME": "roadway_grade_name",
              "VPAVETYP": "roadway_surface_type",
              "VPAVETYPNAME": "roadway_surface_type_name",
              "VSURCOND": "roadway_surface_condition",
              "VSURCONDNAME": "roadway_surface_condition_name",
              "VTRAFCON": "traffic_control_device",
              "VTRAFCONNAME": "traffic_control_device_name",
              "VTCONT_F": "traffic_control_device_functioning",
              "VTCONT_FNAME": "traffic_control_device_functioning_name",
              "P_CRASH1": "pre_event_movement_prior_to_recognition_of_critical_event",
              "P_CRASH1NAME": "pre_event_movement_prior_to_recognition_of_critical_event_name",
              "P_CRASH2": "critical_event_precrash",
              "P_CRASH2NAME": "critical_event_precrash_name",
              "P_CRASH3": "attempted_avoidance_maneuver",
              "P_CRASH3NAME": "attempted_avoidance_maneuver_name",
              "PCRASH4": "pre_impact_stability",
              "PCRASH4NAME": "pre_impact_stability_name",
              "PCRASH5": "pre_impact_location",
              "PCRASH5NAME": "pre_impact_location_name",
              "ACC_TYPE": "crash_type",
              "ACC_TYPENAME": "crash_type_name",
              "DEATHS": "fatalities_in_vehicle",
              "DR_DRINK": "driver_drinking",
              "DR_DRINKNAME": "driver_drinking_name",
              "TRLR1VIN": "trailer_vehicle_identification_number_1",
              "TRLR1VINNAME": "trailer_vehicle_identification_number_1_name",
              "TRLR2VIN": "trailer_vehicle_identification_number_2",
              "TRLR2VINNAME": "trailer_vehicle_identification_number_2_name",
              "TRLR3VIN": "trailer_vehicle_identification_number_3",
              "TRLR3VINNAME": "trailer_vehicle_identification_number_3_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for vehicle pipelines"
      args:
        task_id: "vehicle_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "vehicle"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "vehicle.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.vehicle_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "make_model_combined_name",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "jackknife",
              "jackknife_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number_mcid",
              "motor_carrier_identification_number_mcid_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "travel_speed",
              "travel_speed_name",
              "underride_override",
              "underride_override_name",
              "rollover",
              "rollover_name",
              "location_of_rollover",
              "location_of_rollover_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "driver_presence",
              "driver_presence_name",
              "drivers_license_state",
              "drivers_license_state_name",
              "drivers_zip_code",
              "drivers_zip_code_name",
              "non_cdl_license_status",
              "non_cdl_license_status_name",
              "non_cdl_license_type",
              "non_cdl_license_type_name",
              "commercial_motor_vehicle_license_status",
              "commercial_motor_vehicle_license_status_name",
              "compliance_with_cdl_endorsements",
              "compliance_with_cdl_endorsements_name",
              "license_compliance_with_class_of_vehicle",
              "license_compliance_with_class_of_vehicle_name",
              "compliance_with_license_restrictions",
              "compliance_with_license_restrictions_name",
              "driver_height",
              "driver_height_name",
              "driver_weight",
              "driver_weight_name",
              "previous_recorded_crashes",
              "previous_recorded_crashes_name",
              "previous_recorded_suspensions_and_revocations1",
              "previous_recorded_suspensions_and_revocations1_name",
              "previous_recorded_suspensions_and_revocations2",
              "previous_recorded_suspensions_and_revocations2_name",
              "previous_recorded_suspensions_and_revocations3",
              "previous_recorded_suspensions_and_revocations3_name",
              "previous_dwi_convictions",
              "previous_dwi_convictions_name",
              "previous_speeding_convictions",
              "previous_speeding_convictions_name",
              "previous_other_moving_violation_convictions",
              "previous_other_moving_violation_convictions_name",
              "month_of_first_crash_suspension_or_conviction",
              "month_of_first_crash_suspension_or_conviction_name",
              "year_of_first_crash_suspension_or_conviction",
              "year_of_first_crash_suspension_or_conviction_name",
              "month_of_last_crash_suspension_or_conviction",
              "month_of_last_crash_suspension_or_conviction_name",
              "year_of_last_crash_suspension_or_conviction",
              "year_of_last_crash_suspension_or_conviction_name",
              "speeding_related",
              "speeding_related_name",
              "trafficway_description",
              "trafficway_description_name",
              "total_lanes_in_roadway",
              "total_lanes_in_roadway_name",
              "speed_limit",
              "speed_limit_name",
              "roadway_alignment",
              "roadway_alignment_name",
              "roadway_grade",
              "roadway_grade_name",
              "roadway_surface_type",
              "roadway_surface_type_name",
              "roadway_surface_condition",
              "roadway_surface_condition_name",
              "traffic_control_device",
              "traffic_control_device_name",
              "traffic_control_device_functioning",
              "traffic_control_device_functioning_name",
              "pre_event_movement_prior_to_recognition_of_critical_event",
              "pre_event_movement_prior_to_recognition_of_critical_event_name",
              "critical_event_precrash",
              "critical_event_precrash_name",
              "attempted_avoidance_maneuver",
              "attempted_avoidance_maneuver_name",
              "pre_impact_stability",
              "pre_impact_stability_name",
              "pre_impact_location",
              "pre_impact_location_name",
              "crash_type",
              "crash_type_name",
              "fatalities_in_vehicle",
              "driver_drinking",
              "driver_drinking_name",
              "trailer_vehicle_identification_number_1",
              "trailer_vehicle_identification_number_1_name",
              "trailer_vehicle_identification_number_2",
              "trailer_vehicle_identification_number_2_name",
              "trailer_vehicle_identification_number_3",
              "trailer_vehicle_identification_number_3_name",
              "vpic_make",
              "vpic_make_name",
              "vpic_model",
              "vpic_model_name",
              "vpic_body_class",
              "vpic_body_class_name",
              "final_stage_body_class",
              "final_stage_body_class_name",
              "power_unit_gross_vehicle_weight_rating_from",
              "power_unit_gross_vehicle_weight_rating_from_name",
              "power_unit_gross_vehicle_weight_rating_to",
              "power_unit_gross_vehicle_weight_rating_to_name",
              "trailer_gross_vehicle_weight_rating_1",
              "trailer_gross_vehicle_weight_rating_1_name",
              "trailer_gross_vehicle_weight_rating_2",
              "trailer_gross_vehicle_weight_rating_2_name",
              "trailer_gross_vehicle_weight_rating_3",
              "trailer_gross_vehicle_weight_rating_3_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "make_model_combined_name": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "jackknife": "str",
              "jackknife_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number_mcid": "str",
              "motor_carrier_identification_number_mcid_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "travel_speed": "str",
              "travel_speed_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "rollover": "str",
              "rollover_name": "str",
              "location_of_rollover": "str",
              "location_of_rollover_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "driver_presence": "str",
              "driver_presence_name": "str",
              "drivers_license_state": "str",
              "drivers_license_state_name": "str",
              "drivers_zip_code": "str",
              "drivers_zip_code_name": "str",
              "non_cdl_license_status": "str",
              "non_cdl_license_status_name": "str",
              "non_cdl_license_type": "str",
              "non_cdl_license_type_name": "str",
              "commercial_motor_vehicle_license_status": "str",
              "commercial_motor_vehicle_license_status_name": "str",
              "compliance_with_cdl_endorsements": "str",
              "compliance_with_cdl_endorsements_name": "str",
              "license_compliance_with_class_of_vehicle": "str",
              "license_compliance_with_class_of_vehicle_name": "str",
              "compliance_with_license_restrictions": "str",
              "compliance_with_license_restrictions_name": "str",
              "driver_height": "str",
              "driver_height_name": "str",
              "driver_weight": "str",
              "driver_weight_name": "str",
              "previous_recorded_crashes": "str",
              "previous_recorded_crashes_name": "str",
              "previous_recorded_suspensions_and_revocations1": "str",
              "previous_recorded_suspensions_and_revocations1_name": "str",
              "previous_recorded_suspensions_and_revocations2": "str",
              "previous_recorded_suspensions_and_revocations2_name": "str",
              "previous_recorded_suspensions_and_revocations3": "str",
              "previous_recorded_suspensions_and_revocations3_name": "str",
              "previous_dwi_convictions": "str",
              "previous_dwi_convictions_name": "str",
              "previous_speeding_convictions": "str",
              "previous_speeding_convictions_name": "str",
              "previous_other_moving_violation_convictions": "str",
              "previous_other_moving_violation_convictions_name": "str",
              "month_of_first_crash_suspension_or_conviction": "str",
              "month_of_first_crash_suspension_or_conviction_name": "str",
              "year_of_first_crash_suspension_or_conviction": "str",
              "year_of_first_crash_suspension_or_conviction_name": "str",
              "month_of_last_crash_suspension_or_conviction": "str",
              "month_of_last_crash_suspension_or_conviction_name": "str",
              "year_of_last_crash_suspension_or_conviction": "str",
              "year_of_last_crash_suspension_or_conviction_name": "str",
              "speeding_related": "str",
              "speeding_related_name": "str",
              "trafficway_description": "str",
              "trafficway_description_name": "str",
              "total_lanes_in_roadway": "str",
              "total_lanes_in_roadway_name": "str",
              "speed_limit": "str",
              "speed_limit_name": "str",
              "roadway_alignment": "str",
              "roadway_alignment_name": "str",
              "roadway_grade": "str",
              "roadway_grade_name": "str",
              "roadway_surface_type": "str",
              "roadway_surface_type_name": "str",
              "roadway_surface_condition": "str",
              "roadway_surface_condition_name": "str",
              "traffic_control_device": "str",
              "traffic_control_device_name": "str",
              "traffic_control_device_functioning": "str",
              "traffic_control_device_functioning_name": "str",
              "pre_event_movement_prior_to_recognition_of_critical_event": "str",
              "pre_event_movement_prior_to_recognition_of_critical_event_name": "str",
              "critical_event_precrash": "str",
              "critical_event_precrash_name": "str",
              "attempted_avoidance_maneuver": "str",
              "attempted_avoidance_maneuver_name": "str",
              "pre_impact_stability": "str",
              "pre_impact_stability_name": "str",
              "pre_impact_location": "str",
              "pre_impact_location_name": "str",
              "crash_type": "str",
              "crash_type_name": "str",
              "fatalities_in_vehicle": "str",
              "driver_drinking": "str",
              "driver_drinking_name": "str",
              "trailer_vehicle_identification_number_1": "str",
              "trailer_vehicle_identification_number_1_name": "str",
              "trailer_vehicle_identification_number_2": "str",
              "trailer_vehicle_identification_number_2_name": "str",
              "trailer_vehicle_identification_number_3": "str",
              "trailer_vehicle_identification_number_3_name": "str",
              "vpic_make": "str",
              "vpic_make_name": "str",
              "vpic_model": "str",
              "vpic_model_name": "str",
              "vpic_body_class": "str",
              "vpic_body_class_name": "str",
              "final_stage_body_class": "str",
              "final_stage_body_class_name": "str",
              "power_unit_gross_vehicle_weight_rating_from": "str",
              "power_unit_gross_vehicle_weight_rating_from_name": "str",
              "power_unit_gross_vehicle_weight_rating_to": "str",
              "power_unit_gross_vehicle_weight_rating_to_name": "str",
              "trailer_gross_vehicle_weight_rating_1": "str",
              "trailer_gross_vehicle_weight_rating_1_name": "str",
              "trailer_gross_vehicle_weight_rating_2": "str",
              "trailer_gross_vehicle_weight_rating_2_name": "str",
              "trailer_gross_vehicle_weight_rating_3": "str",
              "trailer_gross_vehicle_weight_rating_3_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "NUMOCCS": "number_of_occupants",
              "NUMOCCSNAME": "number_of_occupants_name",
              "DAY": "day_of_crash",
              "DAYNAME": "day_of_crash_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "UNITTYPE": "unit_type",
              "UNITTYPENAME": "unit_type_name",
              "HIT_RUN": "hit_and_run",
              "HIT_RUNNAME": "hit_and_run_name",
              "REG_STAT": "registration_state",
              "REG_STATNAME": "registration_state_name",
              "OWNER": "registered_vehicle_owner",
              "OWNERNAME": "registered_vehicle_owner_name",
              "MAKE": "vehicle_make",
              "MAKENAME": "vehicle_make_name",
              "MODEL": "vehicle_model",
              "MAK_MOD": "make_model_combined",
              "MAK_MODNAME": "make_model_combined_name",
              "BODY_TYP": "body_type",
              "BODY_TYPNAME": "body_type_name",
              "MOD_YEAR": "vehicle_model_year",
              "MOD_YEARNAME": "vehicle_model_year_name",
              "VIN": "vehicle_identification_number_vin",
              "VINNAME": "vehicle_identification_number_vin_name",
              "VIN_1": "vin_character_1",
              "VIN_2": "vin_character_2",
              "VIN_3": "vin_character_3",
              "VIN_4": "vin_character_4",
              "VIN_5": "vin_character_5",
              "VIN_6": "vin_character_6",
              "VIN_7": "vin_character_7",
              "VIN_8": "vin_character_8",
              "VIN_9": "vin_character_9",
              "VIN_10": "vin_character_10",
              "VIN_11": "vin_character_11",
              "VIN_12": "vin_character_12",
              "TOW_VEH": "vehicle_trailing",
              "TOW_VEHNAME": "vehicle_trailing_name",
              "J_KNIFE": "jackknife",
              "J_KNIFENAME": "jackknife_name",
              "MCARR_I1": "mcid_issuing_authority",
              "MCARR_I1NAME": "mcid_issuing_authority_name",
              "MCARR_I2": "mcid_identification_number",
              "MCARR_I2NAME": "mcid_identification_number_name",
              "MCARR_ID": "motor_carrier_identification_number_mcid",
              "MCARR_IDNAME": "motor_carrier_identification_number_mcid_name",
              "V_CONFIG": "vehicle_configuration",
              "V_CONFIGNAME": "vehicle_configuration_name",
              "CARGO_BT": "cargo_body_type",
              "CARGO_BTNAME": "cargo_body_type_name",
              "HAZ_INV": "hazardous_material_involvement",
              "HAZ_INVNAME": "hazardous_material_involvement_name",
              "HAZ_PLAC": "hazardous_material_placard",
              "HAZ_PLACNAME": "hazardous_material_placard_name",
              "HAZ_ID": "hazardous_material_identification_number",
              "HAZ_IDNAME": "hazardous_material_identification_number_name",
              "HAZ_CNO": "hazardous_material_class_number",
              "HAZ_CNONAME": "hazardous_material_class_number_name",
              "HAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "HAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "BUS_USE": "bus_use",
              "BUS_USENAME": "bus_use_name",
              "SPEC_USE": "special_use",
              "SPEC_USENAME": "special_use_name",
              "EMER_USE": "emergency_motor_vehicle_use",
              "EMER_USENAME": "emergency_motor_vehicle_use_name",
              "TRAV_SP": "travel_speed",
              "TRAV_SPNAME": "travel_speed_name",
              "UNDERIDE": "underride_override",
              "UNDERIDENAME": "underride_override_name",
              "ROLLOVER": "rollover",
              "ROLLOVERNAME": "rollover_name",
              "ROLINLOC": "location_of_rollover",
              "ROLINLOCNAME": "location_of_rollover_name",
              "IMPACT1": "initial_contact_point",
              "IMPACT1NAME": "initial_contact_point_name",
              "DEFORMED": "extent_of_damage",
              "DEFORMEDNAME": "extent_of_damage_name",
              "TOWED": "vehicle_removal",
              "TOWEDNAME": "vehicle_removal_name",
              "M_HARM": "most_harmful_event",
              "M_HARMNAME": "most_harmful_event_name",
              "FIRE_EXP": "fire_occurrence",
              "FIRE_EXPNAME": "fire_occurrence_name",
              "DR_PRES": "driver_presence",
              "DR_PRESNAME": "driver_presence_name",
              "L_STATE": "drivers_license_state",
              "L_STATENAME": "drivers_license_state_name",
              "DR_ZIP": "drivers_zip_code",
              "DR_ZIPNAME": "drivers_zip_code_name",
              "L_STATUS": "non_cdl_license_status",
              "L_STATUSNAME": "non_cdl_license_status_name",
              "L_TYPE": "non_cdl_license_type",
              "L_TYPENAME": "non_cdl_license_type_name",
              "CDL_STAT": "commercial_motor_vehicle_license_status",
              "CDL_STATNAME": "commercial_motor_vehicle_license_status_name",
              "L_ENDORS": "compliance_with_cdl_endorsements",
              "L_ENDORSNAME": "compliance_with_cdl_endorsements_name",
              "L_COMPL": "license_compliance_with_class_of_vehicle",
              "L_COMPLNAME": "license_compliance_with_class_of_vehicle_name",
              "L_RESTRI": "compliance_with_license_restrictions",
              "L_RESTRINAME": "compliance_with_license_restrictions_name",
              "DR_HGT": "driver_height",
              "DR_HGTNAME": "driver_height_name",
              "DR_WGT": "driver_weight",
              "DR_WGTNAME": "driver_weight_name",
              "PREV_ACC": "previous_recorded_crashes",
              "PREV_ACCNAME": "previous_recorded_crashes_name",
              "PREV_SUS1": "previous_recorded_suspensions_and_revocations1",
              "PREV_SUS1NAME": "previous_recorded_suspensions_and_revocations1_name",
              "PREV_SUS2": "previous_recorded_suspensions_and_revocations2",
              "PREV_SUS2NAME": "previous_recorded_suspensions_and_revocations2_name",
              "PREV_SUS3": "previous_recorded_suspensions_and_revocations3",
              "PREV_SUS3NAME": "previous_recorded_suspensions_and_revocations3_name",
              "PREV_DWI": "previous_dwi_convictions",
              "PREV_DWINAME": "previous_dwi_convictions_name",
              "PREV_SPD": "previous_speeding_convictions",
              "PREV_SPDNAME": "previous_speeding_convictions_name",
              "PREV_OTH": "previous_other_moving_violation_convictions",
              "PREV_OTHNAME": "previous_other_moving_violation_convictions_name",
              "FIRST_MO": "month_of_first_crash_suspension_or_conviction",
              "FIRST_MONAME": "month_of_first_crash_suspension_or_conviction_name",
              "FIRST_YR": "year_of_first_crash_suspension_or_conviction",
              "FIRST_YRNAME": "year_of_first_crash_suspension_or_conviction_name",
              "LAST_MO": "month_of_last_crash_suspension_or_conviction",
              "LAST_MONAME": "month_of_last_crash_suspension_or_conviction_name",
              "LAST_YR": "year_of_last_crash_suspension_or_conviction",
              "LAST_YRNAME": "year_of_last_crash_suspension_or_conviction_name",
              "SPEEDREL": "speeding_related",
              "SPEEDRELNAME": "speeding_related_name",
              "VTRAFWAY": "trafficway_description",
              "VTRAFWAYNAME": "trafficway_description_name",
              "VNUM_LAN": "total_lanes_in_roadway",
              "VNUM_LANNAME": "total_lanes_in_roadway_name",
              "VSPD_LIM": "speed_limit",
              "VSPD_LIMNAME": "speed_limit_name",
              "VALIGN": "roadway_alignment",
              "VALIGNNAME": "roadway_alignment_name",
              "VPROFILE": "roadway_grade",
              "VPROFILENAME": "roadway_grade_name",
              "VPAVETYP": "roadway_surface_type",
              "VPAVETYPNAME": "roadway_surface_type_name",
              "VSURCOND": "roadway_surface_condition",
              "VSURCONDNAME": "roadway_surface_condition_name",
              "VTRAFCON": "traffic_control_device",
              "VTRAFCONNAME": "traffic_control_device_name",
              "VTCONT_F": "traffic_control_device_functioning",
              "VTCONT_FNAME": "traffic_control_device_functioning_name",
              "P_CRASH1": "pre_event_movement_prior_to_recognition_of_critical_event",
              "P_CRASH1NAME": "pre_event_movement_prior_to_recognition_of_critical_event_name",
              "P_CRASH2": "critical_event_precrash",
              "P_CRASH2NAME": "critical_event_precrash_name",
              "P_CRASH3": "attempted_avoidance_maneuver",
              "P_CRASH3NAME": "attempted_avoidance_maneuver_name",
              "PCRASH4": "pre_impact_stability",
              "PCRASH4NAME": "pre_impact_stability_name",
              "PCRASH5": "pre_impact_location",
              "PCRASH5NAME": "pre_impact_location_name",
              "ACC_TYPE": "crash_type",
              "ACC_TYPENAME": "crash_type_name",
              "DEATHS": "fatalities_in_vehicle",
              "DR_DRINK": "driver_drinking",
              "DR_DRINKNAME": "driver_drinking_name",
              "TRLR1VIN": "trailer_vehicle_identification_number_1",
              "TRLR1VINNAME": "trailer_vehicle_identification_number_1_name",
              "TRLR2VIN": "trailer_vehicle_identification_number_2",
              "TRLR2VINNAME": "trailer_vehicle_identification_number_2_name",
              "TRLR3VIN": "trailer_vehicle_identification_number_3",
              "TRLR3VINNAME": "trailer_vehicle_identification_number_3_name",
              "VPICMAKE": "vpic_make",
              "VPICMAKENAME": "vpic_make_name",
              "VPICMODEL": "vpic_model",
              "VPICMODELNAME": "vpic_model_name",
              "VPICBODYCLASS": "vpic_body_class",
              "VPICBODYCLASSNAME": "vpic_body_class_name",
              "ICFINALBODY": "final_stage_body_class",
              "ICFINALBODYNAME": "final_stage_body_class_name",
              "GVWR_FROM": "power_unit_gross_vehicle_weight_rating_from",
              "GVWR_FROMNAME": "power_unit_gross_vehicle_weight_rating_from_name",
              "GVWR_TO": "power_unit_gross_vehicle_weight_rating_to",
              "GVWR_TONAME": "power_unit_gross_vehicle_weight_rating_to_name",
              "TRLR1GVWR": "trailer_gross_vehicle_weight_rating_1",
              "TRLR1GVWRNAME": "trailer_gross_vehicle_weight_rating_1_name",
              "TRLR2GVWR": "trailer_gross_vehicle_weight_rating_2",
              "TRLR2GVWRNAME": "trailer_gross_vehicle_weight_rating_2_name",
              "TRLR3GVWR": "trailer_gross_vehicle_weight_rating_3",
              "TRLR3GVWRNAME": "trailer_gross_vehicle_weight_rating_3_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for vevent pipelines"
      args:
        task_id: "vevent_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "vevent"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.vevent_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.vevent_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.vevent_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "vevent.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.vevent_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.vevent_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.vevent_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vevent_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vevent_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.vevent_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.vevent_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.vevent_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "event_number",
              "vehicle_number",
              "vehicle_event_number",
              "vehicle_number_this_vehicle",
              "area_of_impact_this_vehicle",
              "area_of_impact_this_vehicle_name",
              "sequence_of_events",
              "sequence_of_events_name",
              "vehicle_number_other_vehicle",
              "vehicle_number_other_vehicle_name",
              "area_of_impact_other_vehicle",
              "area_of_impact_other_vehicle_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "event_number": "str",
              "vehicle_number": "str",
              "vehicle_event_number": "str",
              "vehicle_number_this_vehicle": "str",
              "area_of_impact_this_vehicle": "str",
              "area_of_impact_this_vehicle_name": "str",
              "sequence_of_events": "str",
              "sequence_of_events_name": "str",
              "vehicle_number_other_vehicle": "str",
              "vehicle_number_other_vehicle_name": "str",
              "area_of_impact_other_vehicle": "str",
              "area_of_impact_other_vehicle_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "EVENTNUM": "event_number",
              "VEH_NO": "vehicle_number",
              "VEVENTNUM": "vehicle_event_number",
              "VNUMBER1": "vehicle_number_this_vehicle",
              "AOI1": "area_of_impact_this_vehicle",
              "AOI1NAME": "area_of_impact_this_vehicle_name",
              "SOE": "sequence_of_events",
              "SOENAME": "sequence_of_events_name",
              "VNUMBER2": "vehicle_number_other_vehicle",
              "VNUMBER2NAME": "vehicle_number_other_vehicle_name",
              "AOI2": "area_of_impact_other_vehicle",
              "AOI2NAME": "area_of_impact_other_vehicle_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for vindecode pipelines"
      args:
        task_id: "vindecode_2015_transform_csv"
        startup_timeout_seconds: 600
        name: "vindecode"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.vindecode_2015.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.vindecode_2015.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.vindecode_2015.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "vindecode.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.vindecode_2015.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.vindecode_2015.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.vindecode_2015.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vindecode_2015.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vindecode_2015.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.vindecode_2015.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.vindecode_2015.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.vindecode_2015.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "vehicle_make",
              "marketing_year",
              "vehicle_type_code",
              "vehicle_type",
              "make_name",
              "model_code",
              "vehicle_trim",
              "vehicle_trim_1",
              "vehicle_trim_2",
              "vehicle_trim_3",
              "vehicle_trim_4",
              "body_style_code",
              "body_style",
              "num_of_doors",
              "number_of_wheels",
              "num_of_wheels_by_power_train",
              "vehicle_manufacturer_code",
              "vehicle_manufacturer_name",
              "displacement_cid",
              "displacement_cc",
              "cylinder_count_code",
              "cycle_count",
              "fuel_code",
              "fuel",
              "type_of_fuel_code",
              "type_of_fuel",
              "carburetion_types_code",
              "carburetion_types",
              "num_of_barrels",
              "gross_vehicle_weights_range_code",
              "gross_vehicle_weights_range",
              "distance_between_axles_for_base_model",
              "distance_between_axles_for_particular_series",
              "front_tire",
              "front_tire_pressure",
              "front_tire_size_code",
              "front_tire_size",
              "rear_tire",
              "rear_tire_pressure",
              "rear_tire_size_code",
              "rear_tire_size",
              "tonnage_rating",
              "shipping_weight",
              "base_price",
              "drive_type_1",
              "drive_type_2",
              "country_sold_code",
              "country_sold",
              "brakes_abs_code",
              "brakes_abs_description",
              "security_type_code",
              "security_type",
              "daytime_running_lights_1",
              "daytime_running_lights_2",
              "restraint_type_code",
              "restraint_type",
              "cab_configuration_code",
              "cab_configuration",
              "axle_type_front_axle_code",
              "axle_type_front_axle",
              "axle_type_rear_axle_code",
              "axle_type_rear_axle",
              "brake_type_code",
              "brake_type",
              "engine_manufacture_code",
              "engine_manufacture",
              "engine_model",
              "duty_type_code",
              "duty_type",
              "bed_length_code",
              "bed_length",
              "standard_segmentation_code",
              "standard_segmentation",
              "plant_code",
              "plant_country",
              "plant_city",
              "plant_country_code",
              "plant_state_code",
              "plant_state",
              "origin_code",
              "origin",
              "displacement_liters",
              "block_type",
              "head_configuration_1",
              "head_configuration_2",
              "valves_per_cylinder",
              "valves_total",
              "engine_code",
              "is_incomplete",
              "battery_type_code",
              "battery_type",
              "total_battery_power",
              "battery_voltage",
              "supercharge_flag",
              "supercharge_flag_description",
              "turbocharger_flag",
              "turbocharger_flag_description",
              "variable_valve_timing_flag",
              "motorcycles_body_style_code",
              "motorcycles_body_style"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "vehicle_make": "str",
              "marketing_year": "str",
              "vehicle_type_code": "str",
              "vehicle_type": "str",
              "make_name": "str",
              "model_code": "str",
              "vehicle_trim": "str",
              "vehicle_trim_1": "str",
              "vehicle_trim_2": "str",
              "vehicle_trim_3": "str",
              "vehicle_trim_4": "str",
              "body_style_code": "str",
              "body_style": "str",
              "num_of_doors": "str",
              "number_of_wheels": "str",
              "num_of_wheels_by_power_train": "str",
              "vehicle_manufacturer_code": "str",
              "vehicle_manufacturer_name": "str",
              "displacement_cid": "str",
              "displacement_cc": "str",
              "cylinder_count_code": "str",
              "cycle_count": "str",
              "fuel_code": "str",
              "fuel": "str",
              "type_of_fuel_code": "str",
              "type_of_fuel": "str",
              "carburetion_types_code": "str",
              "carburetion_types": "str",
              "num_of_barrels": "str",
              "gross_vehicle_weights_range_code": "str",
              "gross_vehicle_weights_range": "str",
              "distance_between_axles_for_base_model": "str",
              "distance_between_axles_for_particular_series": "str",
              "front_tire": "str",
              "front_tire_pressure": "str",
              "front_tire_size_code": "str",
              "front_tire_size": "str",
              "rear_tire": "str",
              "rear_tire_pressure": "str",
              "rear_tire_size_code": "str",
              "rear_tire_size": "str",
              "tonnage_rating": "str",
              "shipping_weight": "str",
              "base_price": "str",
              "drive_type_1": "str",
              "drive_type_2": "str",
              "country_sold_code": "str",
              "country_sold": "str",
              "brakes_abs_code": "str",
              "brakes_abs_description": "str",
              "security_type_code": "str",
              "security_type": "str",
              "daytime_running_lights_1": "str",
              "daytime_running_lights_2": "str",
              "restraint_type_code": "str",
              "restraint_type": "str",
              "cab_configuration_code": "str",
              "cab_configuration": "str",
              "axle_type_front_axle_code": "str",
              "axle_type_front_axle": "str",
              "axle_type_rear_axle_code": "str",
              "axle_type_rear_axle": "str",
              "brake_type_code": "str",
              "brake_type": "str",
              "engine_manufacture_code": "str",
              "engine_manufacture": "str",
              "engine_model": "str",
              "duty_type_code": "str",
              "duty_type": "str",
              "bed_length_code": "str",
              "bed_length": "str",
              "standard_segmentation_code": "str",
              "standard_segmentation": "str",
              "plant_code": "str",
              "plant_country": "str",
              "plant_city": "str",
              "plant_country_code": "str",
              "plant_state_code": "str",
              "plant_state": "str",
              "origin_code": "str",
              "origin": "str",
              "displacement_liters": "str",
              "block_type": "str",
              "head_configuration_1": "str",
              "head_configuration_2": "str",
              "valves_per_cylinder": "str",
              "valves_total": "str",
              "engine_code": "str",
              "is_incomplete": "str",
              "battery_type_code": "str",
              "battery_type": "str",
              "total_battery_power": "str",
              "battery_voltage": "str",
              "supercharge_flag": "str",
              "supercharge_flag_description": "str",
              "turbocharger_flag": "str",
              "turbocharger_flag_description": "str",
              "variable_valve_timing_flag": "str",
              "motorcycles_body_style_code": "str",
              "motorcycles_body_style": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "NCICMAKE": "vehicle_make",
              "VINYEAR": "marketing_year",
              "VEHTYPE": "vehicle_type_code",
              "VEHTYPE_T": "vehicle_type",
              "VINMAKE_T": "make_name",
              "VINMODEL_T": "model_code",
              "VINTRIM_T": "vehicle_trim",
              "VINTRIM1_T": "vehicle_trim_1",
              "VINTRIM2_T": "vehicle_trim_2",
              "VINTRIM3_T": "vehicle_trim_3",
              "VINTRIM4_T": "vehicle_trim_4",
              "BODYSTYL": "body_style_code",
              "BODYSTYL_T": "body_style",
              "DOORS": "num_of_doors",
              "WHEELS": "number_of_wheels",
              "DRIVWHLS": "num_of_wheels_by_power_train",
              "MFG": "vehicle_manufacturer_code",
              "MFG_T": "vehicle_manufacturer_name",
              "DISPLCI": "displacement_cid",
              "DISPLCC": "displacement_cc",
              "CYLNDRS": "cylinder_count_code",
              "CYCLES": "cycle_count",
              "FUEL": "fuel_code",
              "FUEL_T": "fuel",
              "FUELINJ": "type_of_fuel_code",
              "FUELINJ_T": "type_of_fuel",
              "CARBTYPE": "carburetion_types_code",
              "CARBTYPE_T": "carburetion_types",
              "CARBBRLS": "num_of_barrels",
              "GVWRANGE": "gross_vehicle_weights_range_code",
              "GVWRANGE_T": "gross_vehicle_weights_range",
              "WHLBSH": "distance_between_axles_for_base_model",
              "WHLBLG": "distance_between_axles_for_particular_series",
              "TIREDESC_F": "front_tire",
              "PSI_F": "front_tire_pressure",
              "TIRESZ_F": "front_tire_size_code",
              "TIRESZ_F_T": "front_tire_size",
              "TIREDESC_R": "rear_tire",
              "PSI_R": "rear_tire_pressure",
              "REARSIZE": "rear_tire_size_code",
              "REARSIZE_T": "rear_tire_size",
              "TONRATING": "tonnage_rating",
              "SHIPWEIGHT": "shipping_weight",
              "MSRP": "base_price",
              "DRIVETYP": "drive_type_1",
              "DRIVETYP_T": "drive_type_2",
              "SALECTRY": "country_sold_code",
              "SALECTRY_T": "country_sold",
              "ABS": "brakes_abs_code",
              "ABS_T": "brakes_abs_description",
              "SECURITY": "security_type_code",
              "SECURITY_T": "security_type",
              "DRL": "daytime_running_lights_1",
              "DRL_T": "daytime_running_lights_2",
              "RSTRNT": "restraint_type_code",
              "RSTRNT_T": "restraint_type",
              "TKCAB": "cab_configuration_code",
              "TKCAB_T": "cab_configuration",
              "TKAXLEF": "axle_type_front_axle_code",
              "TKAXLEF_T": "axle_type_front_axle",
              "TKAXLER": "axle_type_rear_axle_code",
              "TKAXLER_T": "axle_type_rear_axle",
              "TKBRAK": "brake_type_code",
              "TKBRAK_T": "brake_type",
              "ENGMFG": "engine_manufacture_code",
              "ENGMFG_T": "engine_manufacture",
              "ENGMODEL": "engine_model",
              "TKDUTY": "duty_type_code",
              "TKDUTY_T": "duty_type",
              "TKBEDL": "bed_length_code",
              "TKBEDL_T": "bed_length",
              "SEGMNT": "standard_segmentation_code",
              "SEGMNT_T": "standard_segmentation",
              "PLANT": "plant_code",
              "PLNTCTRY_T": "plant_country",
              "PLNTCITY": "plant_city",
              "PLNTCTRY": "plant_country_code",
              "PLNTSTAT": "plant_state_code",
              "PLNTSTAT_T": "plant_state",
              "ORIGIN": "origin_code",
              "ORIGIN_T": "origin",
              "DISPCLMT": "displacement_liters",
              "BLOCKTYPE": "block_type",
              "ENGHEAD": "head_configuration_1",
              "ENGHEAD_T": "head_configuration_2",
              "VLVCLNDR": "valves_per_cylinder",
              "VLVTOTAL": "valves_total",
              "ENGVINCD": "engine_code",
              "INCOMPLT": "is_incomplete",
              "BATTYP": "battery_type_code",
              "BATTYP_T": "battery_type",
              "BATKWRTG": "total_battery_power",
              "BATVOLT": "battery_voltage",
              "SUPCHRGR": "supercharge_flag",
              "SUPCHRGR_T": "supercharge_flag_description",
              "TURBO": "turbocharger_flag",
              "TURBO_T": "turbocharger_flag_description",
              "ENGVVT": "variable_valve_timing_flag",
              "MCYUSAGE": "motorcycles_body_style_code",
              "MCYUSAGE_T": "motorcycles_body_style"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for violatn pipelines"
      args:
        task_id: "violatn_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "violatn"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.violatn_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.violatn_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.violatn_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "violatn.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.violatn_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.violatn_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.violatn_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.violatn_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.violatn_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.violatn_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.violatn_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.violatn_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "violations_charged",
              "violations_charged_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "violations_charged": "str",
              "violations_charged_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "MVIOLATN": "violations_charged",
              "MVIOLATNNAME": "violations_charged_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for vision pipelines"
      args:
        task_id: "vision_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "vision"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.vision_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.vision_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.vision_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "vision.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.vision_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.vision_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.vision_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vision_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vision_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.vision_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.vision_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.vision_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "drivers_vision_obscured_by",
              "drivers_vision_obscured_by_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "drivers_vision_obscured_by": "str",
              "drivers_vision_obscured_by_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "MVISOBSC": "drivers_vision_obscured_by",
              "MVISOBSCNAME": "drivers_vision_obscured_by_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for vsoe pipelines"
      args:
        task_id: "vsoe_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "vsoe"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.vsoe_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.vsoe_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.vsoe_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "vsoe.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.vsoe_2015_2020.source_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.vsoe_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.vsoe_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vsoe_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.vsoe_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.vsoe_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.vsoe_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.vsoe_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "vehicle_event_number",
              "sequence_of_events",
              "sequence_of_events_name",
              "area_of_Impact_associated_with_the_event",
              "area_of_Impact_associated_with_the_event_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "vehicle_event_number": "str",
              "sequence_of_events": "str",
              "sequence_of_events_name": "str",
              "area_of_Impact_associated_with_the_event": "str",
              "area_of_Impact_associated_with_the_event_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "VEVENTNUM": "vehicle_event_number",
              "SOE": "sequence_of_events",
              "SOENAME": "sequence_of_events_name",
              "AOI": "area_of_Impact_associated_with_the_event",
              "AOINAME": "area_of_Impact_associated_with_the_event_name"
            }
        resources:
          request_ephemeral_storage: "4G"
          request_cpu: "1"
          request_memory: "4G"
    - operator: "GKEDeleteClusterOperator"
      args:
        task_id: "delete_cluster"
        project_id: "{{ var.value.gcp_project }}"
        location: "us-central1-c"
        name: nhtsa-traffic-fatalities

  graph_paths:
    - "create_cluster >> [ accident_2015_transform_csv,accident_2016_2019_transform_csv,accident_2020_transform_csv,cevent_2015_2020_transform_csv,damage_2015_2020_transform_csv,distract_2015_2020_transform_csv,drimpair_2015_2020_transform_csv,factor_2015_2020_transform_csv,maneuver_2015_2020_transform_csv,nmcrash_2015_2020_transform_csv,nmimpair_2015_2020_transform_csv,nmprior_2015_2020_transform_csv,parkwork_2015_transform_csv,parkwork_2016_2017_transform_csv,parkwork_2018_transform_csv,parkwork_2019_transform_csv,parkwork_2020_transform_csv,pbtype_transform_csv,person_2015_2017_transform_csv,person_2018_transform_csv,person_2019_transform_csv,person_2020_transform_csv,safetyeq_2015_2016_transform_csv,safetyeq_2017_2020_transform_csv,vehicle_2015_transform_csv,vehicle_2016_2017_transform_csv,vehicle_2018_2019_transform_csv,vehicle_2020_transform_csv,vevent_2015_2020_transform_csv,vindecode_2015_transform_csv,violatn_2015_2020_transform_csv,vision_2015_2020_transform_csv,vsoe_2015_2020_transform_csv] >> delete_cluster"
