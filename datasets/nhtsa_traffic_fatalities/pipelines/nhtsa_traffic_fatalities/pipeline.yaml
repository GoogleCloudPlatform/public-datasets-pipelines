# Copyright 2021 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
dag:
  airflow_version: 2
  initialize:
    dag_id: nhtsa_traffic_fatalities
    default_args:
      owner: "Google"
      depends_on_past: False
      start_date: "2021-03-01"
    max_active_runs: 1
    schedule_interval: "@daily"
    catchup: False
    default_view: graph
  tasks:
    - operator: "GKECreateClusterOperator"
      args:
        task_id: "create_cluster"
        project_id: "{{ var.value.gcp_project }}"
        location: "us-central1-c"
        body:
          name: nhtsa-traffic-fatalities
          initial_node_count: 8
          network: "{{ var.value.vpc_network }}"
          node_config:
            machine_type: e2-standard-16
            oauth_scopes:
              - https://www.googleapis.com/auth/devstorage.read_write
              - https://www.googleapis.com/auth/cloud-platform

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod"
      args:
        task_id: "accident_2015_transform_csv"
        startup_timeout_seconds: 600
        name: "accident_2015"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "accident_2015.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.accident_2015.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_vehicle_forms_submitted_all",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_parked_working_vehicles",
              "number_of_forms_submitted_for_persons_not_in_motor_vehicles",
              "number_of_forms_submitted_for_persons_in_motor_vehicles",
              "number_of_persons_in_motor_vehicles_in_transport_mvit",
              "number_of_persons_not_in_motor_vehicles_in_transport_mvit",
              "county",
              "city",
              "day_of_crash",
              "day_name",
              "month_of_crash",
              "month_of_crash_name",
              "year_of_crash",
              "day_of_week",
              "day_of_week_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "national_highway_system",
              "national_highway_system_name",
              "route_signing",
              "route_signing_name",
              "trafficway_identifier",
              "trafficway_identifier_2",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "ownership",
              "ownership_name",
              "milepoint",
              "milepoint_name",
              "latitude",
              "latitude_name",
              "longitude",
              "longitude_name",
              "special_jurisdiction",
              "special_jurisdiction_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "relation_to_junction_within_interchange_area",
              "relation_to_junction_within_interchange_area_name",
              "relation_to_junction_specific_location",
              "relation_to_junction_specific_location_name",
              "type_of_intersection",
              "type_of_intersection_name",
              "work_zone",
              "work_zone_name",
              "relation_to_trafficway",
              "relation_to_trafficway_name",
              "light_condition",
              "light_condition_name",
              "atmospheric_conditions_1",
              "atmospheric_conditions_1_name",
              "atmospheric_conditions_2",
              "atmospheric_conditions_2_name",
              "atmospheric_conditions",
              "atmospheric_conditions_name",
              "school_bus_related",
              "school_bus_related_name",
              "rail_grade_crossing_identifier",
              "rail_grade_crossing_identifier_name",
              "hour_of_notification",
              "hour_of_notification_name",
              "minute_of_notification",
              "minute_of_notification_name",
              "hour_of_arrival_at_scene",
              "hour_of_arrival_at_scene_name",
              "minute_of_arrival_at_scene",
              "minute_of_arrival_at_scene_name",
              "hour_of_ems_arrival_at_hospital",
              "hour_of_ems_arrival_at_hospital_name",
              "minute_of_ems_arrival_at_hospital",
              "minute_of_ems_arrival_at_hospital_name",
              "related_factors_crash_level_1",
              "related_factors_crash_level_1_name",
              "related_factors_crash_level_2",
              "related_factors_crash_level_2_name",
              "related_factors_crash_level_3",
              "related_factors_crash_level_3_name",
              "number_of_fatalities",
              "number_of_drunk_drivers"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_vehicle_forms_submitted_all": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_parked_working_vehicles": "str",
              "number_of_forms_submitted_for_persons_not_in_motor_vehicles": "str",
              "number_of_forms_submitted_for_persons_in_motor_vehicles": "str",
              "number_of_persons_in_motor_vehicles_in_transport_mvit": "str",
              "number_of_persons_not_in_motor_vehicles_in_transport_mvit": "str",
              "county": "str",
              "city": "str",
              "day_of_crash": "str",
              "day_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "year_of_crash": "str",
              "day_of_week": "str",
              "day_of_week_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "national_highway_system": "str",
              "national_highway_system_name": "str",
              "route_signing": "str",
              "route_signing_name": "str",
              "trafficway_identifier": "str",
              "trafficway_identifier_2": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "ownership": "str",
              "ownership_name": "str",
              "milepoint": "str",
              "milepoint_name": "str",
              "latitude": "str",
              "latitude_name": "str",
              "longitude": "str",
              "longitude_name": "str",
              "special_jurisdiction": "str",
              "special_jurisdiction_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "relation_to_junction_within_interchange_area": "str",
              "relation_to_junction_within_interchange_area_name": "str",
              "relation_to_junction_specific_location": "str",
              "relation_to_junction_specific_location_name": "str",
              "type_of_intersection": "str",
              "type_of_intersection_name": "str",
              "work_zone": "str",
              "work_zone_name": "str",
              "relation_to_trafficway": "str",
              "relation_to_trafficway_name": "str",
              "light_condition": "str",
              "light_condition_name": "str",
              "atmospheric_conditions_1": "str",
              "atmospheric_conditions_1_name": "str",
              "atmospheric_conditions_2": "str",
              "atmospheric_conditions_2_name": "str",
              "atmospheric_conditions": "str",
              "atmospheric_conditions_name": "str",
              "school_bus_related": "str",
              "school_bus_related_name": "str",
              "rail_grade_crossing_identifier": "str",
              "rail_grade_crossing_identifier_name": "str",
              "hour_of_notification": "str",
              "hour_of_notification_name": "str",
              "minute_of_notification": "str",
              "minute_of_notification_name": "str",
              "hour_of_arrival_at_scene": "str",
              "hour_of_arrival_at_scene_name": "str",
              "minute_of_arrival_at_scene": "str",
              "minute_of_arrival_at_scene_name": "str",
              "hour_of_ems_arrival_at_hospital": "str",
              "hour_of_ems_arrival_at_hospital_name": "str",
              "minute_of_ems_arrival_at_hospital": "str",
              "minute_of_ems_arrival_at_hospital_name": "str",
              "related_factors_crash_level_1": "str",
              "related_factors_crash_level_1_name": "str",
              "related_factors_crash_level_2": "str",
              "related_factors_crash_level_2_name": "str",
              "related_factors_crash_level_3": "str",
              "related_factors_crash_level_3_name": "str",
              "number_of_fatalities": "str",
              "number_of_drunk_drivers": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_TOTAL": "number_of_vehicle_forms_submitted_all",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PVH_INVL": "number_of_parked_working_vehicles",
              "PEDS": "number_of_forms_submitted_for_persons_not_in_motor_vehicles",
              "PERSONS": "number_of_forms_submitted_for_persons_in_motor_vehicles",
              "PERMVIT": "number_of_persons_in_motor_vehicles_in_transport_mvit",
              "PERNOTMVIT": "number_of_persons_not_in_motor_vehicles_in_transport_mvit",
              "COUNTY": "county",
              "CITY": "city",
              "DAY": "day_of_crash",
              "DAYNAME": "day_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "YEAR": "year_of_crash",
              "DAY_WEEK": "day_of_week",
              "DAY_WEEKNAME": "day_of_week_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "NHS": "national_highway_system",
              "NHSNAME": "national_highway_system_name",
              "ROUTE": "route_signing",
              "ROUTENAME": "route_signing_name",
              "TWAY_ID": "trafficway_identifier",
              "TWAY_ID2": "trafficway_identifier_2",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "RD_OWNER": "ownership",
              "RD_OWNERNAME": "ownership_name",
              "MILEPT": "milepoint",
              "MILEPTNAME": "milepoint_name",
              "LATITUDE": "latitude",
              "LATITUDENAME": "latitude_name",
              "LONGITUD": "longitude",
              "LONGITUDNAME": "longitude_name",
              "SP_JUR": "special_jurisdiction",
              "SP_JURNAME": "special_jurisdiction_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "RELJCT1": "relation_to_junction_within_interchange_area",
              "RELJCT1NAME": "relation_to_junction_within_interchange_area_name",
              "RELJCT2": "relation_to_junction_specific_location",
              "RELJCT2NAME": "relation_to_junction_specific_location_name",
              "TYP_INT" : "type_of_intersection",
              "TYP_INTNAME": "type_of_intersection_name",
              "WRK_ZONE": "work_zone",
              "WRK_ZONENAME": "work_zone_name",
              "REL_ROAD": "relation_to_trafficway",
              "REL_ROADNAME": "relation_to_trafficway_name",
              "LGT_COND": "light_condition",
              "LGT_CONDNAME": "light_condition_name",
              "WEATHER1": "atmospheric_conditions_1",
              "WEATHER1NAME": "atmospheric_conditions_1_name",
              "WEATHER2": "atmospheric_conditions_2",
              "WEATHER2NAME": "atmospheric_conditions_2_name",
              "WEATHER": "atmospheric_conditions",
              "WEATHERNAME": "atmospheric_conditions_name",
              "SCH_BUS": "school_bus_related",
              "SCH_BUSNAME": "school_bus_related_name",
              "RAIL": "rail_grade_crossing_identifier",
              "RAILNAME": "rail_grade_crossing_identifier_name",
              "NOT_HOUR": "hour_of_notification",
              "NOT_HOURNAME": "hour_of_notification_name",
              "NOT_MIN": "minute_of_notification",
              "NOT_MINNAME": "minute_of_notification_name",
              "ARR_HOUR": "hour_of_arrival_at_scene",
              "ARR_HOURNAME": "hour_of_arrival_at_scene_name",
              "ARR_MIN": "minute_of_arrival_at_scene",
              "ARR_MINNAME": "minute_of_arrival_at_scene_name",
              "HOSP_HR": "hour_of_ems_arrival_at_hospital",
              "HOSP_HRNAME": "hour_of_ems_arrival_at_hospital_name",
              "HOSP_MN": "minute_of_ems_arrival_at_hospital",
              "HOSP_MNNAME": "minute_of_ems_arrival_at_hospital_name",
              "CF1": "related_factors_crash_level_1",
              "CF1NAME": "related_factors_crash_level_1_name",
              "CF2": "related_factors_crash_level_2",
              "CF2NAME": "related_factors_crash_level_2_name",
              "CF3": "related_factors_crash_level_3",
              "CF3NAME": "related_factors_crash_level_3_name",
              "FATALS": "number_of_fatalities",
              "DRUNK_DR": "number_of_drunk_drivers"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod"
      args:
        task_id: "accident_2016_2019_transform_csv"
        startup_timeout_seconds: 600
        name: "accident_2016_2019"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "accident_2016_2019.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.accident_2016_2019.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_vehicle_forms_submitted_all",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_parked_working_vehicles",
              "number_of_forms_submitted_for_persons_not_in_motor_vehicles",
              "number_of_forms_submitted_for_persons_in_motor_vehicles",
              "number_of_persons_in_motor_vehicles_in_transport_mvit",
              "number_of_persons_not_in_motor_vehicles_in_transport_mvit",
              "county",
              "county_name",
              "city",
              "city_name",
              "day_of_crash",
              "day_name",
              "month_of_crash",
              "month_of_crash_name",
              "year_of_crash",
              "day_of_week",
              "day_of_week_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "national_highway_system",
              "national_highway_system_name",
              "route_signing",
              "route_signing_name",
              "trafficway_identifier",
              "trafficway_identifier_2",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "ownership",
              "ownership_name",
              "milepoint",
              "milepoint_name",
              "latitude",
              "latitude_name",
              "longitude",
              "longitude_name",
              "special_jurisdiction",
              "special_jurisdiction_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "relation_to_junction_within_interchange_area",
              "relation_to_junction_within_interchange_area_name",
              "relation_to_junction_specific_location",
              "relation_to_junction_specific_location_name",
              "type_of_intersection",
              "type_of_intersection_name",
              "work_zone",
              "work_zone_name",
              "relation_to_trafficway",
              "relation_to_trafficway_name",
              "light_condition",
              "light_condition_name",
              "atmospheric_conditions_1",
              "atmospheric_conditions_1_name",
              "atmospheric_conditions_2",
              "atmospheric_conditions_2_name",
              "atmospheric_conditions",
              "atmospheric_conditions_name",
              "school_bus_related",
              "school_bus_related_name",
              "rail_grade_crossing_identifier",
              "rail_grade_crossing_identifier_name",
              "hour_of_notification",
              "hour_of_notification_name",
              "minute_of_notification",
              "minute_of_notification_name",
              "hour_of_arrival_at_scene",
              "hour_of_arrival_at_scene_name",
              "minute_of_arrival_at_scene",
              "minute_of_arrival_at_scene_name",
              "hour_of_ems_arrival_at_hospital",
              "hour_of_ems_arrival_at_hospital_name",
              "minute_of_ems_arrival_at_hospital",
              "minute_of_ems_arrival_at_hospital_name",
              "related_factors_crash_level_1",
              "related_factors_crash_level_1_name",
              "related_factors_crash_level_2",
              "related_factors_crash_level_2_name",
              "related_factors_crash_level_3",
              "related_factors_crash_level_3_name",
              "number_of_fatalities",
              "number_of_drunk_drivers"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_vehicle_forms_submitted_all": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_parked_working_vehicles": "str",
              "number_of_forms_submitted_for_persons_not_in_motor_vehicles": "str",
              "number_of_forms_submitted_for_persons_in_motor_vehicles": "str",
              "number_of_persons_in_motor_vehicles_in_transport_mvit": "str",
              "number_of_persons_not_in_motor_vehicles_in_transport_mvit": "str",
              "county": "str",
              "county_name": "str",
              "city": "str",
              "city_name": "str",
              "day_of_crash": "str",
              "day_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "year_of_crash": "str",
              "day_of_week": "str",
              "day_of_week_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "national_highway_system": "str",
              "national_highway_system_name": "str",
              "route_signing": "str",
              "route_signing_name": "str",
              "trafficway_identifier": "str",
              "trafficway_identifier_2": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "ownership": "str",
              "ownership_name": "str",
              "milepoint": "str",
              "milepoint_name": "str",
              "latitude": "str",
              "latitude_name": "str",
              "longitude": "str",
              "longitude_name": "str",
              "special_jurisdiction": "str",
              "special_jurisdiction_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "relation_to_junction_within_interchange_area": "str",
              "relation_to_junction_within_interchange_area_name": "str",
              "relation_to_junction_specific_location": "str",
              "relation_to_junction_specific_location_name": "str",
              "type_of_intersection": "str",
              "type_of_intersection_name": "str",
              "work_zone": "str",
              "work_zone_name": "str",
              "relation_to_trafficway": "str",
              "relation_to_trafficway_name": "str",
              "light_condition": "str",
              "light_condition_name": "str",
              "atmospheric_conditions_1": "str",
              "atmospheric_conditions_1_name": "str",
              "atmospheric_conditions_2": "str",
              "atmospheric_conditions_2_name": "str",
              "atmospheric_conditions": "str",
              "atmospheric_conditions_name": "str",
              "school_bus_related": "str",
              "school_bus_related_name": "str",
              "rail_grade_crossing_identifier": "str",
              "rail_grade_crossing_identifier_name": "str",
              "hour_of_notification": "str",
              "hour_of_notification_name": "str",
              "minute_of_notification": "str",
              "minute_of_notification_name": "str",
              "hour_of_arrival_at_scene": "str",
              "hour_of_arrival_at_scene_name": "str",
              "minute_of_arrival_at_scene": "str",
              "minute_of_arrival_at_scene_name": "str",
              "hour_of_ems_arrival_at_hospital": "str",
              "hour_of_ems_arrival_at_hospital_name": "str",
              "minute_of_ems_arrival_at_hospital": "str",
              "minute_of_ems_arrival_at_hospital_name": "str",
              "related_factors_crash_level_1": "str",
              "related_factors_crash_level_1_name": "str",
              "related_factors_crash_level_2": "str",
              "related_factors_crash_level_2_name": "str",
              "related_factors_crash_level_3": "str",
              "related_factors_crash_level_3_name": "str",
              "number_of_fatalities": "str",
              "number_of_drunk_drivers": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_TOTAL": "number_of_vehicle_forms_submitted_all",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PVH_INVL": "number_of_parked_working_vehicles",
              "PEDS": "number_of_forms_submitted_for_persons_not_in_motor_vehicles",
              "PERSONS": "number_of_forms_submitted_for_persons_in_motor_vehicles",
              "PERMVIT": "number_of_persons_in_motor_vehicles_in_transport_mvit",
              "PERNOTMVIT": "number_of_persons_not_in_motor_vehicles_in_transport_mvit",
              "COUNTY": "county",
              "COUNTYNAME": "county_name",
              "CITY": "city",
              "CITYNAME": "city_name",
              "DAY": "day_of_crash",
              "DAYNAME": "day_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "YEAR": "year_of_crash",
              "DAY_WEEK": "day_of_week",
              "DAY_WEEKNAME": "day_of_week_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "NHS": "national_highway_system",
              "NHSNAME": "national_highway_system_name",
              "ROUTE": "route_signing",
              "ROUTENAME": "route_signing_name",
              "TWAY_ID": "trafficway_identifier",
              "TWAY_ID2": "trafficway_identifier_2",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "RD_OWNER": "ownership",
              "RD_OWNERNAME": "ownership_name",
              "MILEPT": "milepoint",
              "MILEPTNAME": "milepoint_name",
              "LATITUDE": "latitude",
              "LATITUDENAME": "latitude_name",
              "LONGITUD": "longitude",
              "LONGITUDNAME": "longitude_name",
              "SP_JUR": "special_jurisdiction",
              "SP_JURNAME": "special_jurisdiction_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "RELJCT1": "relation_to_junction_within_interchange_area",
              "RELJCT1NAME": "relation_to_junction_within_interchange_area_name",
              "RELJCT2": "relation_to_junction_specific_location",
              "RELJCT2NAME": "relation_to_junction_specific_location_name",
              "TYP_INT" : "type_of_intersection",
              "TYP_INTNAME": "type_of_intersection_name",
              "WRK_ZONE": "work_zone",
              "WRK_ZONENAME": "work_zone_name",
              "REL_ROAD": "relation_to_trafficway",
              "REL_ROADNAME": "relation_to_trafficway_name",
              "LGT_COND": "light_condition",
              "LGT_CONDNAME": "light_condition_name",
              "WEATHER1": "atmospheric_conditions_1",
              "WEATHER1NAME": "atmospheric_conditions_1_name",
              "WEATHER2": "atmospheric_conditions_2",
              "WEATHER2NAME": "atmospheric_conditions_2_name",
              "WEATHER": "atmospheric_conditions",
              "WEATHERNAME": "atmospheric_conditions_name",
              "SCH_BUS": "school_bus_related",
              "SCH_BUSNAME": "school_bus_related_name",
              "RAIL": "rail_grade_crossing_identifier",
              "RAILNAME": "rail_grade_crossing_identifier_name",
              "NOT_HOUR": "hour_of_notification",
              "NOT_HOURNAME": "hour_of_notification_name",
              "NOT_MIN": "minute_of_notification",
              "NOT_MINNAME": "minute_of_notification_name",
              "ARR_HOUR": "hour_of_arrival_at_scene",
              "ARR_HOURNAME": "hour_of_arrival_at_scene_name",
              "ARR_MIN": "minute_of_arrival_at_scene",
              "ARR_MINNAME": "minute_of_arrival_at_scene_name",
              "HOSP_HR": "hour_of_ems_arrival_at_hospital",
              "HOSP_HRNAME": "hour_of_ems_arrival_at_hospital_name",
              "HOSP_MN": "minute_of_ems_arrival_at_hospital",
              "HOSP_MNNAME": "minute_of_ems_arrival_at_hospital_name",
              "CF1": "related_factors_crash_level_1",
              "CF1NAME": "related_factors_crash_level_1_name",
              "CF2": "related_factors_crash_level_2",
              "CF2NAME": "related_factors_crash_level_2_name",
              "CF3": "related_factors_crash_level_3",
              "CF3NAME": "related_factors_crash_level_3_name",
              "FATALS": "number_of_fatalities",
              "DRUNK_DR": "number_of_drunk_drivers"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod"
      args:
        task_id: "accident_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "accident_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "accident_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.accident_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_vehicle_forms_submitted_all",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_parked_working_vehicles",
              "number_of_forms_submitted_for_persons_not_in_motor_vehicles",
              "number_of_forms_submitted_for_persons_in_motor_vehicles",
              "number_of_persons_in_motor_vehicles_in_transport_mvit",
              "number_of_persons_not_in_motor_vehicles_in_transport_mvit",
              "county",
              "county_name",
              "city",
              "city_name",
              "day_of_crash",
              "day_name",
              "month_of_crash",
              "month_of_crash_name",
              "year_of_crash",
              "day_of_week",
              "day_of_week_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "national_highway_system",
              "national_highway_system_name",
              "route_signing",
              "route_signing_name",
              "trafficway_identifier",
              "trafficway_identifier_2",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "ownership",
              "ownership_name",
              "milepoint",
              "milepoint_name",
              "latitude",
              "latitude_name",
              "longitude",
              "longitude_name",
              "special_jurisdiction",
              "special_jurisdiction_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "relation_to_junction_within_interchange_area",
              "relation_to_junction_within_interchange_area_name",
              "relation_to_junction_specific_location",
              "relation_to_junction_specific_location_name",
              "type_of_intersection",
              "type_of_intersection_name",
              "work_zone",
              "work_zone_name",
              "relation_to_trafficway",
              "relation_to_trafficway_name",
              "light_condition",
              "light_condition_name",
              "atmospheric_conditions_1",
              "atmospheric_conditions_1_name",
              "atmospheric_conditions_2",
              "atmospheric_conditions_2_name",
              "rail_grade_crossing_identifier",
              "rail_grade_crossing_identifier_name",
              "hour_of_notification",
              "hour_of_notification_name",
              "minute_of_notification",
              "minute_of_notification_name",
              "hour_of_arrival_at_scene",
              "hour_of_arrival_at_scene_name",
              "minute_of_arrival_at_scene",
              "minute_of_arrival_at_scene_name",
              "hour_of_ems_arrival_at_hospital",
              "hour_of_ems_arrival_at_hospital_name",
              "minute_of_ems_arrival_at_hospital",
              "minute_of_ems_arrival_at_hospital_name",
              "number_of_fatalities",
              "number_of_drunk_drivers"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_vehicle_forms_submitted_all": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_parked_working_vehicles": "str",
              "number_of_forms_submitted_for_persons_not_in_motor_vehicles": "str",
              "number_of_forms_submitted_for_persons_in_motor_vehicles": "str",
              "number_of_persons_in_motor_vehicles_in_transport_mvit": "str",
              "number_of_persons_not_in_motor_vehicles_in_transport_mvit": "str",
              "county": "str",
              "county_name": "str",
              "city": "str",
              "city_name": "str",
              "day_of_crash": "str",
              "day_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "year_of_crash": "str",
              "day_of_week": "str",
              "day_of_week_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "national_highway_system": "str",
              "national_highway_system_name": "str",
              "route_signing": "str",
              "route_signing_name": "str",
              "trafficway_identifier": "str",
              "trafficway_identifier_2": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "ownership": "str",
              "ownership_name": "str",
              "milepoint": "str",
              "milepoint_name": "str",
              "latitude": "str",
              "latitude_name": "str",
              "longitude": "str",
              "longitude_name": "str",
              "special_jurisdiction": "str",
              "special_jurisdiction_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "relation_to_junction_within_interchange_area": "str",
              "relation_to_junction_within_interchange_area_name": "str",
              "relation_to_junction_specific_location": "str",
              "relation_to_junction_specific_location_name": "str",
              "type_of_intersection": "str",
              "type_of_intersection_name": "str",
              "work_zone": "str",
              "work_zone_name": "str",
              "relation_to_trafficway": "str",
              "relation_to_trafficway_name": "str",
              "light_condition": "str",
              "light_condition_name": "str",
              "atmospheric_conditions_1": "str",
              "atmospheric_conditions_1_name": "str",
              "atmospheric_conditions_2": "str",
              "atmospheric_conditions_2_name": "str",
              "rail_grade_crossing_identifier": "str",
              "rail_grade_crossing_identifier_name": "str",
              "hour_of_notification": "str",
              "hour_of_notification_name": "str",
              "minute_of_notification": "str",
              "minute_of_notification_name": "str",
              "hour_of_arrival_at_scene": "str",
              "hour_of_arrival_at_scene_name": "str",
              "minute_of_arrival_at_scene": "str",
              "minute_of_arrival_at_scene_name": "str",
              "hour_of_ems_arrival_at_hospital": "str",
              "hour_of_ems_arrival_at_hospital_name": "str",
              "minute_of_ems_arrival_at_hospital": "str",
              "minute_of_ems_arrival_at_hospital_name": "str",
              "number_of_fatalities": "str",
              "number_of_drunk_drivers": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_TOTAL": "number_of_vehicle_forms_submitted_all",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PVH_INVL": "number_of_parked_working_vehicles",
              "PEDS": "number_of_forms_submitted_for_persons_not_in_motor_vehicles",
              "PERSONS": "number_of_forms_submitted_for_persons_in_motor_vehicles",
              "PERMVIT": "number_of_persons_in_motor_vehicles_in_transport_mvit",
              "PERNOTMVIT": "number_of_persons_not_in_motor_vehicles_in_transport_mvit",
              "COUNTY": "county",
              "COUNTYNAME": "county_name",
              "CITY": "city",
              "CITYNAME": "city_name",
              "DAY": "day_of_crash",
              "DAYNAME": "day_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "YEAR": "year_of_crash",
              "DAY_WEEK": "day_of_week",
              "DAY_WEEKNAME": "day_of_week_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "NHS": "national_highway_system",
              "NHSNAME": "national_highway_system_name",
              "ROUTE": "route_signing",
              "ROUTENAME": "route_signing_name",
              "TWAY_ID": "trafficway_identifier",
              "TWAY_ID2": "trafficway_identifier_2",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "RD_OWNER": "ownership",
              "RD_OWNERNAME": "ownership_name",
              "MILEPT": "milepoint",
              "MILEPTNAME": "milepoint_name",
              "LATITUDE": "latitude",
              "LATITUDENAME": "latitude_name",
              "LONGITUD": "longitude",
              "LONGITUDNAME": "longitude_name",
              "SP_JUR": "special_jurisdiction",
              "SP_JURNAME": "special_jurisdiction_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "RELJCT1": "relation_to_junction_within_interchange_area",
              "RELJCT1NAME": "relation_to_junction_within_interchange_area_name",
              "RELJCT2": "relation_to_junction_specific_location",
              "RELJCT2NAME": "relation_to_junction_specific_location_name",
              "TYP_INT" : "type_of_intersection",
              "TYP_INTNAME": "type_of_intersection_name",
              "WRK_ZONE": "work_zone",
              "WRK_ZONENAME": "work_zone_name",
              "REL_ROAD": "relation_to_trafficway",
              "REL_ROADNAME": "relation_to_trafficway_name",
              "LGT_COND": "light_condition",
              "LGT_CONDNAME": "light_condition_name",
              "WEATHER1": "atmospheric_conditions_1",
              "WEATHER1NAME": "atmospheric_conditions_1_name",
              "WEATHER2": "atmospheric_conditions_2",
              "WEATHER2NAME": "atmospheric_conditions_2_name",
              "RAIL": "rail_grade_crossing_identifier",
              "RAILNAME": "rail_grade_crossing_identifier_name",
              "NOT_HOUR": "hour_of_notification",
              "NOT_HOURNAME": "hour_of_notification_name",
              "NOT_MIN": "minute_of_notification",
              "NOT_MINNAME": "minute_of_notification_name",
              "ARR_HOUR": "hour_of_arrival_at_scene",
              "ARR_HOURNAME": "hour_of_arrival_at_scene_name",
              "ARR_MIN": "minute_of_arrival_at_scene",
              "ARR_MINNAME": "minute_of_arrival_at_scene_name",
              "HOSP_HR": "hour_of_ems_arrival_at_hospital",
              "HOSP_HRNAME": "hour_of_ems_arrival_at_hospital_name",
              "HOSP_MN": "minute_of_ems_arrival_at_hospital",
              "HOSP_MNNAME": "minute_of_ems_arrival_at_hospital_name",
              "FATALS": "number_of_fatalities",
              "DRUNK_DR": "number_of_drunk_drivers"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod"
      args:
        task_id: "cevent_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "cevent_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "cevent_2015_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.cevent_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "event_number",
              "vehicle_number_this_vehicle",
              "area_of_impact_this_vehicle",
              "area_of_impact_this_vehicle_name",
              "sequence_of_events",
              "sequence_of_events_name",
              "vehicle_number_other_vehicle",
              "vehicle_number_other_vehicle_name",
              "area_of_impact_other_vehicle",
              "area_of_impact_other_vehicle_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "event_number": "str",
              "vehicle_number_this_vehicle": "str",
              "area_of_impact_this_vehicle": "str",
              "area_of_impact_this_vehicle_name": "str",
              "sequence_of_events": "str",
              "sequence_of_events_name": "str",
              "vehicle_number_other_vehicle": "str",
              "vehicle_number_other_vehicle_name": "str",
              "area_of_impact_other_vehicle": "str",
              "area_of_impact_other_vehicle_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "EVENTNUM": "event_number",
              "VNUMBER1": "vehicle_number_this_vehicle",
              "AOI1": "area_of_impact_this_vehicle",
              "AOI1NAME": "area_of_impact_this_vehicle_name",
              "SOE": "sequence_of_events",
              "SOENAME": "sequence_of_events_name",
              "VNUMBER2": "vehicle_number_other_vehicle",
              "VNUMBER2NAME": "vehicle_number_other_vehicle_name",
              "AOI2": "area_of_impact_other_vehicle",
              "AOI2NAME": "area_of_impact_other_vehicle_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod"
      args:
        task_id: "damage_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "damage_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "damage_2015_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.damage_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "damaged_areas",
              "damaged_areas_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "damaged_areas": "str",
              "damaged_areas_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "MDAREAS": "damaged_areas",
              "MDAREASNAME": "area_of_impact_this_vehicle"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod"
      args:
        task_id: "distract_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "distract_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "distract_2015_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.distract_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "driver_distracted_by",
              "driver_distracted_by_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "driver_distracted_by": "str",
              "driver_distracted_by_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "MDRDSTRD": "driver_distracted_by",
              "MDRDSTRDNAME": "driver_distracted_by_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod"
      args:
        task_id: "drimpair_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "drimpair_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "drimpair_2015_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.drimpair_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "condition_impairment_at_time_of_crash_driver",
              "condition_impairment_at_time_of_crash_driver_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "condition_impairment_at_time_of_crash_driver": "str",
              "condition_impairment_at_time_of_crash_driver_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "DRIMPAIR": "condition_impairment_at_time_of_crash_driver",
              "DRIMPAIRNAME": "condition_impairment_at_time_of_crash_driver_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod"
      args:
        task_id: "factor_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "factor_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "factor_2015_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.factor_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "contributing_circumstances_motor_vehicle",
              "contributing_circumstances_motor_vehicle_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "contributing_circumstances_motor_vehicle": "str",
              "contributing_circumstances_motor_vehicle_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "MFACTOR": "contributing_circumstances_motor_vehicle",
              "MFACTORNAME": "contributing_circumstances_motor_vehicle_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for maneuver pipeline"
      args:
        task_id: "maneuver_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "maneuver_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "maneuver_2015_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.maneuver_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "driver_maneuvered_to_avoid",
              "driver_maneuvered_to_avoid_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "driver_maneuvered_to_avoid": "str",
              "driver_maneuvered_to_avoid_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "MDRMANAV": "driver_maneuvered_to_avoid",
              "MDRMANAVNAME": "driver_maneuvered_to_avoid_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for nmcrash pipeline"
      args:
        task_id: "nmcrash_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "nmcrash_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "nmcrash_2015_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.nmcrash_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "person_number",
              "non_motorist_contributing_circumstances",
              "non_motorist_contributing_circumstances_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "non_motorist_contributing_circumstances": "str",
              "non_motorist_contributing_circumstances_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "MTM_CRSH": "non_motorist_contributing_circumstances",
              "MTM_CRSHNAME": "non_motorist_contributing_circumstances_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for nmimpair pipeline"
      args:
        task_id: "nmimpair_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "nmimpair_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "nmimpair_2015_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.nmimpair_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "person_number",
              "condition_impairment_at_time_of_crash_non_motorist",
              "condition_impairment_at_time_of_crash_non_motorist_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "condition_impairment_at_time_of_crash_non_motorist": "str",
              "condition_impairment_at_time_of_crash_non_motorist_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "NMIMPAIR": "condition_impairment_at_time_of_crash_non_motorist",
              "NMIMPAIRNAME": "condition_impairment_at_time_of_crash_non_motorist_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for nmprior pipeline"
      args:
        task_id: "nmprior_2015_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "nmprior_2015_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "nmprior_2015_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.nmprior_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "person_number",
              "non_motorist_action_circumstances",
              "non_motorist_action_circumstances_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "non_motorist_action_circumstances": "str",
              "non_motorist_action_circumstances_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "NMIMPAIR": "non_motorist_action_circumstances",
              "NMIMPAIRNAME": "non_motorist_action_circumstances_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for parkwork_2015 pipeline"
      args:
        task_id: "parkwork_2015_transform_csv"
        startup_timeout_seconds: 600
        name: "parkwork_2015"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "parkwork_2015.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2015.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number",
              "motor_carrier_identification_number_name",
              "gross_vehicle_weight_rating",
              "gross_vehicle_weight_rating_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "underride_override",
              "underride_override_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "related_factors_vehicle_level1",
              "related_factors_vehicle_level1_name",
              "related_factors_vehicle_level2",
              "related_factors_vehicle_level2_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "fatalities_in_vehicle"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number": "str",
              "motor_carrier_identification_number_name": "str",
              "gross_vehicle_weight_rating": "str",
              "gross_vehicle_weight_rating_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "related_factors_vehicle_level1": "str",
              "related_factors_vehicle_level1_name": "str",
              "related_factors_vehicle_level2": "str",
              "related_factors_vehicle_level2_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "fatalities_in_vehicle": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PVE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PNUMOCCS": "number_of_occupants",
              "PNUMOCCSNAME": "number_of_occupants_name",
              "PDAY": "day_of_crash",
              "PDAYNAME": "day_of_crash_name",
              "PMONTH": "month_of_crash",
              "PMONTHNAME": "month_of_crash_name",
              "PHOUR": "hour_of_crash",
              "PHOURNAME": "hour_of_crash_name",
              "PMINUTE": "minute_of_crash",
              "PMINUTENAME": "minute_of_crash_name",
              "PHARM_EV": "first_harmful_event",
              "PHARM_EVNAME": "first_harmful_event_name",
              "PMAN_COLL": "manner_of_collision",
              "PMAN_COLLNAME": "manner_of_collision_name",
              "PTYPE": "unit_type",
              "PTYPENAME": "unit_type_name",
              "PHIT_RUN": "hit_and_run",
              "PHIT_RUNNAME": "hit_and_run_name",
              "PREG_STAT": "registration_state",
              "PREG_STATNAME": "registration_state_name",
              "POWNER": "registered_vehicle_owner",
              "POWNERNAME": "registered_vehicle_owner_name",
              "PMAKE": "vehicle_make",
              "PMAKENAME": "vehicle_make_name",
              "PMODEL": "vehicle_model",
              "PMAK_MOD": "make_model_combined",
              "PBODYTYP": "body_type",
              "PBODYTYPNAME": "body_type_name",
              "PMODYEAR": "vehicle_model_year",
              "PMODYEARNAME": "vehicle_model_year_name",
              "PVIN": "vehicle_identification_number_vin",
              "PVINNAME": "vehicle_identification_number_vin_name",
              "PVIN_1": "vin_character_1",
              "PVIN_2": "vin_character_2",
              "PVIN_3": "vin_character_3",
              "PVIN_4": "vin_character_4",
              "PVIN_5": "vin_character_5",
              "PVIN_6": "vin_character_6",
              "PVIN_7": "vin_character_7",
              "PVIN_8": "vin_character_8",
              "PVIN_9": "vin_character_9",
              "PVIN_10": "vin_character_10",
              "PVIN_11": "vin_character_11",
              "PVIN_12": "vin_character_12",
              "PTRAILER": "vehicle_trailing",
              "PTRAILERNAME": "vehicle_trailing_name",
              "PMCARR_I1": "mcid_issuing_authority",
              "PMCARR_I1NAME": "mcid_issuing_authority_name",
              "PMCARR_I2": "mcid_identification_number",
              "PMCARR_I2NAME": "mcid_identification_number_name",
              "PMCARR_ID": "motor_carrier_identification_number",
              "PMCARR_IDNAME": "motor_carrier_identification_number_name",
              "PGVWR": "gross_vehicle_weight_rating",
              "PGVWRNAME": "gross_vehicle_weight_rating_name",
              "PV_CONFIG": "vehicle_configuration",
              "PV_CONFIGNAME": "vehicle_configuration_name",
              "PCARGTYP": "cargo_body_type",
              "PCARGTYPNAME": "cargo_body_type_name",
              "PHAZ_INV": "hazardous_material_involvement",
              "PHAZ_INVNAME": "hazardous_material_involvement_name",
              "PHAZPLAC": "hazardous_material_placard",
              "PHAZPLACNAME": "hazardous_material_placard_name",
              "PHAZ_ID": "hazardous_material_identification_number",
              "PHAZ_IDNAME": "hazardous_material_identification_number_name",
              "PHAZ_CNO": "hazardous_material_class_number",
              "PHAZ_CNONAME": "hazardous_material_class_number_name",
              "PHAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "PHAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "PBUS_USE": "bus_use",
              "PBUS_USENAME": "bus_use_name",
              "PSP_USE": "special_use",
              "PSP_USENAME": "special_use_name",
              "PEM_USE": "emergency_motor_vehicle_use",
              "PEM_USENAME": "emergency_motor_vehicle_use_name",
              "PUNDERIDE": "underride_override",
              "PUNDERIDENAME": "underride_override_name",
              "PIMPACT1": "initial_contact_point",
              "PIMPACT1NAME": "initial_contact_point_name",
              "PVEH_SEV": "extent_of_damage",
              "PVEH_SEVNAME": "extent_of_damage_name",
              "PTOWED": "vehicle_removal",
              "PTOWEDNAME": "vehicle_removal_name",
              "PM_HARM": "most_harmful_event",
              "PM_HARMNAME": "most_harmful_event_name",
              "PVEH_SC1": "related_factors_vehicle_level1",
              "PVEH_SC1NAME": "related_factors_vehicle_level1_name",
              "PVEH_SC2": "related_factors_vehicle_level2",
              "PVEH_SC2NAME": "related_factors_vehicle_level2_name",
              "PFIRE": "fire_occurrence",
              "PFIRENAME": "fire_occurrence_name",
              "PDEATHS": "fatalities_in_vehicle"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for parkwork_2016_2017 pipelines"
      args:
        task_id: "parkwork_2016_2017_transform_csv"
        startup_timeout_seconds: 600
        name: "parkwork_2016_2017"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "parkwork_2016_2017.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2016_2017.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number",
              "motor_carrier_identification_number_name",
              "gross_vehicle_weight_rating",
              "gross_vehicle_weight_rating_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "underride_override",
              "underride_override_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "related_factors_vehicle_level1",
              "related_factors_vehicle_level1_name",
              "related_factors_vehicle_level2",
              "related_factors_vehicle_level2_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "fatalities_in_vehicle",
              "ptrlr1vin",
              "ptrlr1vinname",
              "ptrlr2vin",
              "ptrlr2vinname",
              "ptrlr3vin",
              "ptrlr3vinname"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number": "str",
              "motor_carrier_identification_number_name": "str",
              "gross_vehicle_weight_rating": "str",
              "gross_vehicle_weight_rating_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "related_factors_vehicle_level1": "str",
              "related_factors_vehicle_level1_name": "str",
              "related_factors_vehicle_level2": "str",
              "related_factors_vehicle_level2_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "fatalities_in_vehicle": "str",
              "ptrlr1vin": "str",
              "ptrlr1vinname": "str",
              "ptrlr2vin": "str",
              "ptrlr2vinname": "str",
              "ptrlr3vin": "str",
              "ptrlr3vinname": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PVE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PNUMOCCS": "number_of_occupants",
              "PNUMOCCSNAME": "number_of_occupants_name",
              "PDAY": "day_of_crash",
              "PDAYNAME": "day_of_crash_name",
              "PMONTH": "month_of_crash",
              "PMONTHNAME": "month_of_crash_name",
              "PHOUR": "hour_of_crash",
              "PHOURNAME": "hour_of_crash_name",
              "PMINUTE": "minute_of_crash",
              "PMINUTENAME": "minute_of_crash_name",
              "PHARM_EV": "first_harmful_event",
              "PHARM_EVNAME": "first_harmful_event_name",
              "PMAN_COLL": "manner_of_collision",
              "PMAN_COLLNAME": "manner_of_collision_name",
              "PTYPE": "unit_type",
              "PTYPENAME": "unit_type_name",
              "PHIT_RUN": "hit_and_run",
              "PHIT_RUNNAME": "hit_and_run_name",
              "PREG_STAT": "registration_state",
              "PREG_STATNAME": "registration_state_name",
              "POWNER": "registered_vehicle_owner",
              "POWNERNAME": "registered_vehicle_owner_name",
              "PMAKE": "vehicle_make",
              "PMAKENAME": "vehicle_make_name",
              "PMODEL": "vehicle_model",
              "PMAK_MOD": "make_model_combined",
              "PBODYTYP": "body_type",
              "PBODYTYPNAME": "body_type_name",
              "PMODYEAR": "vehicle_model_year",
              "PMODYEARNAME": "vehicle_model_year_name",
              "PVIN": "vehicle_identification_number_vin",
              "PVINNAME": "vehicle_identification_number_vin_name",
              "PVIN_1": "vin_character_1",
              "PVIN_2": "vin_character_2",
              "PVIN_3": "vin_character_3",
              "PVIN_4": "vin_character_4",
              "PVIN_5": "vin_character_5",
              "PVIN_6": "vin_character_6",
              "PVIN_7": "vin_character_7",
              "PVIN_8": "vin_character_8",
              "PVIN_9": "vin_character_9",
              "PVIN_10": "vin_character_10",
              "PVIN_11": "vin_character_11",
              "PVIN_12": "vin_character_12",
              "PTRAILER": "vehicle_trailing",
              "PTRAILERNAME": "vehicle_trailing_name",
              "PMCARR_I1": "mcid_issuing_authority",
              "PMCARR_I1NAME": "mcid_issuing_authority_name",
              "PMCARR_I2": "mcid_identification_number",
              "PMCARR_I2NAME": "mcid_identification_number_name",
              "PMCARR_ID": "motor_carrier_identification_number",
              "PMCARR_IDNAME": "motor_carrier_identification_number_name",
              "PGVWR": "gross_vehicle_weight_rating",
              "PGVWRNAME": "gross_vehicle_weight_rating_name",
              "PV_CONFIG": "vehicle_configuration",
              "PV_CONFIGNAME": "vehicle_configuration_name",
              "PCARGTYP": "cargo_body_type",
              "PCARGTYPNAME": "cargo_body_type_name",
              "PHAZ_INV": "hazardous_material_involvement",
              "PHAZ_INVNAME": "hazardous_material_involvement_name",
              "PHAZPLAC": "hazardous_material_placard",
              "PHAZPLACNAME": "hazardous_material_placard_name",
              "PHAZ_ID": "hazardous_material_identification_number",
              "PHAZ_IDNAME": "hazardous_material_identification_number_name",
              "PHAZ_CNO": "hazardous_material_class_number",
              "PHAZ_CNONAME": "hazardous_material_class_number_name",
              "PHAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "PHAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "PBUS_USE": "bus_use",
              "PBUS_USENAME": "bus_use_name",
              "PSP_USE": "special_use",
              "PSP_USENAME": "special_use_name",
              "PEM_USE": "emergency_motor_vehicle_use",
              "PEM_USENAME": "emergency_motor_vehicle_use_name",
              "PUNDERIDE": "underride_override",
              "PUNDERIDENAME": "underride_override_name",
              "PIMPACT1": "initial_contact_point",
              "PIMPACT1NAME": "initial_contact_point_name",
              "PVEH_SEV": "extent_of_damage",
              "PVEH_SEVNAME": "extent_of_damage_name",
              "PTOWED": "vehicle_removal",
              "PTOWEDNAME": "vehicle_removal_name",
              "PM_HARM": "most_harmful_event",
              "PM_HARMNAME": "most_harmful_event_name",
              "PVEH_SC1": "related_factors_vehicle_level1",
              "PVEH_SC1NAME": "related_factors_vehicle_level1_name",
              "PVEH_SC2": "related_factors_vehicle_level2",
              "PVEH_SC2NAME": "related_factors_vehicle_level2_name",
              "PFIRE": "fire_occurrence",
              "PFIRENAME": "fire_occurrence_name",
              "PDEATHS": "fatalities_in_vehicle",
              "PTRLR1VIN": "ptrlr1vin",
              "PTRLR1VINNAME": "ptrlr1vinname",
              "PTRLR2VIN": "ptrlr2vin",
              "PTRLR2VINNAME": "ptrlr2vinname",
              "PTRLR3VIN": "ptrlr3vin",
              "PTRLR3VINNAME": "ptrlr3vinname"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for parkwork_2018 pipelines"
      args:
        task_id: "parkwork_2018_transform_csv"
        startup_timeout_seconds: 600
        name: "parkwork_2018"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "parkwork_2018.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2018.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "make_model_combined_name",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number",
              "motor_carrier_identification_number_name",
              "gross_vehicle_weight_rating",
              "gross_vehicle_weight_rating_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "underride_override",
              "underride_override_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "related_factors_vehicle_level1",
              "related_factors_vehicle_level1_name",
              "related_factors_vehicle_level2",
              "related_factors_vehicle_level2_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "fatalities_in_vehicle",
              "ptrlr1vin",
              "ptrlr1vinname",
              "ptrlr2vin",
              "ptrlr2vinname",
              "ptrlr3vin",
              "ptrlr3vinname"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "make_model_combined_name": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number": "str",
              "motor_carrier_identification_number_name": "str",
              "gross_vehicle_weight_rating": "str",
              "gross_vehicle_weight_rating_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "related_factors_vehicle_level1": "str",
              "related_factors_vehicle_level1_name": "str",
              "related_factors_vehicle_level2": "str",
              "related_factors_vehicle_level2_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "fatalities_in_vehicle": "str",
              "ptrlr1vin": "str",
              "ptrlr1vinname": "str",
              "ptrlr2vin": "str",
              "ptrlr2vinname": "str",
              "ptrlr3vin": "str",
              "ptrlr3vinname": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PVE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PNUMOCCS": "number_of_occupants",
              "PNUMOCCSNAME": "number_of_occupants_name",
              "PDAY": "day_of_crash",
              "PDAYNAME": "day_of_crash_name",
              "PMONTH": "month_of_crash",
              "PMONTHNAME": "month_of_crash_name",
              "PHOUR": "hour_of_crash",
              "PHOURNAME": "hour_of_crash_name",
              "PMINUTE": "minute_of_crash",
              "PMINUTENAME": "minute_of_crash_name",
              "PHARM_EV": "first_harmful_event",
              "PHARM_EVNAME": "first_harmful_event_name",
              "PMAN_COLL": "manner_of_collision",
              "PMAN_COLLNAME": "manner_of_collision_name",
              "PTYPE": "unit_type",
              "PTYPENAME": "unit_type_name",
              "PHIT_RUN": "hit_and_run",
              "PHIT_RUNNAME": "hit_and_run_name",
              "PREG_STAT": "registration_state",
              "PREG_STATNAME": "registration_state_name",
              "POWNER": "registered_vehicle_owner",
              "POWNERNAME": "registered_vehicle_owner_name",
              "PMAKE": "vehicle_make",
              "PMAKENAME": "vehicle_make_name",
              "PMODEL": "vehicle_model",
              "PMAK_MOD": "make_model_combined",
              "PMAK_MODNAME": "make_model_combined_name",
              "PBODYTYP": "body_type",
              "PBODYTYPNAME": "body_type_name",
              "PMODYEAR": "vehicle_model_year",
              "PMODYEARNAME": "vehicle_model_year_name",
              "PVIN": "vehicle_identification_number_vin",
              "PVINNAME": "vehicle_identification_number_vin_name",
              "PVIN_1": "vin_character_1",
              "PVIN_2": "vin_character_2",
              "PVIN_3": "vin_character_3",
              "PVIN_4": "vin_character_4",
              "PVIN_5": "vin_character_5",
              "PVIN_6": "vin_character_6",
              "PVIN_7": "vin_character_7",
              "PVIN_8": "vin_character_8",
              "PVIN_9": "vin_character_9",
              "PVIN_10": "vin_character_10",
              "PVIN_11": "vin_character_11",
              "PVIN_12": "vin_character_12",
              "PTRAILER": "vehicle_trailing",
              "PTRAILERNAME": "vehicle_trailing_name",
              "PMCARR_I1": "mcid_issuing_authority",
              "PMCARR_I1NAME": "mcid_issuing_authority_name",
              "PMCARR_I2": "mcid_identification_number",
              "PMCARR_I2NAME": "mcid_identification_number_name",
              "PMCARR_ID": "motor_carrier_identification_number",
              "PMCARR_IDNAME": "motor_carrier_identification_number_name",
              "PGVWR": "gross_vehicle_weight_rating",
              "PGVWRNAME": "gross_vehicle_weight_rating_name",
              "PV_CONFIG": "vehicle_configuration",
              "PV_CONFIGNAME": "vehicle_configuration_name",
              "PCARGTYP": "cargo_body_type",
              "PCARGTYPNAME": "cargo_body_type_name",
              "PHAZ_INV": "hazardous_material_involvement",
              "PHAZ_INVNAME": "hazardous_material_involvement_name",
              "PHAZPLAC": "hazardous_material_placard",
              "PHAZPLACNAME": "hazardous_material_placard_name",
              "PHAZ_ID": "hazardous_material_identification_number",
              "PHAZ_IDNAME": "hazardous_material_identification_number_name",
              "PHAZ_CNO": "hazardous_material_class_number",
              "PHAZ_CNONAME": "hazardous_material_class_number_name",
              "PHAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "PHAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "PBUS_USE": "bus_use",
              "PBUS_USENAME": "bus_use_name",
              "PSP_USE": "special_use",
              "PSP_USENAME": "special_use_name",
              "PEM_USE": "emergency_motor_vehicle_use",
              "PEM_USENAME": "emergency_motor_vehicle_use_name",
              "PUNDERIDE": "underride_override",
              "PUNDERIDENAME": "underride_override_name",
              "PIMPACT1": "initial_contact_point",
              "PIMPACT1NAME": "initial_contact_point_name",
              "PVEH_SEV": "extent_of_damage",
              "PVEH_SEVNAME": "extent_of_damage_name",
              "PTOWED": "vehicle_removal",
              "PTOWEDNAME": "vehicle_removal_name",
              "PM_HARM": "most_harmful_event",
              "PM_HARMNAME": "most_harmful_event_name",
              "PVEH_SC1": "related_factors_vehicle_level1",
              "PVEH_SC1NAME": "related_factors_vehicle_level1_name",
              "PVEH_SC2": "related_factors_vehicle_level2",
              "PVEH_SC2NAME": "related_factors_vehicle_level2_name",
              "PFIRE": "fire_occurrence",
              "PFIRENAME": "fire_occurrence_name",
              "PDEATHS": "fatalities_in_vehicle",
              "PTRLR1VIN": "ptrlr1vin",
              "PTRLR1VINNAME": "ptrlr1vinname",
              "PTRLR2VIN": "ptrlr2vin",
              "PTRLR2VINNAME": "ptrlr2vinname",
              "PTRLR3VIN": "ptrlr3vin",
              "PTRLR3VINNAME": "ptrlr3vinname"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for parkwork_2019 pipelines"
      args:
        task_id: "parkwork_2019_transform_csv"
        startup_timeout_seconds: 600
        name: "parkwork_2019"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "parkwork_2019.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2019.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number",
              "motor_carrier_identification_number_name",
              "gross_vehicle_weight_rating",
              "gross_vehicle_weight_rating_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "underride_override",
              "underride_override_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "related_factors_vehicle_level1",
              "related_factors_vehicle_level1_name",
              "related_factors_vehicle_level2",
              "related_factors_vehicle_level2_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "fatalities_in_vehicle",
              "ptrlr1vin",
              "ptrlr1vinname",
              "ptrlr2vin",
              "ptrlr2vinname",
              "ptrlr3vin",
              "ptrlr3vinname"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number": "str",
              "motor_carrier_identification_number_name": "str",
              "gross_vehicle_weight_rating": "str",
              "gross_vehicle_weight_rating_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "related_factors_vehicle_level1": "str",
              "related_factors_vehicle_level1_name": "str",
              "related_factors_vehicle_level2": "str",
              "related_factors_vehicle_level2_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "fatalities_in_vehicle": "str",
              "ptrlr1vin": "str",
              "ptrlr1vinname": "str",
              "ptrlr2vin": "str",
              "ptrlr2vinname": "str",
              "ptrlr3vin": "str",
              "ptrlr3vinname": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PVE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PNUMOCCS": "number_of_occupants",
              "PNUMOCCSNAME": "number_of_occupants_name",
              "PDAY": "day_of_crash",
              "PDAYNAME": "day_of_crash_name",
              "PMONTH": "month_of_crash",
              "PMONTHNAME": "month_of_crash_name",
              "PHOUR": "hour_of_crash",
              "PHOURNAME": "hour_of_crash_name",
              "PMINUTE": "minute_of_crash",
              "PMINUTENAME": "minute_of_crash_name",
              "PHARM_EV": "first_harmful_event",
              "PHARM_EVNAME": "first_harmful_event_name",
              "PMAN_COLL": "manner_of_collision",
              "PMAN_COLLNAME": "manner_of_collision_name",
              "PTYPE": "unit_type",
              "PTYPENAME": "unit_type_name",
              "PHIT_RUN": "hit_and_run",
              "PHIT_RUNNAME": "hit_and_run_name",
              "PREG_STAT": "registration_state",
              "PREG_STATNAME": "registration_state_name",
              "POWNER": "registered_vehicle_owner",
              "POWNERNAME": "registered_vehicle_owner_name",
              "PMAKE": "vehicle_make",
              "PMAKENAME": "vehicle_make_name",
              "PMODEL": "vehicle_model",
              "PMAK_MOD": "make_model_combined",
              "PBODYTYP": "body_type",
              "PBODYTYPNAME": "body_type_name",
              "PMODYEAR": "vehicle_model_year",
              "PMODYEARNAME": "vehicle_model_year_name",
              "PVIN": "vehicle_identification_number_vin",
              "PVINNAME": "vehicle_identification_number_vin_name",
              "PVIN_1": "vin_character_1",
              "PVIN_2": "vin_character_2",
              "PVIN_3": "vin_character_3",
              "PVIN_4": "vin_character_4",
              "PVIN_5": "vin_character_5",
              "PVIN_6": "vin_character_6",
              "PVIN_7": "vin_character_7",
              "PVIN_8": "vin_character_8",
              "PVIN_9": "vin_character_9",
              "PVIN_10": "vin_character_10",
              "PVIN_11": "vin_character_11",
              "PVIN_12": "vin_character_12",
              "PTRAILER": "vehicle_trailing",
              "PTRAILERNAME": "vehicle_trailing_name",
              "PMCARR_I1": "mcid_issuing_authority",
              "PMCARR_I1NAME": "mcid_issuing_authority_name",
              "PMCARR_I2": "mcid_identification_number",
              "PMCARR_I2NAME": "mcid_identification_number_name",
              "PMCARR_ID": "motor_carrier_identification_number",
              "PMCARR_IDNAME": "motor_carrier_identification_number_name",
              "PGVWR": "gross_vehicle_weight_rating",
              "PGVWRNAME": "gross_vehicle_weight_rating_name",
              "PV_CONFIG": "vehicle_configuration",
              "PV_CONFIGNAME": "vehicle_configuration_name",
              "PCARGTYP": "cargo_body_type",
              "PCARGTYPNAME": "cargo_body_type_name",
              "PHAZ_INV": "hazardous_material_involvement",
              "PHAZ_INVNAME": "hazardous_material_involvement_name",
              "PHAZPLAC": "hazardous_material_placard",
              "PHAZPLACNAME": "hazardous_material_placard_name",
              "PHAZ_ID": "hazardous_material_identification_number",
              "PHAZ_IDNAME": "hazardous_material_identification_number_name",
              "PHAZ_CNO": "hazardous_material_class_number",
              "PHAZ_CNONAME": "hazardous_material_class_number_name",
              "PHAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "PHAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "PBUS_USE": "bus_use",
              "PBUS_USENAME": "bus_use_name",
              "PSP_USE": "special_use",
              "PSP_USENAME": "special_use_name",
              "PEM_USE": "emergency_motor_vehicle_use",
              "PEM_USENAME": "emergency_motor_vehicle_use_name",
              "PUNDERIDE": "underride_override",
              "PUNDERIDENAME": "underride_override_name",
              "PIMPACT1": "initial_contact_point",
              "PIMPACT1NAME": "initial_contact_point_name",
              "PVEH_SEV": "extent_of_damage",
              "PVEH_SEVNAME": "extent_of_damage_name",
              "PTOWED": "vehicle_removal",
              "PTOWEDNAME": "vehicle_removal_name",
              "PM_HARM": "most_harmful_event",
              "PM_HARMNAME": "most_harmful_event_name",
              "PVEH_SC1": "related_factors_vehicle_level1",
              "PVEH_SC1NAME": "related_factors_vehicle_level1_name",
              "PVEH_SC2": "related_factors_vehicle_level2",
              "PVEH_SC2NAME": "related_factors_vehicle_level2_name",
              "PFIRE": "fire_occurrence",
              "PFIRENAME": "fire_occurrence_name",
              "PDEATHS": "fatalities_in_vehicle",
              "PTRLR1VIN": "ptrlr1vin",
              "PTRLR1VINNAME": "ptrlr1vinname",
              "PTRLR2VIN": "ptrlr2vin",
              "PTRLR2VINNAME": "ptrlr2vinname",
              "PTRLR3VIN": "ptrlr3vin",
              "PTRLR3VINNAME": "ptrlr3vinname"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for parkwork_2020 pipelines"
      args:
        task_id: "parkwork_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "parkwork_2020"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "parkwork_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.parkwork_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "number_of_occupants",
              "number_of_occupants_name",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "unit_type",
              "unit_type_name",
              "hit_and_run",
              "hit_and_run_name",
              "registration_state",
              "registration_state_name",
              "registered_vehicle_owner",
              "registered_vehicle_owner_name",
              "vehicle_make",
              "vehicle_make_name",
              "vehicle_model",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "vehicle_model_year",
              "vehicle_model_year_name",
              "vehicle_identification_number_vin",
              "vehicle_identification_number_vin_name",
              "vin_character_1",
              "vin_character_2",
              "vin_character_3",
              "vin_character_4",
              "vin_character_5",
              "vin_character_6",
              "vin_character_7",
              "vin_character_8",
              "vin_character_9",
              "vin_character_10",
              "vin_character_11",
              "vin_character_12",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "mcid_issuing_authority",
              "mcid_issuing_authority_name",
              "mcid_identification_number",
              "mcid_identification_number_name",
              "motor_carrier_identification_number",
              "motor_carrier_identification_number_name",
              "vehicle_configuration",
              "vehicle_configuration_name",
              "cargo_body_type",
              "cargo_body_type_name",
              "hazardous_material_involvement",
              "hazardous_material_involvement_name",
              "hazardous_material_placard",
              "hazardous_material_placard_name",
              "hazardous_material_identification_number",
              "hazardous_material_identification_number_name",
              "hazardous_material_class_number",
              "hazardous_material_class_number_name",
              "release_of_hazardous_material_from_the_cargo_compartment",
              "release_of_hazardous_material_from_the_cargo_compartment_name",
              "bus_use",
              "bus_use_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "underride_override",
              "underride_override_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "extent_of_damage",
              "extent_of_damage_name",
              "vehicle_removal",
              "vehicle_removal_name",
              "most_harmful_event",
              "most_harmful_event_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "fatalities_in_vehicle",
              "ptrlr1vin",
              "ptrlr1vinname",
              "ptrlr2vin",
              "ptrlr2vinname",
              "ptrlr3vin",
              "ptrlr3vinname",
              "pvpicmake",
              "pvpicmakename",
              "pvpicmodel",
              "pvpicmodelname",
              "pvpicbodyclass",
              "pvpicbodyclassname",
              "picfinalbody",
              "picfinalbodyname",
              "pgvwr_from",
              "pgvwr_fromname",
              "pgvwr_to",
              "pgvwr_toname",
              "ptrlr1gvwr",
              "ptrlr1gvwrname",
              "ptrlr2gvwr",
              "ptrlr2gvwrname",
              "ptrlr3gvwr",
              "ptrlr3gvwrname"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "number_of_occupants": "str",
              "number_of_occupants_name": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "unit_type": "str",
              "unit_type_name": "str",
              "hit_and_run": "str",
              "hit_and_run_name": "str",
              "registration_state": "str",
              "registration_state_name": "str",
              "registered_vehicle_owner": "str",
              "registered_vehicle_owner_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "vehicle_model": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "vehicle_model_year": "str",
              "vehicle_model_year_name": "str",
              "vehicle_identification_number_vin": "str",
              "vehicle_identification_number_vin_name": "str",
              "vin_character_1": "str",
              "vin_character_2": "str",
              "vin_character_3": "str",
              "vin_character_4": "str",
              "vin_character_5": "str",
              "vin_character_6": "str",
              "vin_character_7": "str",
              "vin_character_8": "str",
              "vin_character_9": "str",
              "vin_character_10": "str",
              "vin_character_11": "str",
              "vin_character_12": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "mcid_issuing_authority": "str",
              "mcid_issuing_authority_name": "str",
              "mcid_identification_number": "str",
              "mcid_identification_number_name": "str",
              "motor_carrier_identification_number": "str",
              "motor_carrier_identification_number_name": "str",
              "vehicle_configuration": "str",
              "vehicle_configuration_name": "str",
              "cargo_body_type": "str",
              "cargo_body_type_name": "str",
              "hazardous_material_involvement": "str",
              "hazardous_material_involvement_name": "str",
              "hazardous_material_placard": "str",
              "hazardous_material_placard_name": "str",
              "hazardous_material_identification_number": "str",
              "hazardous_material_identification_number_name": "str",
              "hazardous_material_class_number": "str",
              "hazardous_material_class_number_name": "str",
              "release_of_hazardous_material_from_the_cargo_compartment": "str",
              "release_of_hazardous_material_from_the_cargo_compartment_name": "str",
              "bus_use": "str",
              "bus_use_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "underride_override": "str",
              "underride_override_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "extent_of_damage": "str",
              "extent_of_damage_name": "str",
              "vehicle_removal": "str",
              "vehicle_removal_name": "str",
              "most_harmful_event": "str",
              "most_harmful_event_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "fatalities_in_vehicle": "str",
              "ptrlr1vin": "str",
              "ptrlr1vinname": "str",
              "ptrlr2vin": "str",
              "ptrlr2vinname": "str",
              "ptrlr3vin": "str",
              "ptrlr3vinname": "str",
              "pvpicmake": "str",
              "pvpicmakename": "str",
              "pvpicmodel": "str",
              "pvpicmodelname": "str",
              "pvpicbodyclass": "str",
              "pvpicbodyclassname": "str",
              "picfinalbody": "str",
              "picfinalbodyname": "str",
              "pgvwr_from": "str",
              "pgvwr_fromname": "str",
              "pgvwr_to": "str",
              "pgvwr_toname": "str",
              "ptrlr1gvwr": "str",
              "ptrlr1gvwrname": "str",
              "ptrlr2gvwr": "str",
              "ptrlr2gvwrname": "str",
              "ptrlr3gvwr": "str",
              "ptrlr3gvwrname": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PVE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "PNUMOCCS": "number_of_occupants",
              "PNUMOCCSNAME": "number_of_occupants_name",
              "PDAY": "day_of_crash",
              "PDAYNAME": "day_of_crash_name",
              "PMONTH": "month_of_crash",
              "PMONTHNAME": "month_of_crash_name",
              "PHOUR": "hour_of_crash",
              "PHOURNAME": "hour_of_crash_name",
              "PMINUTE": "minute_of_crash",
              "PMINUTENAME": "minute_of_crash_name",
              "PHARM_EV": "first_harmful_event",
              "PHARM_EVNAME": "first_harmful_event_name",
              "PMAN_COLL": "manner_of_collision",
              "PMAN_COLLNAME": "manner_of_collision_name",
              "PTYPE": "unit_type",
              "PTYPENAME": "unit_type_name",
              "PHIT_RUN": "hit_and_run",
              "PHIT_RUNNAME": "hit_and_run_name",
              "PREG_STAT": "registration_state",
              "PREG_STATNAME": "registration_state_name",
              "POWNER": "registered_vehicle_owner",
              "POWNERNAME": "registered_vehicle_owner_name",
              "PMAKE": "vehicle_make",
              "PMAKENAME": "vehicle_make_name",
              "PMODEL": "vehicle_model",
              "PMAK_MOD": "make_model_combined",
              "PBODYTYP": "body_type",
              "PBODYTYPNAME": "body_type_name",
              "PMODYEAR": "vehicle_model_year",
              "PMODYEARNAME": "vehicle_model_year_name",
              "PVIN": "vehicle_identification_number_vin",
              "PVINNAME": "vehicle_identification_number_vin_name",
              "PVIN_1": "vin_character_1",
              "PVIN_2": "vin_character_2",
              "PVIN_3": "vin_character_3",
              "PVIN_4": "vin_character_4",
              "PVIN_5": "vin_character_5",
              "PVIN_6": "vin_character_6",
              "PVIN_7": "vin_character_7",
              "PVIN_8": "vin_character_8",
              "PVIN_9": "vin_character_9",
              "PVIN_10": "vin_character_10",
              "PVIN_11": "vin_character_11",
              "PVIN_12": "vin_character_12",
              "PTRAILER": "vehicle_trailing",
              "PTRAILERNAME": "vehicle_trailing_name",
              "PMCARR_I1": "mcid_issuing_authority",
              "PMCARR_I1NAME": "mcid_issuing_authority_name",
              "PMCARR_I2": "mcid_identification_number",
              "PMCARR_I2NAME": "mcid_identification_number_name",
              "PMCARR_ID": "motor_carrier_identification_number",
              "PMCARR_IDNAME": "motor_carrier_identification_number_name",
              "PV_CONFIG": "vehicle_configuration",
              "PV_CONFIGNAME": "vehicle_configuration_name",
              "PCARGTYP": "cargo_body_type",
              "PCARGTYPNAME": "cargo_body_type_name",
              "PHAZ_INV": "hazardous_material_involvement",
              "PHAZ_INVNAME": "hazardous_material_involvement_name",
              "PHAZPLAC": "hazardous_material_placard",
              "PHAZPLACNAME": "hazardous_material_placard_name",
              "PHAZ_ID": "hazardous_material_identification_number",
              "PHAZ_IDNAME": "hazardous_material_identification_number_name",
              "PHAZ_CNO": "hazardous_material_class_number",
              "PHAZ_CNONAME": "hazardous_material_class_number_name",
              "PHAZ_REL": "release_of_hazardous_material_from_the_cargo_compartment",
              "PHAZ_RELNAME": "release_of_hazardous_material_from_the_cargo_compartment_name",
              "PBUS_USE": "bus_use",
              "PBUS_USENAME": "bus_use_name",
              "PSP_USE": "special_use",
              "PSP_USENAME": "special_use_name",
              "PEM_USE": "emergency_motor_vehicle_use",
              "PEM_USENAME": "emergency_motor_vehicle_use_name",
              "PUNDERIDE": "underride_override",
              "PUNDERIDENAME": "underride_override_name",
              "PIMPACT1": "initial_contact_point",
              "PIMPACT1NAME": "initial_contact_point_name",
              "PVEH_SEV": "extent_of_damage",
              "PVEH_SEVNAME": "extent_of_damage_name",
              "PTOWED": "vehicle_removal",
              "PTOWEDNAME": "vehicle_removal_name",
              "PM_HARM": "most_harmful_event",
              "PM_HARMNAME": "most_harmful_event_name",
              "PFIRE": "fire_occurrence",
              "PFIRENAME": "fire_occurrence_name",
              "PDEATHS": "fatalities_in_vehicle",
              "PTRLR1VIN": "ptrlr1vin",
              "PTRLR1VINNAME": "ptrlr1vinname",
              "PTRLR2VIN": "ptrlr2vin",
              "PTRLR2VINNAME": "ptrlr2vinname",
              "PTRLR3VIN": "ptrlr3vin",
              "PTRLR3VINNAME": "ptrlr3vinname",
              "PVPICMAKE": "pvpicmake",
              "PVPICMAKENAME": "pvpicmakename",
              "PVPICMODEL": "pvpicmodel",
              "PVPICMODELNAME": "pvpicmodelname",
              "PVPICBODYCLASS": "pvpicbodyclass",
              "PVPICBODYCLASSNAME": "pvpicbodyclassname",
              "PICFINALBODY": "picfinalbody",
              "PICFINALBODYNAME": "picfinalbodyname",
              "PGVWR_FROM": "pgvwr_from",
              "PGVWR_FROMNAME": "pgvwr_fromname",
              "PGVWR_TO": "pgvwr_to",
              "PGVWR_TONAME": "pgvwr_toname",
              "PTRLR1GVWR": "ptrlr1gvwr",
              "PTRLR1GVWRNAME": "ptrlr1gvwrname",
              "PTRLR2GVWR": "ptrlr2gvwr",
              "PTRLR2GVWRNAME": "ptrlr2gvwrname",
              "PTRLR3GVWR": "ptrlr3gvwr",
              "PTRLR3GVWRNAME": "ptrlr3gvwrname"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for pbtype pipelines"
      args:
        task_id: "pbtype_transform_csv"
        startup_timeout_seconds: 600
        name: "pbtype"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "pbtype_2015_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.pbtype_2015_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "person_number",
              "person_type",
              "person_type_name",
              "age",
              "age_name",
              "sex",
              "sex_name",
              "marked_crosswalk_present",
              "marked_crosswalk_present_name",
              "sidewalk_present",
              "sidewalk_present_name",
              "school_zone",
              "school_zone_name",
              "crash_type_pedestrian",
              "crash_type_pedestrian_name",
              "crash_type_bicycle",
              "crash_type_bicycle_name",
              "crash_location_pedestrian",
              "crash_location_pedestrian_name",
              "crash_location_bicycle",
              "crash_location_bicycle_name",
              "pedestrian_position",
              "pedestrian_position_name",
              "bicyclist_position",
              "bicyclist_position_name",
              "pedestrian_initial_direction_of_travel",
              "pedestrian_initial_direction_of_travel_name",
              "bicyclist_initial_direction_of_travel",
              "bicyclist_initial_direction_of_travel_name",
              "motorist_initial_direction_of_travel",
              "motorist_initial_direction_of_travel_name",
              "motorist_maneuver",
              "motorist_maneuver_name",
              "intersection_leg",
              "intersection_leg_name",
              "pedestrian_scenario",
              "pedestrian_scenario_name",
              "crash_group_pedestrian",
              "crash_group_pedestrian_name",
              "crash_group_bicycle",
              "crash_group_bicycle_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "person_type": "str",
              "person_type_name": "str",
              "age": "str",
              "age_name": "str",
              "sex": "str",
              "sex_name": "str",
              "marked_crosswalk_present": "str",
              "marked_crosswalk_present_name": "str",
              "sidewalk_present": "str",
              "sidewalk_present_name": "str",
              "school_zone": "str",
              "school_zone_name": "str",
              "crash_type_pedestrian": "str",
              "crash_type_pedestrian_name": "str",
              "crash_type_bicycle": "str",
              "crash_type_bicycle_name": "str",
              "crash_location_pedestrian": "str",
              "crash_location_pedestrian_name": "str",
              "crash_location_bicycle": "str",
              "crash_location_bicycle_name": "str",
              "pedestrian_position": "str",
              "pedestrian_position_name": "str",
              "bicyclist_position": "str",
              "bicyclist_position_name": "str",
              "pedestrian_initial_direction_of_travel": "str",
              "pedestrian_initial_direction_of_travel_name": "str",
              "bicyclist_initial_direction_of_travel": "str",
              "bicyclist_initial_direction_of_travel_name": "str",
              "motorist_initial_direction_of_travel": "str",
              "motorist_initial_direction_of_travel_name": "str",
              "motorist_maneuver": "str",
              "motorist_maneuver_name": "str",
              "intersection_leg": "str",
              "intersection_leg_name": "str",
              "pedestrian_scenario": "str",
              "pedestrian_scenario_name": "str",
              "crash_group_pedestrian": "str",
              "crash_group_pedestrian_name": "str",
              "crash_group_bicycle": "str",
              "crash_group_bicycle_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "PBPTYPE": "person_type",
              "PBPTYPENAME": "person_type_name",
              "PBAGE": "age",
              "PBAGENAME": "age_name",
              "PBSEX": "sex",
              "PBSEXNAME": "sex_name",
              "PBCWALK": "marked_crosswalk_present",
              "PBCWALKNAME": "marked_crosswalk_present_name",
              "PBSWALK": "sidewalk_present",
              "PBSWALKNAME": "sidewalk_present_name",
              "PBSZONE": "school_zone",
              "PBSZONENAME": "school_zone_name",
              "PEDCTYPE": "crash_type_pedestrian",
              "PEDCTYPENAME": "crash_type_pedestrian_name",
              "BIKECTYPE": "crash_type_bicycle",
              "BIKECTYPENAME": "crash_type_bicycle_name",
              "PEDLOC": "crash_location_pedestrian",
              "PEDLOCNAME": "crash_location_pedestrian_name",
              "BIKELOC": "crash_location_bicycle",
              "BIKELOCNAME": "crash_location_bicycle_name",
              "PEDPOS": "pedestrian_position",
              "PEDPOSNAME": "pedestrian_position_name",
              "BIKEPOS": "bicyclist_position",
              "BIKEPOSNAME": "bicyclist_position_name",
              "PEDDIR": "pedestrian_initial_direction_of_travel",
              "PEDDIRNAME": "pedestrian_initial_direction_of_travel_name",
              "BIKEDIR": "bicyclist_initial_direction_of_travel",
              "BIKEDIRNAME": "bicyclist_initial_direction_of_travel_name",
              "MOTDIR": "motorist_initial_direction_of_travel",
              "MOTDIRNAME": "motorist_initial_direction_of_travel_name",
              "MOTMAN": "motorist_maneuver",
              "MOTMANNAME": "motorist_maneuver_name",
              "PEDLEG": "intersection_leg",
              "PEDLEGNAME": "intersection_leg_name",
              "PEDSNR": "pedestrian_scenario",
              "PEDSNRNAME": "pedestrian_scenario_name",
              "PEDCGP": "crash_group_pedestrian",
              "PEDCGPNAME": "crash_group_pedestrian_name",
              "BIKECGP": "crash_group_bicycle",
              "BIKECGPNAME": "crash_group_bicycle_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for person pipelines"
      args:
        task_id: "person_2015_2017_transform_csv"
        startup_timeout_seconds: 600
        name: "person"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "person_2015_2017.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2015_2017.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "vehicle_number",
              "person_number",
              "number_of_motor_vehicle_striking_non_motorist",
              "county",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "school_bus_related",
              "school_bus_related_name",
              "vehicle_make",
              "vehicle_make_name",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "model_year",
              "model_year_name",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "rollover",
              "rollover_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "age",
              "age_name",
              "sex",
              "sex_name",
              "person_type",
              "person_type_name",
              "injury_severity",
              "injury_severity_name",
              "seating_position",
              "seating_position_name",
              "restraint_system_helmet_use",
              "restraint_system_helmet_use_name",
              "indication_of_misuse_of_restraint_system_helmet",
              "indication_of_misuse_of_restraint_system_helmet_name",
              "air_bag_deployed",
              "air_bag_deployed_name",
              "ejection",
              "ejection_name",
              "ejection_path",
              "ejection_path_name",
              "extrication",
              "extrication_name",
              "police_reported_alcohol_involvement",
              "police_reported_alcohol_involvement_name",
              "method_of_alcohol_determination_by_police",
              "method_of_alcohol_determination_by_police_name",
              "alcohol_test_status",
              "alcohol_test_status_name",
              "alcohol_test_type",
              "alcohol_test_type_name",
              "alcohol_result",
              "alcohol_result_name",
              "police_reported_drug_involvement",
              "police_reported_drug_involvement_name",
              "method_of_drug_determination_by_police",
              "method_of_drug_determination_by_police_name",
              "drug_test_status",
              "drug_test_status_name",
              "drug_test_type1",
              "drug_test_type1_name",
              "drug_test_type2",
              "drug_test_type2_name",
              "drug_test_type3",
              "drug_test_type3_name",
              "drug_result1",
              "drug_result1_name",
              "drug_result2",
              "drug_result2_name",
              "drug_result3",
              "drug_result3_name",
              "hospital",
              "hospital_name",
              "died_at_scene_en_route",
              "died_at_scene_en_route_name",
              "day_of_death",
              "day_of_death_name",
              "month_of_death",
              "month_of_death_name",
              "year_of_death",
              "year_of_death_name",
              "hour_of_death",
              "hour_of_death_name",
              "minute_of_death",
              "minute_of_death_name",
              "death_time",
              "death_time_name",
              "lag_hours",
              "lag_hours_name",
              "lag_minutes",
              "lag_minutes_name",
              "related_factors_person_level1",
              "related_factors_person_level1_name",
              "related_factors_person_level2",
              "related_factors_person_level2_name",
              "related_factors_person_level3",
              "related_factors_person_level3_name",
              "fatal_injury_at_work",
              "fatal_injury_at_work_name",
              "hispanic_origin",
              "hispanic_origin_name",
              "race",
              "race_name",
              "non_motorist_location_at_time_of_crash",
              "non_motorist_location_at_time_of_crash_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "number_of_motor_vehicle_striking_non_motorist": "str",
              "county": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "school_bus_related": "str",
              "school_bus_related_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "model_year": "str",
              "model_year_name": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "rollover": "str",
              "rollover_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "age": "str",
              "age_name": "str",
              "sex": "str",
              "sex_name": "str",
              "person_type": "str",
              "person_type_name": "str",
              "injury_severity": "str",
              "injury_severity_name": "str",
              "seating_position": "str",
              "seating_position_name": "str",
              "restraint_system_helmet_use": "str",
              "restraint_system_helmet_use_name": "str",
              "indication_of_misuse_of_restraint_system_helmet": "str",
              "indication_of_misuse_of_restraint_system_helmet_name": "str",
              "air_bag_deployed": "str",
              "air_bag_deployed_name": "str",
              "ejection": "str",
              "ejection_name": "str",
              "ejection_path": "str",
              "ejection_path_name": "str",
              "extrication": "str",
              "extrication_name": "str",
              "police_reported_alcohol_involvement": "str",
              "police_reported_alcohol_involvement_name": "str",
              "method_of_alcohol_determination_by_police": "str",
              "method_of_alcohol_determination_by_police_name": "str",
              "alcohol_test_status": "str",
              "alcohol_test_status_name": "str",
              "alcohol_test_type": "str",
              "alcohol_test_type_name": "str",
              "alcohol_result": "str",
              "alcohol_result_name": "str",
              "police_reported_drug_involvement": "str",
              "police_reported_drug_involvement_name": "str",
              "method_of_drug_determination_by_police": "str",
              "method_of_drug_determination_by_police_name": "str",
              "drug_test_status": "str",
              "drug_test_status_name": "str",
              "drug_test_type1": "str",
              "drug_test_type1_name": "str",
              "drug_test_type2": "str",
              "drug_test_type2_name": "str",
              "drug_test_type3": "str",
              "drug_test_type3_name": "str",
              "drug_result1": "str",
              "drug_result1_name": "str",
              "drug_result2": "str",
              "drug_result2_name": "str",
              "drug_result3": "str",
              "drug_result3_name": "str",
              "hospital": "str",
              "hospital_name": "str",
              "died_at_scene_en_route": "str",
              "died_at_scene_en_route_name": "str",
              "day_of_death": "str",
              "day_of_death_name": "str",
              "month_of_death": "str",
              "month_of_death_name": "str",
              "year_of_death": "str",
              "year_of_death_name": "str",
              "hour_of_death": "str",
              "hour_of_death_name": "str",
              "minute_of_death": "str",
              "minute_of_death_name": "str",
              "death_time": "str",
              "death_time_name": "str",
              "lag_hours": "str",
              "lag_hours_name": "str",
              "lag_minutes": "str",
              "lag_minutes_name": "str",
              "related_factors_person_level1": "str",
              "related_factors_person_level1_name": "str",
              "related_factors_person_level2": "str",
              "related_factors_person_level2_name": "str",
              "related_factors_person_level3": "str",
              "related_factors_person_level3_name": "str",
              "fatal_injury_at_work": "str",
              "fatal_injury_at_work_name": "str",
              "hispanic_origin": "str",
              "hispanic_origin_name": "str",
              "race": "str",
              "race_name": "str",
              "non_motorist_location_at_time_of_crash": "str",
              "non_motorist_location_at_time_of_crash_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "STR_VEH": "number_of_motor_vehicle_striking_non_motorist",
              "COUNTY": "county",
              "DAY": "day_of_crash",
              "DAYNAME": "day_of_crash_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "SCH_BUS": "school_bus_related",
              "SCH_BUSNAME": "school_bus_related_name",
              "MAKE": "vehicle_make",
              "MAKENAME": "vehicle_make_name",
              "MAK_MOD": "make_model_combined",
              "BODY_TYP": "body_type",
              "BODY_TYPNAME": "body_type_name",
              "MOD_YEAR": "model_year",
              "MOD_YEARNAME": "model_year_name",
              "TOW_VEH": "vehicle_trailing",
              "TOW_VEHNAME": "vehicle_trailing_name",
              "SPEC_USE": "special_use",
              "SPEC_USENAME": "special_use_name",
              "EMER_USE": "emergency_motor_vehicle_use",
              "EMER_USENAME": "emergency_motor_vehicle_use_name",
              "ROLLOVER": "rollover",
              "ROLLOVERNAME": "rollover_name",
              "IMPACT1": "initial_contact_point",
              "IMPACT1NAME": "initial_contact_point_name",
              "FIRE_EXP": "fire_occurrence",
              "FIRE_EXPNAME": "fire_occurrence_name",
              "AGE": "age",
              "AGENAME": "age_name",
              "SEX": "sex",
              "SEXNAME": "sex_name",
              "PER_TYP": "person_type",
              "PER_TYPNAME": "person_type_name",
              "INJ_SEV": "injury_severity",
              "INJ_SEVNAME": "injury_severity_name",
              "SEAT_POS": "seating_position",
              "SEAT_POSNAME": "seating_position_name",
              "REST_USE": "restraint_system_helmet_use",
              "REST_USENAME": "restraint_system_helmet_use_name",
              "REST_MIS": "indication_of_misuse_of_restraint_system_helmet",
              "REST_MISNAME": "indication_of_misuse_of_restraint_system_helmet_name",
              "AIR_BAG": "air_bag_deployed",
              "AIR_BAGNAME": "air_bag_deployed_name",
              "EJECTION": "ejection",
              "EJECTIONNAME": "ejection_name",
              "EJ_PATH": "ejection_path",
              "EJ_PATHNAME": "ejection_path_name",
              "EXTRICAT": "extrication",
              "EXTRICATNAME": "extrication_name",
              "DRINKING": "police_reported_alcohol_involvement",
              "DRINKINGNAME": "police_reported_alcohol_involvement_name",
              "ALC_DET": "method_of_alcohol_determination_by_police",
              "ALC_DETNAME": "method_of_alcohol_determination_by_police_name",
              "ALC_STATUS": "alcohol_test_status",
              "ALC_STATUSNAME": "alcohol_test_status_name",
              "ATST_TYP": "alcohol_test_type",
              "ATST_TYPNAME": "alcohol_test_type_name",
              "ALC_RES": "alcohol_result",
              "ALC_RESNAME": "alcohol_result_name",
              "DRUGS": "police_reported_drug_involvement",
              "DRUGSNAME": "police_reported_drug_involvement_name",
              "DRUG_DET": "method_of_drug_determination_by_police",
              "DRUG_DETNAME": "method_of_drug_determination_by_police_name",
              "DSTATUS": "drug_test_status",
              "DSTATUSNAME": "drug_test_status_name",
              "DRUGTST1": "drug_test_type1",
              "DRUGTST1NAME": "drug_test_type1_name",
              "DRUGTST2": "drug_test_type2",
              "DRUGTST2NAME": "drug_test_type2_name",
              "DRUGTST3": "drug_test_type3",
              "DRUGTST3NAME": "drug_test_type3_name",
              "DRUGRES1": "drug_result1",
              "DRUGRES1NAME": "drug_result1_name",
              "DRUGRES2": "drug_result2",
              "DRUGRES2NAME": "drug_result2_name",
              "DRUGRES3": "drug_result3",
              "DRUGRES3NAME": "drug_result3_name",
              "HOSPITAL": "hospital",
              "HOSPITALNAME": "hospital_name",
              "DOA": "died_at_scene_en_route",
              "DOANAME": "died_at_scene_en_route_name",
              "DEATH_DA": "day_of_death",
              "DEATH_DANAME": "day_of_death_name",
              "DEATH_MO": "month_of_death",
              "DEATH_MONAME": "month_of_death_name",
              "DEATH_YR": "year_of_death",
              "DEATH_YRNAME": "year_of_death_name",
              "DEATH_HR": "hour_of_death",
              "DEATH_HRNAME": "hour_of_death_name",
              "DEATH_MN": "minute_of_death",
              "DEATH_MNNAME": "minute_of_death_name",
              "DEATH_TM": "death_time",
              "DEATH_TMNAME": "death_time_name",
              "LAG_HRS": "lag_hours",
              "LAG_HRSNAME": "lag_hours_name",
              "LAG_MINS": "lag_minutes",
              "LAG_MINSNAME": "lag_minutes_name",
              "P_SF1": "related_factors_person_level1",
              "P_SF1NAME": "related_factors_person_level1_name",
              "P_SF2": "related_factors_person_level2",
              "P_SF2NAME": "related_factors_person_level2_name",
              "P_SF3": "related_factors_person_level3",
              "P_SF3NAME": "related_factors_person_level3_name",
              "WORK_INJ": "fatal_injury_at_work",
              "WORK_INJNAME": "fatal_injury_at_work_name",
              "HISPANIC": "hispanic_origin",
              "HISPANICNAME": "hispanic_origin_name",
              "RACE": "race",
              "RACENAME": "race_name",
              "LOCATION": "non_motorist_location_at_time_of_crash",
              "LOCATIONNAME": "non_motorist_location_at_time_of_crash_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for person pipelines"
      args:
        task_id: "person_2018_transform_csv"
        startup_timeout_seconds: 600
        name: "person"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.person_2018.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.person_2018.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.person_2018.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "person_2018.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.person_2018.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.person_2018.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2018.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2018.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2018.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2018.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.person_2018.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2018.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2018.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "vehicle_number",
              "person_number",
              "number_of_motor_vehicle_striking_non_motorist",
              "county",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "school_bus_related",
              "school_bus_related_name",
              "vehicle_make",
              "vehicle_make_name",
              "make_model_combined",
              "make_model_combined_name",
              "body_type",
              "body_type_name",
              "model_year",
              "model_year_name",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "rollover",
              "rollover_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "age",
              "age_name",
              "sex",
              "sex_name",
              "person_type",
              "person_type_name",
              "injury_severity",
              "injury_severity_name",
              "seating_position",
              "seating_position_name",
              "restraint_system_helmet_use",
              "restraint_system_helmet_use_name",
              "indication_of_misuse_of_restraint_system_helmet",
              "indication_of_misuse_of_restraint_system_helmet_name",
              "air_bag_deployed",
              "air_bag_deployed_name",
              "ejection",
              "ejection_name",
              "ejection_path",
              "ejection_path_name",
              "extrication",
              "extrication_name",
              "police_reported_alcohol_involvement",
              "police_reported_alcohol_involvement_name",
              "method_of_alcohol_determination_by_police",
              "method_of_alcohol_determination_by_police_name",
              "alcohol_test_status",
              "alcohol_test_status_name",
              "alcohol_test_type",
              "alcohol_test_type_name",
              "alcohol_result",
              "alcohol_result_name",
              "police_reported_drug_involvement",
              "police_reported_drug_involvement_name",
              "method_of_drug_determination_by_police",
              "method_of_drug_determination_by_police_name",
              "drug_test_status",
              "drug_test_status_name",
              "hospital",
              "hospital_name",
              "died_at_scene_en_route",
              "died_at_scene_en_route_name",
              "day_of_death",
              "day_of_death_name",
              "month_of_death",
              "month_of_death_name",
              "year_of_death",
              "year_of_death_name",
              "hour_of_death",
              "hour_of_death_name",
              "minute_of_death",
              "minute_of_death_name",
              "death_time",
              "death_time_name",
              "lag_hours",
              "lag_hours_name",
              "lag_minutes",
              "lag_minutes_name",
              "related_factors_person_level1",
              "related_factors_person_level1_name",
              "related_factors_person_level2",
              "related_factors_person_level2_name",
              "related_factors_person_level3",
              "related_factors_person_level3_name",
              "fatal_injury_at_work",
              "fatal_injury_at_work_name",
              "hispanic_origin",
              "hispanic_origin_name",
              "race",
              "race_name",
              "non_motorist_location_at_time_of_crash",
              "non_motorist_location_at_time_of_crash_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "number_of_motor_vehicle_striking_non_motorist": "str",
              "county": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "school_bus_related": "str",
              "school_bus_related_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "make_model_combined": "str",
              "make_model_combined_name": "str",
              "body_type": "str",
              "body_type_name": "str",
              "model_year": "str",
              "model_year_name": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "rollover": "str",
              "rollover_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "age": "str",
              "age_name": "str",
              "sex": "str",
              "sex_name": "str",
              "person_type": "str",
              "person_type_name": "str",
              "injury_severity": "str",
              "injury_severity_name": "str",
              "seating_position": "str",
              "seating_position_name": "str",
              "restraint_system_helmet_use": "str",
              "restraint_system_helmet_use_name": "str",
              "indication_of_misuse_of_restraint_system_helmet": "str",
              "indication_of_misuse_of_restraint_system_helmet_name": "str",
              "air_bag_deployed": "str",
              "air_bag_deployed_name": "str",
              "ejection": "str",
              "ejection_name": "str",
              "ejection_path": "str",
              "ejection_path_name": "str",
              "extrication": "str",
              "extrication_name": "str",
              "police_reported_alcohol_involvement": "str",
              "police_reported_alcohol_involvement_name": "str",
              "method_of_alcohol_determination_by_police": "str",
              "method_of_alcohol_determination_by_police_name": "str",
              "alcohol_test_status": "str",
              "alcohol_test_status_name": "str",
              "alcohol_test_type": "str",
              "alcohol_test_type_name": "str",
              "alcohol_result": "str",
              "alcohol_result_name": "str",
              "police_reported_drug_involvement": "str",
              "police_reported_drug_involvement_name": "str",
              "method_of_drug_determination_by_police": "str",
              "method_of_drug_determination_by_police_name": "str",
              "drug_test_status": "str",
              "drug_test_status_name": "str",
              "hospital": "str",
              "hospital_name": "str",
              "died_at_scene_en_route": "str",
              "died_at_scene_en_route_name": "str",
              "day_of_death": "str",
              "day_of_death_name": "str",
              "month_of_death": "str",
              "month_of_death_name": "str",
              "year_of_death": "str",
              "year_of_death_name": "str",
              "hour_of_death": "str",
              "hour_of_death_name": "str",
              "minute_of_death": "str",
              "minute_of_death_name": "str",
              "death_time": "str",
              "death_time_name": "str",
              "lag_hours": "str",
              "lag_hours_name": "str",
              "lag_minutes": "str",
              "lag_minutes_name": "str",
              "related_factors_person_level1": "str",
              "related_factors_person_level1_name": "str",
              "related_factors_person_level2": "str",
              "related_factors_person_level2_name": "str",
              "related_factors_person_level3": "str",
              "related_factors_person_level3_name": "str",
              "fatal_injury_at_work": "str",
              "fatal_injury_at_work_name": "str",
              "hispanic_origin": "str",
              "hispanic_origin_name": "str",
              "race": "str",
              "race_name": "str",
              "non_motorist_location_at_time_of_crash": "str",
              "non_motorist_location_at_time_of_crash_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "STR_VEH": "number_of_motor_vehicle_striking_non_motorist",
              "COUNTY": "county",
              "DAY": "day_of_crash",
              "DAYNAME": "day_of_crash_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "SCH_BUS": "school_bus_related",
              "SCH_BUSNAME": "school_bus_related_name",
              "MAKE": "vehicle_make",
              "MAKENAME": "vehicle_make_name",
              "MAK_MOD": "make_model_combined",
              "MAK_MODNAME": "make_model_combined_name",
              "BODY_TYP": "body_type",
              "BODY_TYPNAME": "body_type_name",
              "MOD_YEAR": "model_year",
              "MOD_YEARNAME": "model_year_name",
              "TOW_VEH": "vehicle_trailing",
              "TOW_VEHNAME": "vehicle_trailing_name",
              "SPEC_USE": "special_use",
              "SPEC_USENAME": "special_use_name",
              "EMER_USE": "emergency_motor_vehicle_use",
              "EMER_USENAME": "emergency_motor_vehicle_use_name",
              "ROLLOVER": "rollover",
              "ROLLOVERNAME": "rollover_name",
              "IMPACT1": "initial_contact_point",
              "IMPACT1NAME": "initial_contact_point_name",
              "FIRE_EXP": "fire_occurrence",
              "FIRE_EXPNAME": "fire_occurrence_name",
              "AGE": "age",
              "AGENAME": "age_name",
              "SEX": "sex",
              "SEXNAME": "sex_name",
              "PER_TYP": "person_type",
              "PER_TYPNAME": "person_type_name",
              "INJ_SEV": "injury_severity",
              "INJ_SEVNAME": "injury_severity_name",
              "SEAT_POS": "seating_position",
              "SEAT_POSNAME": "seating_position_name",
              "REST_USE": "restraint_system_helmet_use",
              "REST_USENAME": "restraint_system_helmet_use_name",
              "REST_MIS": "indication_of_misuse_of_restraint_system_helmet",
              "REST_MISNAME": "indication_of_misuse_of_restraint_system_helmet_name",
              "AIR_BAG": "air_bag_deployed",
              "AIR_BAGNAME": "air_bag_deployed_name",
              "EJECTION": "ejection",
              "EJECTIONNAME": "ejection_name",
              "EJ_PATH": "ejection_path",
              "EJ_PATHNAME": "ejection_path_name",
              "EXTRICAT": "extrication",
              "EXTRICATNAME": "extrication_name",
              "DRINKING": "police_reported_alcohol_involvement",
              "DRINKINGNAME": "police_reported_alcohol_involvement_name",
              "ALC_DET": "method_of_alcohol_determination_by_police",
              "ALC_DETNAME": "method_of_alcohol_determination_by_police_name",
              "ALC_STATUS": "alcohol_test_status",
              "ALC_STATUSNAME": "alcohol_test_status_name",
              "ATST_TYP": "alcohol_test_type",
              "ATST_TYPNAME": "alcohol_test_type_name",
              "ALC_RES": "alcohol_result",
              "ALC_RESNAME": "alcohol_result_name",
              "DRUGS": "police_reported_drug_involvement",
              "DRUGSNAME": "police_reported_drug_involvement_name",
              "DRUG_DET": "method_of_drug_determination_by_police",
              "DRUG_DETNAME": "method_of_drug_determination_by_police_name",
              "DSTATUS": "drug_test_status",
              "DSTATUSNAME": "drug_test_status_name",
              "HOSPITAL": "hospital",
              "HOSPITALNAME": "hospital_name",
              "DOA": "died_at_scene_en_route",
              "DOANAME": "died_at_scene_en_route_name",
              "DEATH_DA": "day_of_death",
              "DEATH_DANAME": "day_of_death_name",
              "DEATH_MO": "month_of_death",
              "DEATH_MONAME": "month_of_death_name",
              "DEATH_YR": "year_of_death",
              "DEATH_YRNAME": "year_of_death_name",
              "DEATH_HR": "hour_of_death",
              "DEATH_HRNAME": "hour_of_death_name",
              "DEATH_MN": "minute_of_death",
              "DEATH_MNNAME": "minute_of_death_name",
              "DEATH_TM": "death_time",
              "DEATH_TMNAME": "death_time_name",
              "LAG_HRS": "lag_hours",
              "LAG_HRSNAME": "lag_hours_name",
              "LAG_MINS": "lag_minutes",
              "LAG_MINSNAME": "lag_minutes_name",
              "P_SF1": "related_factors_person_level1",
              "P_SF1NAME": "related_factors_person_level1_name",
              "P_SF2": "related_factors_person_level2",
              "P_SF2NAME": "related_factors_person_level2_name",
              "P_SF3": "related_factors_person_level3",
              "P_SF3NAME": "related_factors_person_level3_name",
              "WORK_INJ": "fatal_injury_at_work",
              "WORK_INJNAME": "fatal_injury_at_work_name",
              "HISPANIC": "hispanic_origin",
              "HISPANICNAME": "hispanic_origin_name",
              "RACE": "race",
              "RACENAME": "race_name",
              "LOCATION": "non_motorist_location_at_time_of_crash",
              "LOCATIONNAME": "non_motorist_location_at_time_of_crash_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"


    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for person pipelines"
      args:
        task_id: "person_2019_transform_csv"
        startup_timeout_seconds: 600
        name: "person"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.person_2019.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.person_2019.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.person_2019.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "person_2019.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.person_2019.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.person_2019.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2019.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2019.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2019.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2019.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.person_2019.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2019.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2019.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "vehicle_number",
              "person_number",
              "number_of_motor_vehicle_striking_non_motorist",
              "county",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "school_bus_related",
              "school_bus_related_name",
              "vehicle_make",
              "vehicle_make_name",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "model_year",
              "model_year_name",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "rollover",
              "rollover_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "age",
              "age_name",
              "sex",
              "sex_name",
              "person_type",
              "person_type_name",
              "injury_severity",
              "injury_severity_name",
              "seating_position",
              "seating_position_name",
              "restraint_system_helmet_use",
              "restraint_system_helmet_use_name",
              "indication_of_misuse_of_restraint_system_helmet",
              "indication_of_misuse_of_restraint_system_helmet_name",
              "air_bag_deployed",
              "air_bag_deployed_name",
              "ejection",
              "ejection_name",
              "ejection_path",
              "ejection_path_name",
              "extrication",
              "extrication_name",
              "police_reported_alcohol_involvement",
              "police_reported_alcohol_involvement_name",
              "method_of_alcohol_determination_by_police",
              "method_of_alcohol_determination_by_police_name",
              "alcohol_test_status",
              "alcohol_test_status_name",
              "alcohol_test_type",
              "alcohol_test_type_name",
              "alcohol_result",
              "alcohol_result_name",
              "police_reported_drug_involvement",
              "police_reported_drug_involvement_name",
              "method_of_drug_determination_by_police",
              "method_of_drug_determination_by_police_name",
              "drug_test_status",
              "drug_test_status_name",
              "hospital",
              "hospital_name",
              "died_at_scene_en_route",
              "died_at_scene_en_route_name",
              "day_of_death",
              "day_of_death_name",
              "month_of_death",
              "month_of_death_name",
              "year_of_death",
              "year_of_death_name",
              "hour_of_death",
              "hour_of_death_name",
              "minute_of_death",
              "minute_of_death_name",
              "death_time",
              "death_time_name",
              "lag_hours",
              "lag_hours_name",
              "lag_minutes",
              "lag_minutes_name",
              "related_factors_person_level1",
              "related_factors_person_level1_name",
              "related_factors_person_level2",
              "related_factors_person_level2_name",
              "related_factors_person_level3",
              "related_factors_person_level3_name",
              "fatal_injury_at_work",
              "fatal_injury_at_work_name",
              "hispanic_origin",
              "hispanic_origin_name",
              "non_motorist_location_at_time_of_crash",
              "non_motorist_location_at_time_of_crash_name",
              "helm_use",
              "helm_usename",
              "helm_mis",
              "helm_misname"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "number_of_motor_vehicle_striking_non_motorist": "str",
              "county": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "school_bus_related": "str",
              "school_bus_related_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "model_year": "str",
              "model_year_name": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "rollover": "str",
              "rollover_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "age": "str",
              "age_name": "str",
              "sex": "str",
              "sex_name": "str",
              "person_type": "str",
              "person_type_name": "str",
              "injury_severity": "str",
              "injury_severity_name": "str",
              "seating_position": "str",
              "seating_position_name": "str",
              "restraint_system_helmet_use": "str",
              "restraint_system_helmet_use_name": "str",
              "indication_of_misuse_of_restraint_system_helmet": "str",
              "indication_of_misuse_of_restraint_system_helmet_name": "str",
              "air_bag_deployed": "str",
              "air_bag_deployed_name": "str",
              "ejection": "str",
              "ejection_name": "str",
              "ejection_path": "str",
              "ejection_path_name": "str",
              "extrication": "str",
              "extrication_name": "str",
              "police_reported_alcohol_involvement": "str",
              "police_reported_alcohol_involvement_name": "str",
              "method_of_alcohol_determination_by_police": "str",
              "method_of_alcohol_determination_by_police_name": "str",
              "alcohol_test_status": "str",
              "alcohol_test_status_name": "str",
              "alcohol_test_type": "str",
              "alcohol_test_type_name": "str",
              "alcohol_result": "str",
              "alcohol_result_name": "str",
              "police_reported_drug_involvement": "str",
              "police_reported_drug_involvement_name": "str",
              "method_of_drug_determination_by_police": "str",
              "method_of_drug_determination_by_police_name": "str",
              "drug_test_status": "str",
              "drug_test_status_name": "str",
              "hospital": "str",
              "hospital_name": "str",
              "died_at_scene_en_route": "str",
              "died_at_scene_en_route_name": "str",
              "day_of_death": "str",
              "day_of_death_name": "str",
              "month_of_death": "str",
              "month_of_death_name": "str",
              "year_of_death": "str",
              "year_of_death_name": "str",
              "hour_of_death": "str",
              "hour_of_death_name": "str",
              "minute_of_death": "str",
              "minute_of_death_name": "str",
              "death_time": "str",
              "death_time_name": "str",
              "lag_hours": "str",
              "lag_hours_name": "str",
              "lag_minutes": "str",
              "lag_minutes_name": "str",
              "related_factors_person_level1": "str",
              "related_factors_person_level1_name": "str",
              "related_factors_person_level2": "str",
              "related_factors_person_level2_name": "str",
              "related_factors_person_level3": "str",
              "related_factors_person_level3_name": "str",
              "fatal_injury_at_work": "str",
              "fatal_injury_at_work_name": "str",
              "hispanic_origin": "str",
              "hispanic_origin_name": "str",
              "non_motorist_location_at_time_of_crash": "str",
              "non_motorist_location_at_time_of_crash_name": "str",
              "helm_use": "str",
              "helm_usename": "str",
              "helm_mis": "str",
              "helm_misname": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "STR_VEH": "number_of_motor_vehicle_striking_non_motorist",
              "COUNTY": "county",
              "DAY": "day_of_crash",
              "DAYNAME": "day_of_crash_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "SCH_BUS": "school_bus_related",
              "SCH_BUSNAME": "school_bus_related_name",
              "MAKE": "vehicle_make",
              "MAKENAME": "vehicle_make_name",
              "MAK_MOD": "make_model_combined",
              "BODY_TYP": "body_type",
              "BODY_TYPNAME": "body_type_name",
              "MOD_YEAR": "model_year",
              "MOD_YEARNAME": "model_year_name",
              "TOW_VEH": "vehicle_trailing",
              "TOW_VEHNAME": "vehicle_trailing_name",
              "SPEC_USE": "special_use",
              "SPEC_USENAME": "special_use_name",
              "EMER_USE": "emergency_motor_vehicle_use",
              "EMER_USENAME": "emergency_motor_vehicle_use_name",
              "ROLLOVER": "rollover",
              "ROLLOVERNAME": "rollover_name",
              "IMPACT1": "initial_contact_point",
              "IMPACT1NAME": "initial_contact_point_name",
              "FIRE_EXP": "fire_occurrence",
              "FIRE_EXPNAME": "fire_occurrence_name",
              "AGE": "age",
              "AGENAME": "age_name",
              "SEX": "sex",
              "SEXNAME": "sex_name",
              "PER_TYP": "person_type",
              "PER_TYPNAME": "person_type_name",
              "INJ_SEV": "injury_severity",
              "INJ_SEVNAME": "injury_severity_name",
              "SEAT_POS": "seating_position",
              "SEAT_POSNAME": "seating_position_name",
              "REST_USE": "restraint_system_helmet_use",
              "REST_USENAME": "restraint_system_helmet_use_name",
              "REST_MIS": "indication_of_misuse_of_restraint_system_helmet",
              "REST_MISNAME": "indication_of_misuse_of_restraint_system_helmet_name",
              "AIR_BAG": "air_bag_deployed",
              "AIR_BAGNAME": "air_bag_deployed_name",
              "EJECTION": "ejection",
              "EJECTIONNAME": "ejection_name",
              "EJ_PATH": "ejection_path",
              "EJ_PATHNAME": "ejection_path_name",
              "EXTRICAT": "extrication",
              "EXTRICATNAME": "extrication_name",
              "DRINKING": "police_reported_alcohol_involvement",
              "DRINKINGNAME": "police_reported_alcohol_involvement_name",
              "ALC_DET": "method_of_alcohol_determination_by_police",
              "ALC_DETNAME": "method_of_alcohol_determination_by_police_name",
              "ALC_STATUS": "alcohol_test_status",
              "ALC_STATUSNAME": "alcohol_test_status_name",
              "ATST_TYP": "alcohol_test_type",
              "ATST_TYPNAME": "alcohol_test_type_name",
              "ALC_RES": "alcohol_result",
              "ALC_RESNAME": "alcohol_result_name",
              "DRUGS": "police_reported_drug_involvement",
              "DRUGSNAME": "police_reported_drug_involvement_name",
              "DRUG_DET": "method_of_drug_determination_by_police",
              "DRUG_DETNAME": "method_of_drug_determination_by_police_name",
              "DSTATUS": "drug_test_status",
              "DSTATUSNAME": "drug_test_status_name",
              "HOSPITAL": "hospital",
              "HOSPITALNAME": "hospital_name",
              "DOA": "died_at_scene_en_route",
              "DOANAME": "died_at_scene_en_route_name",
              "DEATH_DA": "day_of_death",
              "DEATH_DANAME": "day_of_death_name",
              "DEATH_MO": "month_of_death",
              "DEATH_MONAME": "month_of_death_name",
              "DEATH_YR": "year_of_death",
              "DEATH_YRNAME": "year_of_death_name",
              "DEATH_HR": "hour_of_death",
              "DEATH_HRNAME": "hour_of_death_name",
              "DEATH_MN": "minute_of_death",
              "DEATH_MNNAME": "minute_of_death_name",
              "DEATH_TM": "death_time",
              "DEATH_TMNAME": "death_time_name",
              "LAG_HRS": "lag_hours",
              "LAG_HRSNAME": "lag_hours_name",
              "LAG_MINS": "lag_minutes",
              "LAG_MINSNAME": "lag_minutes_name",
              "P_SF1": "related_factors_person_level1",
              "P_SF1NAME": "related_factors_person_level1_name",
              "P_SF2": "related_factors_person_level2",
              "P_SF2NAME": "related_factors_person_level2_name",
              "P_SF3": "related_factors_person_level3",
              "P_SF3NAME": "related_factors_person_level3_name",
              "WORK_INJ": "fatal_injury_at_work",
              "WORK_INJNAME": "fatal_injury_at_work_name",
              "HISPANIC": "hispanic_origin",
              "HISPANICNAME": "hispanic_origin_name",
              "LOCATION": "non_motorist_location_at_time_of_crash",
              "LOCATIONNAME": "non_motorist_location_at_time_of_crash_name",
              "HELM_USE": "helm_use",
              "HELM_USENAME": "helm_usename",
              "HELM_MIS": "helm_mis",
              "HELM_MISNAME": "helm_misname"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for person pipelines"
      args:
        task_id: "person_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "person"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.person_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.person_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.person_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "person_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.person_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.person_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.person_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.person_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.person_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.person_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "number_of_motor_vehicles_in_transport_mvit",
              "vehicle_number",
              "person_number",
              "number_of_motor_vehicle_striking_non_motorist",
              "county",
              "day_of_crash",
              "day_of_crash_name",
              "month_of_crash",
              "month_of_crash_name",
              "hour_of_crash",
              "hour_of_crash_name",
              "minute_of_crash",
              "minute_of_crash_name",
              "land_use",
              "land_use_name",
              "functional_system",
              "functional_system_name",
              "first_harmful_event",
              "first_harmful_event_name",
              "manner_of_collision",
              "manner_of_collision_name",
              "school_bus_related",
              "school_bus_related_name",
              "vehicle_make",
              "vehicle_make_name",
              "make_model_combined",
              "body_type",
              "body_type_name",
              "model_year",
              "model_year_name",
              "vehicle_trailing",
              "vehicle_trailing_name",
              "special_use",
              "special_use_name",
              "emergency_motor_vehicle_use",
              "emergency_motor_vehicle_use_name",
              "rollover",
              "rollover_name",
              "initial_contact_point",
              "initial_contact_point_name",
              "fire_occurrence",
              "fire_occurrence_name",
              "age",
              "age_name",
              "sex",
              "sex_name",
              "person_type",
              "person_type_name",
              "injury_severity",
              "injury_severity_name",
              "seating_position",
              "seating_position_name",
              "restraint_system_helmet_use",
              "restraint_system_helmet_use_name",
              "indication_of_misuse_of_restraint_system_helmet",
              "indication_of_misuse_of_restraint_system_helmet_name",
              "air_bag_deployed",
              "air_bag_deployed_name",
              "ejection",
              "ejection_name",
              "ejection_path",
              "ejection_path_name",
              "extrication",
              "extrication_name",
              "police_reported_alcohol_involvement",
              "police_reported_alcohol_involvement_name",
              "method_of_alcohol_determination_by_police",
              "method_of_alcohol_determination_by_police_name",
              "alcohol_test_status",
              "alcohol_test_status_name",
              "alcohol_test_type",
              "alcohol_test_type_name",
              "alcohol_result",
              "alcohol_result_name",
              "police_reported_drug_involvement",
              "police_reported_drug_involvement_name",
              "method_of_drug_determination_by_police",
              "method_of_drug_determination_by_police_name",
              "drug_test_status",
              "drug_test_status_name",
              "hospital",
              "hospital_name",
              "died_at_scene_en_route",
              "died_at_scene_en_route_name",
              "day_of_death",
              "day_of_death_name",
              "month_of_death",
              "month_of_death_name",
              "year_of_death",
              "year_of_death_name",
              "hour_of_death",
              "hour_of_death_name",
              "minute_of_death",
              "minute_of_death_name",
              "death_time",
              "death_time_name",
              "lag_hours",
              "lag_hours_name",
              "lag_minutes",
              "lag_minutes_name",
              "fatal_injury_at_work",
              "fatal_injury_at_work_name",
              "hispanic_origin",
              "hispanic_origin_name",
              "non_motorist_location_at_time_of_crash",
              "non_motorist_location_at_time_of_crash_name",
              "helm_use",
              "helm_usename",
              "helm_mis",
              "helm_misname",
              "vpic_make",
              "vpic_make_name",
              "vpic_model",
              "vpic_model_name",
              "vpic_body_class",
              "vpic_body_class_name",
              "icfinal_body",
              "icfinalbody_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "number_of_motor_vehicles_in_transport_mvit": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "number_of_motor_vehicle_striking_non_motorist": "str",
              "county": "str",
              "day_of_crash": "str",
              "day_of_crash_name": "str",
              "month_of_crash": "str",
              "month_of_crash_name": "str",
              "hour_of_crash": "str",
              "hour_of_crash_name": "str",
              "minute_of_crash": "str",
              "minute_of_crash_name": "str",
              "land_use": "str",
              "land_use_name": "str",
              "functional_system": "str",
              "functional_system_name": "str",
              "first_harmful_event": "str",
              "first_harmful_event_name": "str",
              "manner_of_collision": "str",
              "manner_of_collision_name": "str",
              "school_bus_related": "str",
              "school_bus_related_name": "str",
              "vehicle_make": "str",
              "vehicle_make_name": "str",
              "make_model_combined": "str",
              "body_type": "str",
              "body_type_name": "str",
              "model_year": "str",
              "model_year_name": "str",
              "vehicle_trailing": "str",
              "vehicle_trailing_name": "str",
              "special_use": "str",
              "special_use_name": "str",
              "emergency_motor_vehicle_use": "str",
              "emergency_motor_vehicle_use_name": "str",
              "rollover": "str",
              "rollover_name": "str",
              "initial_contact_point": "str",
              "initial_contact_point_name": "str",
              "fire_occurrence": "str",
              "fire_occurrence_name": "str",
              "age": "str",
              "age_name": "str",
              "sex": "str",
              "sex_name": "str",
              "person_type": "str",
              "person_type_name": "str",
              "injury_severity": "str",
              "injury_severity_name": "str",
              "seating_position": "str",
              "seating_position_name": "str",
              "restraint_system_helmet_use": "str",
              "restraint_system_helmet_use_name": "str",
              "indication_of_misuse_of_restraint_system_helmet": "str",
              "indication_of_misuse_of_restraint_system_helmet_name": "str",
              "air_bag_deployed": "str",
              "air_bag_deployed_name": "str",
              "ejection": "str",
              "ejection_name": "str",
              "ejection_path": "str",
              "ejection_path_name": "str",
              "extrication": "str",
              "extrication_name": "str",
              "police_reported_alcohol_involvement": "str",
              "police_reported_alcohol_involvement_name": "str",
              "method_of_alcohol_determination_by_police": "str",
              "method_of_alcohol_determination_by_police_name": "str",
              "alcohol_test_status": "str",
              "alcohol_test_status_name": "str",
              "alcohol_test_type": "str",
              "alcohol_test_type_name": "str",
              "alcohol_result": "str",
              "alcohol_result_name": "str",
              "police_reported_drug_involvement": "str",
              "police_reported_drug_involvement_name": "str",
              "method_of_drug_determination_by_police": "str",
              "method_of_drug_determination_by_police_name": "str",
              "drug_test_status": "str",
              "drug_test_status_name": "str",
              "hospital": "str",
              "hospital_name": "str",
              "died_at_scene_en_route": "str",
              "died_at_scene_en_route_name": "str",
              "day_of_death": "str",
              "day_of_death_name": "str",
              "month_of_death": "str",
              "month_of_death_name": "str",
              "year_of_death": "str",
              "year_of_death_name": "str",
              "hour_of_death": "str",
              "hour_of_death_name": "str",
              "minute_of_death": "str",
              "minute_of_death_name": "str",
              "death_time": "str",
              "death_time_name": "str",
              "lag_hours": "str",
              "lag_hours_name": "str",
              "lag_minutes": "str",
              "lag_minutes_name": "str",
              "fatal_injury_at_work": "str",
              "fatal_injury_at_work_name": "str",
              "hispanic_origin": "str",
              "hispanic_origin_name": "str",
              "non_motorist_location_at_time_of_crash": "str",
              "non_motorist_location_at_time_of_crash_name": "str",
              "helm_use": "str",
              "helm_usename": "str",
              "helm_mis": "str",
              "helm_misname": "str",
              "vpic_make": "str",
              "vpic_make_name": "str",
              "vpic_model": "str",
              "vpic_model_name": "str",
              "vpic_body_class": "str",
              "vpic_body_class_name": "str",
              "icfinal_body": "str",
              "icfinalbody_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VE_FORMS": "number_of_motor_vehicles_in_transport_mvit",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "STR_VEH": "number_of_motor_vehicle_striking_non_motorist",
              "COUNTY": "county",
              "DAY": "day_of_crash",
              "DAYNAME": "day_of_crash_name",
              "MONTH": "month_of_crash",
              "MONTHNAME": "month_of_crash_name",
              "HOUR": "hour_of_crash",
              "HOURNAME": "hour_of_crash_name",
              "MINUTE": "minute_of_crash",
              "MINUTENAME": "minute_of_crash_name",
              "RUR_URB": "land_use",
              "RUR_URBNAME": "land_use_name",
              "FUNC_SYS": "functional_system",
              "FUNC_SYSNAME": "functional_system_name",
              "HARM_EV": "first_harmful_event",
              "HARM_EVNAME": "first_harmful_event_name",
              "MAN_COLL": "manner_of_collision",
              "MAN_COLLNAME": "manner_of_collision_name",
              "SCH_BUS": "school_bus_related",
              "SCH_BUSNAME": "school_bus_related_name",
              "MAKE": "vehicle_make",
              "MAKENAME": "vehicle_make_name",
              "MAK_MOD": "make_model_combined",
              "BODY_TYP": "body_type",
              "BODY_TYPNAME": "body_type_name",
              "MOD_YEAR": "model_year",
              "MOD_YEARNAME": "model_year_name",
              "TOW_VEH": "vehicle_trailing",
              "TOW_VEHNAME": "vehicle_trailing_name",
              "SPEC_USE": "special_use",
              "SPEC_USENAME": "special_use_name",
              "EMER_USE": "emergency_motor_vehicle_use",
              "EMER_USENAME": "emergency_motor_vehicle_use_name",
              "ROLLOVER": "rollover",
              "ROLLOVERNAME": "rollover_name",
              "IMPACT1": "initial_contact_point",
              "IMPACT1NAME": "initial_contact_point_name",
              "FIRE_EXP": "fire_occurrence",
              "FIRE_EXPNAME": "fire_occurrence_name",
              "AGE": "age",
              "AGENAME": "age_name",
              "SEX": "sex",
              "SEXNAME": "sex_name",
              "PER_TYP": "person_type",
              "PER_TYPNAME": "person_type_name",
              "INJ_SEV": "injury_severity",
              "INJ_SEVNAME": "injury_severity_name",
              "SEAT_POS": "seating_position",
              "SEAT_POSNAME": "seating_position_name",
              "REST_USE": "restraint_system_helmet_use",
              "REST_USENAME": "restraint_system_helmet_use_name",
              "REST_MIS": "indication_of_misuse_of_restraint_system_helmet",
              "REST_MISNAME": "indication_of_misuse_of_restraint_system_helmet_name",
              "AIR_BAG": "air_bag_deployed",
              "AIR_BAGNAME": "air_bag_deployed_name",
              "EJECTION": "ejection",
              "EJECTIONNAME": "ejection_name",
              "EJ_PATH": "ejection_path",
              "EJ_PATHNAME": "ejection_path_name",
              "EXTRICAT": "extrication",
              "EXTRICATNAME": "extrication_name",
              "DRINKING": "police_reported_alcohol_involvement",
              "DRINKINGNAME": "police_reported_alcohol_involvement_name",
              "ALC_DET": "method_of_alcohol_determination_by_police",
              "ALC_DETNAME": "method_of_alcohol_determination_by_police_name",
              "ALC_STATUS": "alcohol_test_status",
              "ALC_STATUSNAME": "alcohol_test_status_name",
              "ATST_TYP": "alcohol_test_type",
              "ATST_TYPNAME": "alcohol_test_type_name",
              "ALC_RES": "alcohol_result",
              "ALC_RESNAME": "alcohol_result_name",
              "DRUGS": "police_reported_drug_involvement",
              "DRUGSNAME": "police_reported_drug_involvement_name",
              "DRUG_DET": "method_of_drug_determination_by_police",
              "DRUG_DETNAME": "method_of_drug_determination_by_police_name",
              "DSTATUS": "drug_test_status",
              "DSTATUSNAME": "drug_test_status_name",
              "HOSPITAL": "hospital",
              "HOSPITALNAME": "hospital_name",
              "DOA": "died_at_scene_en_route",
              "DOANAME": "died_at_scene_en_route_name",
              "DEATH_DA": "day_of_death",
              "DEATH_DANAME": "day_of_death_name",
              "DEATH_MO": "month_of_death",
              "DEATH_MONAME": "month_of_death_name",
              "DEATH_YR": "year_of_death",
              "DEATH_YRNAME": "year_of_death_name",
              "DEATH_HR": "hour_of_death",
              "DEATH_HRNAME": "hour_of_death_name",
              "DEATH_MN": "minute_of_death",
              "DEATH_MNNAME": "minute_of_death_name",
              "DEATH_TM": "death_time",
              "DEATH_TMNAME": "death_time_name",
              "LAG_HRS": "lag_hours",
              "LAG_HRSNAME": "lag_hours_name",
              "LAG_MINS": "lag_minutes",
              "LAG_MINSNAME": "lag_minutes_name",
              "WORK_INJ": "fatal_injury_at_work",
              "WORK_INJNAME": "fatal_injury_at_work_name",
              "HISPANIC": "hispanic_origin",
              "HISPANICNAME": "hispanic_origin_name",
              "LOCATION": "non_motorist_location_at_time_of_crash",
              "LOCATIONNAME": "non_motorist_location_at_time_of_crash_name",
              "HELM_USE": "helm_use",
              "HELM_USENAME": "helm_usename",
              "HELM_MIS": "helm_mis",
              "HELM_MISNAME": "helm_misname",
              "VPICMAKE": "vpic_make",
              "VPICMAKENAME": "vpic_make_name",
              "VPICMODEL": "vpic_model",
              "VPICMODELNAME": "vpic_model_name",
              "VPICBODYCLASS": "vpic_body_class",
              "VPICBODYCLASSNAME": "vpic_body_class_name",
              "ICFINALBODY": "icfinal_body",
              "ICFINALBODYNAME": "icfinalbody_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for person pipelines"
      args:
        task_id: "safetyeq_2015_2016_transform_csv"
        startup_timeout_seconds: 600
        name: "safetyeq"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "safetyeq_2015_2016.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2015_2016.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "person_number",
              "non_motorist_safety_equipment_use",
              "non_motorist_safety_equipment_use_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "non_motorist_safety_equipment_use": "str",
              "non_motorist_safety_equipment_use_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "MSAFEQMT": "non_motorist_safety_equipment_use",
              "MSAFEQMTNAME": "non_motorist_safety_equipment_use_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"

    - operator: "KubernetesPodOperator"
      description: "Run CSV transform within kubernetes pod for person pipelines"
      args:
        task_id: "safetyeq_2017_2020_transform_csv"
        startup_timeout_seconds: 600
        name: "safetyeq"
        namespace: "composer"
        service_account_name: "datasets"
        image_pull_policy: "Always"
        image: "{{ var.json.nhtsa_traffic_fatalities.container_registry.run_csv_transform_kub }}"
        env_vars:
          PIPELINE_NAME: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.pipeline_name }}"
          SOURCE_URL: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.source_url }}"
          CHUNKSIZE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.chunksize }}"
          SOURCE_ZIPFILE_EXTRACTED: "safetyeq_2017_2020.csv"
          SOURCE_FILE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.source_file }}"
          # TARGET_FILE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.target_file }}"
          PROJECT_ID: "{{ var.value.gcp_project }}"
          DATASET_ID: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.dataset_id }}"
          TABLE_ID: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.destination_table }}"
          START_YEAR: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.start_year }}"
          END_YEAR: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.end_year }}"
          DROP_DEST_TABLE: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.drop_dest_table }}"
          TARGET_GCS_BUCKET: "{{ var.value.composer_bucket }}"
          TARGET_GCS_PATH: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.target_gcs_path }}"
          SCHEMA_PATH: "{{ var.json.nhtsa_traffic_fatalities.safetyeq_2017_2020.schema_path }}"
          INPUT_CSV_HEADERS: >-
            [
              "state_number",
              "state_name",
              "consecutive_number",
              "vehicle_number",
              "person_number",
              "nm_helmet",
              "nm_helmet_name",
              "nm_propad",
              "nm_propad_name",
              "nm_othpro",
              "nm_othpro_name",
              "nm_refclo",
              "nm_refclo_name",
              "nm_light",
              "nm_light_name",
              "nm_othpre",
              "nm_othpre_name"
            ]
          INPUT_DTYPES: >-
            {
              "state_number": "str",
              "state_name": "str",
              "consecutive_number": "str",
              "vehicle_number": "str",
              "person_number": "str",
              "nm_helmet": "str",
              "nm_helmet_name": "str",
              "nm_propad": "str",
              "nm_propad_name": "str",
              "nm_othpro": "str",
              "nm_othpro_name": "str",
              "nm_refclo": "str",
              "nm_refclo_name": "str",
              "nm_light": "str",
              "nm_light_name": "str",
              "nm_othpre": "str",
              "nm_othpre_name": "str"
            }
          RENAME_MAPPINGS_LIST: >-
            {
              "STATE": "state_number",
              "STATENAME": "state_name",
              "ST_CASE": "consecutive_number",
              "VEH_NO": "vehicle_number",
              "PER_NO": "person_number",
              "NMHELMET": "nm_helmet",
              "NMHELMETNAME": "nm_helmet_name",
              "NMPROPAD": "nm_propad",
              "NMPROPADNAME": "nm_propad_name",
              "NMOTHPRO": "nm_othpro",
              "NMOTHPRONAME": "nm_othpro_name",
              "NMREFCLO": "nm_refclo",
              "NMREFCLONAME": "nm_refclo_name",
              "NMLIGHT": "nm_light",
              "NMLIGHTNAME": "nm_light_name",
              "NMOTHPRE": "nm_othpre",
              "NMOTHPRENAME": "nm_othpre_name"
            }
        resources:
          request_ephemeral_storage: "10G"
          request_cpu: "1"


  graph_paths:
    - "create_cluster >> [ accident_2015_transform_csv,accident_2016_2019_transform_csv,accident_2020_transform_csv,cevent_2015_2020_transform_csv,damage_2015_2020_transform_csv,distract_2015_2020_transform_csv,drimpair_2015_2020_transform_csv,factor_2015_2020_transform_csv,maneuver_2015_2020_transform_csv,nmcrash_2015_2020_transform_csv,nmimpair_2015_2020_transform_csv,parkwork_2015_transform_csv,parkwork_2016_2017_transform_csv,parkwork_2018_transform_csv,parkwork_2019_transform_csv,parkwork_2020_transform_csv,pbtype_transform_csv,person_2015_2017_transform_csv,person_2018_transform_csv,person_2019_transform_csv,person_2020_transform_csv,safetyeq_2015_2016_transform_csv,safetyeq_2017_2020_transform_csv ] >> delete_cluster"
